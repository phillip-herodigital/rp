(function(a){a.widget("sc.notification",{options:{templates:{item:'<div class="notify-item-wrapper message-${item}"><div class="ui-corner-all notify-item ui-state-${item}"><div class="notify-item-close"><span class="ui-icon ui-icon-circle-close"></span></div>{{if showIcon}}<span class="ui-icon ui-icon-${item}"></span>{{/if}}<span class="notify-item-content"><div class="notify-item-text">{{html text}}</div>{{if links}}<div class="message-hint">{{each links}}<a href="#">${text}</a><br />{{/each}}</div>{{/if}}</span></div></div>',details:'<div class="details-notify"><div class="all-messages"><div class="ui-corner-all notify-item ui-state-${group}"><span class="ui-icon ui-icon-${group}" /><span class="notify-item-content" >${title}</span></div><div class="small-messages"><div class="small-messages-height"></div></div></div>'}},_create:function(){this.element.addClass("notify-wrapper");this.element.attr("data-name",this.options.name);this._all=[];var b=this;this.element.on("messageremove.notify",function(){b.element.find(".system-error").children().add(b.element.find(".temporary-messages").children()).add(b.element.find(".notifications").children()).size();b.element.find(".system-error").children().add(b.element.find(".temporary-messages").children()).add(b.element.find(".notifications").children()).size()?a.noop():b.element.css({"margin-bottom":"0px"});a(".grouped-notify",b.element).size()?b.element.find(".small-messages").stop().animate({height:b.group.find(".small-messages-height").height()+"px"},500):a.noop()});b.element.closest(".popup-instance")?b.element.parent("div").prependTo(b.element.closest(".popup-instance").find(".thumbnails")):a.noop()},send:function(a,g,b,f,h,d){if(a){var c=a.text||a;this.inQueue(c,d)&&this.withdraw(c,d);g=g||a.type||"error";b=b==null?a.sticky==null?true:a.sticky:b;f=f||a.links;var e=this._message(c,g,b,f,h,d,a.global?true:false)[0];e.uid=d;e.mid=c;this.element.css({"margin-bottom":"15px"});this._all.push(e)}},inQueue:function(a,b){return this._find(a,b).size()>0},withdraw:function(c,e){var b=this._find(c,e),d=b.size();b.remove();this._all=a(this._all).filter(function(){return this!=b[0]});return d},_find:function(c,d,b){return d?a(this._all).filter(function(){return this.uid==d&&this.mid==c}):b?b.find(".notify-item-text").filter(function(){return a(this).html()==a("<div />").html(c).html()}).closest(".notify-item-wrapper"):a.noop()},_message:function(e,f,h,c,i,g){var b=a.tmpl(this.options.templates.item,{item:f,text:e,showIcon:true,links:c,id:g}),d=this;b.find(".message-hint a").each(function(b){a(this).on("click",c[b].hint)});b.find(".ui-icon-circle-close").click(function(){b.height(0).detach();d._updateState();d.element.trigger("messageremove.notify")});return b},_add:function(a,b,c,d){d?this._append(a,b,c):this._prepend(a,b,c)},_prepend:function(b,c,e){var f={error:".message-error:first",warning:".message-warning:first, .message-info:first",info:".message-info:first"},d=a(f[e],b).first();d.size()?d.before(c):e=="error"?b.prepend(c):b.append(c)},_append:function(e,c,d){var f={error:".message-error:last, .message-warning:first, .message-info:first",warning:".message-warning:last, .message-info:first",info:".message-info:last"},b=a(f[d],e).first();if(b.size())if(d=="error"&&!b.is(".message-error")||d=="warning"&&b.is(".message-info"))b.before(c);else b.after(c);else e.append(c)},_links:function(d){for(var c=a('<div class="notify-links"></div>'),b=0;b<(d||[]).length;b++){var e=a('<a href="#">'+d[b]+"</a><br />");c.append(e)}return c},destroy:function(){return a.Widget.prototype.destroy.call(this)}})})(jQuery);(function(b){var a=b.sc.notification.prototype;b.widget("sc.notification",b.extend({},a,{_create:function(){a._create.apply(this,arguments);this.sticky=b('<div class="notifications"></div>').prependTo(this.element)},_find:function(b,c){return a._find.apply(this,[b,c,this.sticky])},_message:function(g,c,e,f,d){var b=a._message.apply(this,arguments);e&&this.sticky.children().size()==0&&c!="sys"&&this._add(this.sticky,b,c,d);return b}}))})(jQuery);(function(a){var b=a.sc.notification.prototype;a.widget("sc.notification",a.extend({},b,{options:{duration:3e3},_create:function(){this.options=a.extend(true,{},b.options,this.options);b._create.apply(this,arguments);this.quick=a('<div class="temporary-messages"></div>').prependTo(this.element)},_message:function(h,c,e,g,d){var a=b._message.apply(this,arguments);if(!e&&c!="sys"){var f=this;this._add(this.quick,a,c,d);this._show(a);f._timeoutHide("quick",this.quick,a)}return a},_timeoutHide:function(b,d,e){var c=this;!this.hideTimeouts?(this.hideTimeouts=[]):a.noop();!this.hideTimeouts[b]?(this.hideTimeouts[b]=[]):a.noop();this.hideTimeouts[b].push(setTimeout(function(){c._hide(e)},1e4));d.unbind("mouseover.notify").bind("mouseover.notify",function(){c.hideTimeouts[b]?a.each(c.hideTimeouts[b],function(){clearTimeout(this)}):a.noop()}).unbind("mouseout.notify").bind("mouseout.notify",function(){c.hideTimeouts[b].push(setTimeout(function(){d.find(".notify-item-wrapper").each(function(){c._hide(a(this))})},1e4))})},_show:function(a){a.css({height:"0px",opacity:0}).animate({height:a.height()+"px"},600,function(a){return function(){a.css({height:"auto"}).animate({opacity:1},300)}}(a))},_hide:function(b){var c=this;b.animate({opacity:"0"},600,function(){b.animate({height:"0px"},300,function(){a.each(b,function(){a(this).detach().remove()});c.element.trigger("messageremove.notify")})})}}))})(jQuery);(function(a){var b=a.sc.notification.prototype;a.widget("sc.notification",a.extend({},b,{options:{templates:{group:'<div class="grouped-notify"><div class="messages"><div class="notify-item"><span class="ui-icon" /><span class="notify-item-content"><span></span><span class="more-info closed"> ${more}<span class="arrow-up-down">&nbsp&nbsp&nbsp&nbsp&nbsp</span></span></span></div><div class="small-messages"><div class="small-messages-height"></div></div></div>',description:"<span>${prefix} {{each value}} {{if count > 0}} ${count} ${type} {{/if}}{{/each}}</span>"}},_create:function(){this.options=a.extend(true,{},b.options,this.options);b._create.apply(this,arguments)},withdraw:function(){if(b.withdraw.apply(this,arguments)&&this.group){this._close(this.group.find(".more-info"));this._updateState()}},_addGroup:function(b){var c=a.tmpl(this.options.templates.group,{more:this.options.texts.moreDetails}),d=this;c.find(".more-info").click(function(){d._toggle(a(this),b)});return c.appendTo(b||this.sticky)},_toggle:function(a){var b=this;if(a.hasClass("closed"))b._open(a);else a.hasClass("opened")&&b._close(a)},_open:function(a){a.html(" "+this.options.texts.lessDetails+' <span class="arrow-up-down">&nbsp&nbsp&nbsp&nbsp&nbsp</span>').removeClass("closed").addClass("opened");a.closest(".messages").addClass("shadow").addClass("radius").find(".small-messages").stop().animate({height:a.closest(".messages").find(".small-messages-height").height()+"px"},500)},_close:function(a){var b=this;a.html(" "+b.options.texts.moreDetails+'...<span class="arrow-up-down">&nbsp&nbsp&nbsp&nbsp&nbsp</span>').addClass("closed").removeClass("opened");a.closest(".messages").removeClass("shadow").removeClass("radius").find(".small-messages:first").stop().animate({height:"0px"},500,function(){})},_message:function(j,e,g,i,f){var h=this.sticky.children().size(),c=b._message.apply(this,arguments),d=this;if(g&&h>0&&e!="sys"){this.group=this.group||this._addGroup();this.sticky.find(".notify-item-wrapper").detach().appendTo(this.group.find(".small-messages-height"));this._add(this.group.find(".small-messages-height"),c,e,f);c.find(".ui-icon-circle-close").click(function(){d._updateState();a(this).closest(".small-messages").stop().animate({height:d.element.closest(".messages").find(".small-messages-height").height()+"px"},500)})}this._updateState();return c},_updateState:function(){if(this.group){var b=a(".notify-item-wrapper",this.group).show().first(),c=this;if(a(".notify-item-wrapper",this.group).size()<2){a(".notify-item-wrapper",this.group).detach().prependTo(this.sticky);this.group.empty();this.group.height(0).remove();this.group=null;return}a(".notify-item:first",this.group).removeClass("ui-state-error ui-state-warning ui-state-info").addClass("ui-state-"+(b.hasClass("message-error")?"error":b.hasClass("message-warning")?"warning":"info")).find(".notify-item-content span:first").html(this.options.texts&&this.options.texts.pageContainsProblems?this.options.texts.pageContainsProblems:"");this.group.css("height","auto")}}}))})(jQuery);(function(a){var b=a.sc.notification.prototype;a.widget("sc.notification",a.extend({},b,{_create:function(){b._create.apply(this,arguments);this.system=a('<div class="system-error"></div>').prependTo(this.element);this._bind()},_bind:function(){var b=this;this._onmessagesendref=function(a,c){b._onmessagesend(a,c);a.stopImmediatePropagation()};this._onvalidatehiglightref=function(a,c){b._onvalidatehiglight(a,c);a.stopPropagation()};this._onvalidateunhighlightref=function(a,c){b._onvalidateunhighlight(a,c);a.stopPropagation()};this._onresponseerrorref=function(c,d){b._onresponseerror(c,d);a(c.target).trigger("hidespinner");c.stopImmediatePropagation()};this.element.closest("body").off("validatehighlight").on("validatehighlight",function(){});this.element.closest(".popup-content, body").first().add(this.element.closest("form")).on("validatehighlight.notification",this._onvalidatehiglightref).on("validateunhighlight.notification",this._onvalidateunhighlightref).on("messagesend.notification",this._onmessagesendref).on("responseerror.notification",this._onresponseerrorref);if(this.options.beforeunload){this._onbeforeunloadref=function(a,c){return b._onbeforeunload(a,c)};a(window).add(this.element.closest("form")).on("beforeunload",this._onbeforeunloadref)}},_onbeforeunload:function(c,b){c.stopPropagation();b=b||{};a.netajax(this.element,"beforeunload",false).done(function(a){b.message=a.message;b.modified=b.modified||a.modified});if(b.modified){c.stopImmediatePropagation(c);return b.message}return undefined},_onmessagesend:function(b,a){this.send(a)},_onvalidatehiglight:function(d,b){if(b.hidden||b.submitted){var c=this;this.send(b.message||b.text,b.type||b.item,true,b.links?b.links:[{text:c.options.texts&&c.options.texts.goToField?c.options.texts.goToField:"",hint:function(){if(a(b.element).is(":hidden")){a(b.element).closest(".directed").tabstrip("showTab",a(b.element).closest(".tab").index());a(b.element).trigger("showhiddenvalidator")}a(b.element).trigger("validatefocus",[b.element]);a(b.element).focus();c._close(c.element.find(".more-info"));return false}}],true,b.element||b.id)}},_onvalidateunhighlight:function(b,a){this.withdraw(a.message,a.element)},_onresponseerror:function(b,a){a&&a!="<br/>"&&this.send(a,"sys",true)},_message:function(g,d,h,i,e){var c=b._message.apply(this,arguments);if(d=="sys"){this.system.html("");var j=this,a=this.system,f=/<title>([\s\S]*)<\/title>/.exec(g);if(f){a=this._addGroup(this.system.html(""));this._toggle(a);a.find(".notify-item").addClass("ui-state-sys").find(".ui-icon").addClass("ui-icon-sys");a.find(".notify-item-content span:first").html(f[1]);this._add(a.find(".small-messages-height"),c,d,e)}else this._add(a,c,d,e);this.system.height(this.system.find(".messages").height())}return c},destroy:function(){this.element.closest(".popup-content, body").first().add(this.element.closest("form")).off("messagesend.notification",this._onmessagesendref).off("validatehighlight.notification",this._onvalidatehiglightref).off("validateunhighlight.notification",this._onvalidateunhighlightref).off("responseerror.notification",this._onresponseerrorref);this.options.beforeunload&&a(window).off("beforeunload",this._onbeforeunloadref);b.destroy.apply(this,arguments)}}))})(jQuery);(function(b){var a=b.sc.notification.prototype;b.widget("sc.notification",b.extend({},a,{_create:function(){a._create.apply(this,arguments);this.global=b('<div class="global-messages"></div>').prependTo(b("body form:first"))},_message:function(j,g,h,i,d,k,e){var c=a._message.apply(this,arguments);if(e){var f=this;this._add(this.global,c,g,d);this.global.find(".notify-item:first").css("height",b(".header").outerHeight()+"px").wrapInner('<div class="page"></div>');this._show(c,true);f._timeoutHide("global",this.global,c)}return c},_show:function(b,c){if(c){var d=b.height();b.find(".notify-item").css({});b.css({height:"0px",opacity:1}).animate({height:d+"px"},150,function(){return function(){}}(b))}else a._show.apply(this,arguments)},_hide:function(b,c){if(c){var d=b.height();b.animate({height:"0px"},150,function(a){return function(){a.css({position:"static",bottom:"auto",left:"auto",display:"none"})}}(b))}else a._hide.apply(this,arguments)},destroy:function(){a.destroy.apply(this,arguments)}}))})(jQuery);if(typeof Sys!=="undefined"){Sys.Browser.WebKit={};if(navigator.userAgent.indexOf("WebKit/")>-1){Sys.Browser.agent=Sys.Browser.WebKit;Sys.Browser.version=parseFloat(navigator.userAgent.match(/WebKit\/(\d+(\.\d+)?)/)[1]);Sys.Browser.name="WebKit"}Sys.Application.notifyScriptLoaded()}
