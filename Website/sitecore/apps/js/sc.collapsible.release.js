(function(a){a.widget("sc.collapsible",{options:{header:"legend",icons:{header:"ui-arrow-up",headerSelected:"ui-arrow-down"},view:"default",collapsible:true,headerHide:false},_create:function(){var b=this;b.element.next().size()?b.element.css("margin-bottom","20px"):a.noop();b.element.parents(".right-content:first").size()?(b.options.view="simple"):a.noop();b.element.addClass("ui-"+b.options.view+"-view");if(!this.element.parents(".collapsible, .abn-item").size())b.element.hasClass("collapsible")?b._initialize():a.noop();else b.element.addClass("collapsible-in-collapsible")},_initialize:function(){var b=this,c=b.options,d={storageKey:document.location.pathname.replace(/[\/,\?,\&,\-,\{,\},\=\#\%\.\:]/g,"")};this.storage=new a.Storage(d);b.element.find("filedset:first").addClass("ui-accordion");b.headers=b.element.find(c.header+":first");b._bind();b.headers.next().addClass("ui-accordion-content");if(!b.headers.find(".p-title > .ui-icon").size()){!b.headers.find(".p-title").size()?b.headers.html("<span class='p-title'>"+b.element.find(c.header+":first").html()+"</span>"):a.noop();c.collapsible?b.headers.prepend(a('<span class="ui-icon"></span>').addClass(c.icons.header)):a.noop()}this.storage.get(this.element.attr("id")?this.element.attr("id"):this.element.attr("data-id")+"_collapsible")=="collapsed"?this.element.addClass("collapsed"):a.noop();if(b.element.hasClass("collapsed")){b.headers.next().slideToggle(0);b.element.trigger("aftertoggle");b.headers.addClass("ui-state-default").find("span.ui-icon:first").removeClass(c.icons.header).addClass(c.icons.headerSelected)}else b.headers.addClass("ui-state-active");a(".ui-accordion-content",b.element.closest(".collapsed")).css("display","none");b.element.hasClass("collapsed")?b.element.find("span.ui-icon:first").removeClass(c.icons.header).addClass(c.icons.headerSelected):a.noop();this.element.find(".popup-menu").css("position","absolute");this.element.find(".favorite").on("click",function(a){a.stopImmediatePropagation()});b.options.headerHide?b.headers.css({display:"none"}):a.noop()},_toggle:function(){var b=this,d=this.options,c=b.headers;b.element.trigger("beforetoggle");!c.find("span.ui-icon:first").hasClass(d.icons.header)?b.element.find("input[type=text], textarea").each(function(){a(this).val(a(this).val().replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"'))}):a.noop();a("html, body").animate({scrollTop:b.headers.top},500);c.next().height(c.next().height());c.next().slideToggle("bounceslide",function(){c.find("span.ui-icon:first").each(function(){if(a(this).hasClass(d.icons.header)){b.element.find("input[type=text], textarea").each(function(){a(this).val(a(this).val().replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;"))});c.removeClass("ui-state-active").addClass("ui-state-default");a(this).removeClass(d.icons.header).addClass(d.icons.headerSelected);b.element.trigger("hide",c);b.storage.set(b.element.attr("id")?b.element.attr("id"):b.element.attr("data-id")+"_collapsible","collapsed");b.element.trigger("aftertoggle")}else{c.removeClass("ui-state-default").addClass("ui-state-active");a(this).removeClass(d.icons.headerSelected).addClass(d.icons.header);b.element.find("input:first").focus();b.element.trigger("show",c);b.storage.set(b.element.attr("id")?b.element.attr("id"):b.element.attr("data-id")+"_collapsible","expanded")}})});return false},_bind:function(){var b=this;this.headers.addClass("ui-accordion-header").on("mouseenter.collapsible",function(){a(this).addClass("ui-state-hover")}).on("mouseleave.collapsible",function(){a(this).removeClass("ui-state-hover")}).on("focus.collapsible",function(){a(this).addClass("ui-state-focus")}).on("blur.collapsible",function(){a(this).removeClass("ui-state-focus")}).click(function(){b.options.collapsible?b._toggle():a.noop()});this.element.on("show",function(){b.headers.next().css("height","auto")})},destroy:function(){return a.Widget.prototype.destroy.call(this)},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);c=="toggle"&&a(this.headers[b]).trigger("click")}})})(jQuery);if(typeof Sys!=="undefined"){Sys.Browser.WebKit={};if(navigator.userAgent.indexOf("WebKit/")>-1){Sys.Browser.agent=Sys.Browser.WebKit;Sys.Browser.version=parseFloat(navigator.userAgent.match(/WebKit\/(\d+(\.\d+)?)/)[1]);Sys.Browser.name="WebKit"}Sys.Application.notifyScriptLoaded()}
