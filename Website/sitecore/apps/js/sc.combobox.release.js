(function(a){a.widget("sc.combobox",{options:{watermark:"Select Item",defaultValue:"",width:null,height:200,readonly:false,show:function(a){a.stop().slideDown(100).scrollTop(0).trigger("scroll")},hide:function(b,a){b.stop().slideUp(100,a)},onSelect:function(){},onClose:function(){},closeOnClick:false,popupTemplate:'<div class="ui-widget-content ui-combobox"></div>',comboboxTemplate:'<div class="ui-combobox-trigger"><span class="ui-icon-triangle-1-s ui-icon ui-combobox-icon"></span><input type="text" class="ui-combobox-title"></input></div>',visible:false,position:"right"},_create:function(){var b=this,c=this.options;b.combobox=a(c.comboboxTemplate);b.element.off("over.combobox").on("over.combobox",function(){b.hidePopup();b.comboboxZIndex=b.popup.css("z-index")}).off("leave.combobox").on("leave.combobox",function(){b.popup.css("z-index",b.comboboxZIndex)});if(c.getValue==null)c.getValue=function(){return a("#"+c.content+"_selected").val()};if(!c.readonly)b.combobox.click(function(c){if(b.options.visible){b.hidePopup(a(c.currentTarget),c);b.combobox.removeClass("ui-state-hover")}else{a(".ui-popupmenu, .filter-combobox, .ui-state-hover").filter(function(){return!a(this).is(b.popup)});b.showPopup(a(c.currentTarget),c)}return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){!b.popup.is(":animated")&&b.popup.is(":hidden")&&a(this).removeClass("ui-state-hover")});else b.combobox.attr("disabled","disabled");a("body").click(function(a){b.options.visible&&b.combobox.trigger("click",[a])});var d=b.combobox.find(".ui-combobox-title");d.attr({title:c.watermark||"",value:c.defaultValue});c.readonly&&d.attr("disabled","disabled");b.popup=a(c.popupTemplate).hover(function(){},function(){b.options.visible&&!c.closeOnClick&&b.hidePopup()}).css({width:b.combobox.width(),height:c.height});b.element.closest(".ui-accordion-header, .ui-dialog-title").size()?a.noop():b.element.css("position","relative");b.addContent();b.popup.parents(".smart-panel").size()?b.popup.css("position","fixed"):a.noop()},getPopup:function(){return this.popup},addContent:function(){var b=this,e=this.options,c;if(e.content!=null){var d=a("#"+e.content);!d.parent().hasClass("ui-combobox")&&d.detach();c=d.clone()}else{c=a(b.element.html());b.element.html("")}b.element.append(b.combobox);this.element.closest("form").append(b.popup);b.popup.hide();c.appendTo(b.popup);c.delegate("a","click",function(a){b.onClick(a)}).click(function(b){a(b.target).is(".close")?a.noop():b.stopPropagation()});c.delegate('input[type="checkbox"]',"change",function(c){!this.closest("th").size()?b.onClick(c):a.noop()})},onClick:function(f){var d=this,g=this.options,c=this.options.getValue(f,this);f.preventDefault();if(c!=null){var b,e;if(typeof c=="string"){e=c;b=c}else{b=c.title;e=c.value||b}if(d[0]!=null){var h=d[0].id;h!=null&&a("#"+h+"_selected").val(e)}if(b&&b.length>60)b="..."+b.substring(b.length-60);d.combobox.find(".ui-combobox-title").val(b).trigger("change");g.onSelect(e)}g.closeOnClick&&d.hidePopup();f.stopPropagation();d.element.trigger("select",[a(f.currentTarget),c,this]);return this},_countOffset:function(b){var d=this,c=this.options;return{top:d.popup.parents(".smart-panel").size()?b.offset().top-a(window).scrollTop()+(b.hasClass("no-offset")?0:b.height()+1):d.formOffset().top+(b.hasClass("no-offset")?0:b.height()+1),left:d.popup.parents(".smart-panel").size()?b.offset().left-((c.width!=null?c.width:b.width())-b.outerWidth()):d.formOffset().left,width:c.width!=null?c.width:b.width()}},onBeforeShow:function(g,h,d){var b=this,f=g,e=b.options,c=b.popup;if(b.combobox.closest(".ui-widget-content").size()==0){a("body").trigger("click");a(".ui-state-hover").trigger("over.combobox")}c.css(this._countOffset(f,d));e.height=="auto"&&c.css("height","auto");b.combobox.addClass("sc-state-active")},_onAfterShow:function(d,h){var c=this,g=d,f=this.options,b=this.popup;if(f.width==null){var e=b.innerWidth()-g.innerWidth();e!=0&&b.width(b.width()-e)}c.element.trigger("show.combobox",[this]);c.options.visible=true;a(window).on("resize.combobox",function(){c.onBeforeShow(d,h)})},showPopup:function(a,b){this.onBeforeShow(a,b);this.options.show(this.popup);this._onAfterShow(a,b)},getLeftPopupPosition:function(){var a=this,b=this.options;return b.width!=null?b.position=="left"?a.combobox.offset().left:a.combobox.offset().left+a.combobox.outerWidth()-b.width||a.combobox.width():a.element.offset().left},offsetFrom:function(a){return{top:this.element.offset().top-a.offset().top,left:this.getLeftPopupPosition()-a.offset().left}},formOffset:function(){return this.element.closest("#sc_overlay, .sc-overlay").length>0?this.offsetFrom(this.element.closest("#sc_overlay, .sc-overlay")):this.element.closest(".smart-panel").length>0?this.offsetFrom(this.element.closest(".switched-content").size()>0?this.element.closest(".switched-content"):this.element.closest(".popup-content")):{top:this.element.offset().top,left:this.getLeftPopupPosition()}},_onAfterHide:function(){this.element.trigger("hide.combobox",[this]);a(window).off("resize.combobox");this.options.visible=false;this.combobox.removeClass("sc-state-active")},hidePopup:function(){this.options.hide(this.popup,this.options.onClose);this._onAfterHide()},destroy:function(){this.combobox.remove();this.popup.remove();return a.Widget.prototype.destroy.call(this)}})})(jQuery);if(typeof Sys!=="undefined"){Sys.Browser.WebKit={};if(navigator.userAgent.indexOf("WebKit/")>-1){Sys.Browser.agent=Sys.Browser.WebKit;Sys.Browser.version=parseFloat(navigator.userAgent.match(/WebKit\/(\d+(\.\d+)?)/)[1]);Sys.Browser.name="WebKit"}Sys.Application.notifyScriptLoaded()}
