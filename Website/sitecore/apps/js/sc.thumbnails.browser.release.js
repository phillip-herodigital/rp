(function(a){a.widget("sc.templateBrowser",a.extend({},a.sc.repeater.prototype,{options:{timer:null,templateShowDelay:1e3,template:'<div class="thumbnail"><span class="icon"{{if processing}} data-processing="${processing}"{{/if}}><img src="${image}" alt="${name}"/></span><span class="name">${name}</span></div>',templateDescription:'<div class="thumbnail"><span class="icon"><img src="${image}" alt="${name}"/></span><span class="name"><a name="${idDescription}">${name}{{if titledetails}} - ${titledetails}{{/if}}</a></span><p>${details}</p></div>',detailsTemplate:'<div class="template-details off"><div class="action-panel"></div><a href="#" class="thumbnail"><img src="#" width="256" /></a><div class="detailsPanel">{{if name}}<span class="name">${name}</span>{{/if}}{{if type}}<span class="type">${type}</span>{{/if}}{{if details}}<span class="details">${details}</span>{{/if}}</div><div class="splash off"></div></div>',pageSize:20,loadTemplate:"<div class='loading'><div>{{if text}}${text}{{/if}}</div><img src='/sitecore/apps/img/sc-spinner16.gif'/></div>",hiddenForSelectedThumbnail:"choosemessagetemplate_content_Thumbnails_selected",fadeSpeed:100,zoomSpeed:200,onClientClick:null,sizePanel:false,showPreview:false,showSpinnerOnIConClick:false,spinner:{type:"global",endless:false,text:""}},_create:function(){var c=this;if(!this.options.type)for(var b=0;b<=this.options.data.length-1;b++)c.options.data[b].groupname?(c.options.type="list"):a.noop();this._sortGroupName();a.sc.repeater.prototype._create.apply(this,arguments);this._bindCombobox();this.options.actionsid?a("#"+options.actionsid).trigger("iconlistcreate"):a.noop()},_createDetails:function(c){var d=this,e=this.options,b=d.element.closest("form").size()?d.element.closest("form"):d.element.find("form:first").size()?d.element.find("form:first"):false;d.pos=0;c=c||{};if(b){if(this.detailsObj&&this.detailsObj.size()){this.detailsObj.remove();this.detailsObj=a.tmpl(e.detailsTemplate,c).appendTo(b)}else if(b.find(".template-details").size()){b.find(".template-details").remove();this.detailsObj=a.tmpl(e.detailsTemplate,c).appendTo(b)}else this.detailsObj=a.tmpl(e.detailsTemplate,c).appendTo(b);this.detailsObj.css("display","none");this._bindDetails()}},_createSplash:function(){var c=this,b=c.element.closest("form").size()?c.element.closest("form"):c.element.find("form:first").size()?c.element.find("form:first"):false;if(b){this.splashNode=a('<div class="templateSplash"></div>').css({display:"none"});if(b.find(".templateSplash").size()){b.find(".templateSplash").remove();this.splashNode=this.splashNode.appendTo(b)}else this.splashNode.appendTo(b);return this.splashNode}else return false},_position:function(a){var b=this,c={left:a.offset().left-(a.closest("form").offset()?a.closest("form").offset().left:0),top:a.offset().top-(a.closest("form").offset()?a.closest("form").offset().top:0)};b.pos={x0:c.left,y0:c.top,x1:c.left-(b.detailsObj.outerWidth()-a.outerWidth())/2,y1:c.top-(b.detailsObj.outerHeight()-a.outerHeight())/2,w0:a.width(),h0:a.height(),w1:b.detailsObj.outerWidth(),h1:b.detailsObj.outerHeight()};return b.pos},_effectStart:function(e,d){var b=this,i=a("#"+b.options.hiddenForSelectedThumbnail).val(d.id),h=e[0],f=this.options;b._createDetails(d);a("#"+f.actionsid).trigger("over",[a(".action-panel",b.detailsObj),null,null]);a(".thumbnail",b.detailsObj).attr("href",a(".icon",e).attr("href"));b.detailsObj?b.detailsObj.off("click").on("click",function(){a.netajax(b.element,d.id);return false}):a.noop();var c=b.detailsObj?b._position(e):false,g=b._createSplash();g?g.css({left:c.x0,top:c.y0,width:c.w0,height:c.h0,display:"block",position:"absolute"}).animate({left:c.x1,top:c.y1,width:c.w1,height:c.h1},b.options.zoomSpeed,function(){a(this).remove();b.detailsObj.css({left:c.x1,top:c.y1,display:"block"}).removeClass("off").addClass("on");a(".thumbnail > img",b.detailsObj).attr("src",a("img",h).attr("src"));a(".splash",b.detailsObj).removeClass("off").addClass("on").animate({opacity:0},b.options.fadeSpeed,function(){a(this).removeClass("on").addClass("off")})}):a.noop();a("#"+f.actionsid).off("show.tbrowser").on("show.tbrowser",function(){b.detailsObj?b.detailsObj.trigger("cancelhide"):a.noop()}).off("hide.tbrowser").on("hide.tbrowser",function(){b.detailsObj?b.detailsObj.trigger("canhide"):a.noop()})},_effectEnd:function(){var b=this;a(".splash",b.detailsObj).removeClass("off").addClass("on");a(".thumbnail > img",b.detailsObj).attr("src","");var c=b._createSplash();c?c.css({left:b.pos.x1,top:b.pos.y1,width:b.pos.w1,height:b.pos.h1,display:"block",position:"absolute"}).animate({left:b.pos.x0,top:b.pos.y0,width:b.pos.w0,height:b.pos.h0},b.options.zoomSpeed,function(){a(this).animate({opacity:0},b.options.fadeSpeed,function(){a(this).remove()});a("#"+b.options.actionsid).trigger("leave",[{position:"relative",top:"auto",right:"auto"},null])}):a.noop();b.detailsObj?b.detailsObj.removeClass("on").addClass("off"):a.noop()},_bindDetails:function(){var b=this;b.canhide=true;if(this.options.showPreview){this.detailsObj?this.detailsObj.off("cancelhide.splash").on("cancelhide.splash",function(){b.canhide=false}).off("canhide.splash").on("canhide.splash",function(){b.canhide=true}).mouseover(function(){b.timer?clearTimeout(b.timer):a.noop()}).mouseout(function(){b.timer=setTimeout(function(){b.canhide?b._effectEnd():a.noop()},20)}):a.noop();this.detailsObj?a(window).resize(function(){b.detailsObj.removeClass("on").addClass("off")}):a.noop()}},_bindCombobox:function(){var a=this},_composeList:function(){var b=this,c=false;c=parseInt(b.element.css("height"),10)?b.element.css("height"):false;c?b.element.css("height","auto"):a.noop();if(!b.element.parents(".icon-list").size()){b.element.addClass("item-container").wrap("<div class='item-shell' "+(c?"style = 'height:"+c+";' ":"")+"><div class='item-group'><div class='container-shell maximized'></div></div></div>");b.element.parent(".icon-list").find(".size-panel").size()?a.noop():b.options.sizePanel?a(".item-shell").before("<div class='size-panel'><ul class='icon-size'><li><a class='btn-icon-size large selected' href='#'>Large</a></li><li><a class='btn-icon-size medium' href='#'>Medium</a></li><li><a class='btn-icon-size small' href='#'>Small</a></li><li><a class='btn-icon-size extrasmall' href='#'>Extra small</a></li></ul></div>"):a.noop();b.element.parents(".item-shell").wrap('<div class="icon-list" style="overflow:auto; height:'+(c?c+"px":"100%")+';"></div>')}if(!this.options.type){this.options.activeInstance.prepend(this._template());a(".item-shell").on("onDataLoad",function(){b._initThumbnails()}).trigger("onDataLoad")}a(".btn-icon-size").click(function(){var c=a(this);a(".btn-icon-size").removeClass("selected");c.addClass("selected");c.hasClass("extrasmall")&&b._renderIcons(16,244);c.hasClass("small")&&b._renderIcons(32,64);c.hasClass("medium")&&b._renderIcons(64,112);c.hasClass("large")&&b._renderIcons(128,144)})},_initThumbnails:function(){var b=this;if(!this.options.type){this.options.activeInstance.find(".thumbnail").each(function(){b._listenToItem(a(this))});b._renderIcons()}},_sortGroupName:function(){this.options.data.sort(function(a,b){return a.groupindex-b.groupindex})},_destroy:function(){a.Widget.prototype.destroy.apply(this)},_render:function(){},template:function(){},_renderIcons:function(d,c){var h=this;a(".btn-icon-size.selected").hasClass("extrasmall")?a(".item-container").addClass("extrasmall"):a(".item-container").removeClass("extrasmall");var b=this.iconDimensions=d||this.iconDimensions||128,e=this.thumbnailWidth=c||this.thumbnailWidth||b+16,f=this.element.find(".item-group"),g=this.element.find(".icon");g.each(function(){a(this).css({width:b,height:b});c?a(this.parentNode).css({width:e}):a.noop();a(this).attr("data-processing")==="true"?a("img",this).css({"margin-top":(b-16)/2}).closest(".icon").css({background:"#fff"}):a("img",this).css({width:b,height:b})});f.each(function(){var b=a(".container-shell",this);this.minimizedHeight=a(".thumbnail").height()+24;b.hasClass("minimized")?b.css({height:this.minimizedHeight}):b.css({height:"auto"})})},_listenToItem:function(c){var b=this,d=a(".icon",c),e=16;this.options.showSpinnerOnIConClick&&c.spinner({text:this.options.spinnerText,type:this.options.spinnerType});this.options.showSpinnerOnIConClick&&c.spinner(this.options.spinner);c.click(function(d){if(typeof b.options.onClientClick==="function")b.options.onClientClick(b.element,c.tmplItem());if(b.options.type!="tile"){a.netajax(b.element,a(this).tmplItem().data.id||b.options.data[a(this).index()].id);d.stopImmediatePropagation()}});if(this.options.showPreview){d.mouseover(function(){if(b.iconDimensions==e)return;b.options.timer&&clearTimeout(b.options.timer);b.options.timer=setTimeout(function(){b._effectStart(c,c.tmplItem().data)},b.options.templateShowDelay)});d.mouseout(function(){b.options.timer&&clearTimeout(b.options.timer)})}}}))})(jQuery);(function(a){var b=a.sc.templateBrowser.prototype;a.widget("sc.templateBrowser",a.extend({},b,{_listenToItem:function(c){var d=this;b._listenToItem.apply(this,arguments);c.click(function(){d.options.type=="tile"&&!c.parent().hasClass("description")?(window.location.href="#"+d.element.attr("id")+c.tmplItem().data.id):a.noop()})},_initThumbnails:function(){var c=this;b._initThumbnails.apply(this,arguments);if(c.options.type=="tile"){this.options.activeInstance.find(".thumbnail").each(function(){c._listenToItem(a(this))});a(".size-panel").css({display:"none"});c.options.sizePanel=false;a(".btn-icon-size").removeClass("selected");a(".btn-icon-size.extrasmall").addClass("selected");c._renderIcons(16,null)}},_renderIcons:function(){var e=this;b._renderIcons.apply(this,arguments);this.options.type=="tile"?this.element.closest(".container-shell").addClass("tile-list"):a.noop()},_composeList:function(){var c=this;b._composeList.apply(this,arguments);if(this.options.type=="tile"){this.element.closest(".item-shell").css({height:"auto"});this.element.find(".group-name").append(a.tmpl(this.options.template,this.options.data));c.template();a(".item-shell").on("onDataLoad",function(){c._initThumbnails()}).trigger("onDataLoad")}},_createCollapsed:function(){var b=this;this.element.find(".need-collapsed").each(function(){a(this).find(".thumbnail").wrapAll('<div class="field-editor"><div class="field" data-importance="3"></div></div>')})},template:function(){b.template.apply(this,arguments);if(this.options.type=="tile"){var e=[],f=this,d=this.options;for(c in d.data)e[c]={groupindex:d.data[c].groupindex,groupname:d.data[c].groupname};for(var c=e.length-1;c>0;c--)e[c].groupname==e[c-1].groupname?e.splice(c,1):a.noop();for(c in e)for(j in e)c!=j?e[c].groupname==e[j].groupname?delete e[j]:a.noop():a.noop();for(c in e)d.activeInstance.append('<div class="container-group"><div class="group-name">'+e[c].groupname+"</div></div>");for(c in d.data)d.activeInstance.find(".container-group").each(function(){if(a(this).find(".group-name").text()==d.data[c].groupname){d.data[c].idDescription=f.element.attr("id")+d.data[c].id;d.data[c].collapsed?!a(this).hasClass("need-collapsed")?a(this).addClass("need-collapsed"):a.noop():a.noop();if(d.data[c].details){!d.activeInstance.find(".description").size()?d.activeInstance.append('<div class="description"></div>'):a.noop();d.activeInstance.find(".description").append(a.tmpl(d.templateDescription,d.data[c]))}a(this).append(a.tmpl(d.template,d.data[c]))}});f._createCollapsed();f.element.find(".need-collapsed").fieldsgroup({texts:{more:"More",less:"Less"}})}}}))})(jQuery);(function(a){var b=a.sc.templateBrowser.prototype;a.widget("sc.templateBrowser",a.extend({},b,{_initThumbnails:function(){var c=this;b._initThumbnails.apply(this,arguments);if(c.options.type=="list"){this.options.activeInstance.find(".thumbnail").each(function(){c._listenToItem(a(this))});a(".size-panel").css({display:"none"});c.options.sizePanel=false;a(".btn-icon-size").removeClass("selected");a(".btn-icon-size.large").addClass("selected");c._renderIcons(128,null)}},_composeList:function(){var c=this;b._composeList.apply(this,arguments);if(this.options.type=="list"){this.element.find(".group-name").append(a.tmpl(this.options.template,this.options.data));a(".item-shell").on("onDataLoad",function(){c.template();c._initThumbnails()}).trigger("onDataLoad")}},_removeDuplicateItems:function(c){for(var d=[],b=0;b<c.length;b++){for(var g=c[b].id,f=true,e=0;e<d.length;e++)c[b].id==d[e].id?(f=false):a.noop();f?d.push(c[b]):this.options.data.splice(b,1)}},template:function(){b.template.apply(this,arguments);if(this.options.type=="list"){var e=[],f=this,d=this.options;d.emptyGroupName="";for(c in d.data){!d.data[c].groupname?(d.data[c].groupname=d.emptyGroupName):a.noop();e[c]={groupindex:d.data[c].groupindex||0,groupname:d.data[c].groupname}}for(var c=e.length-1;c>0;c--)e[c].groupname==e[c-1].groupname?e.splice(c,1):a.noop();for(c in e)for(j in e)c!=j?e[c].groupname==e[j].groupname?delete e[j]:a.noop():a.noop();f.element.find(".container-group").size()?f.element.find(".container-group").remove():a.noop();for(c in e)d.activeInstance.append('<div class="container-group container-bg"><div class="group-name">'+e[c].groupname+"</div></div>");d.activeInstance.find(".container-group").size()?f._removeDuplicateItems(f.options.data):a.noop();for(c in d.data)d.activeInstance.find(".container-group").each(function(){a(this).find(".group-name").text()==d.data[c].groupname?a(this).append(a.tmpl(d.template,d.data[c])):a.noop()})}}}))})(jQuery);if(typeof Sys!=="undefined"){Sys.Browser.WebKit={};if(navigator.userAgent.indexOf("WebKit/")>-1){Sys.Browser.agent=Sys.Browser.WebKit;Sys.Browser.version=parseFloat(navigator.userAgent.match(/WebKit\/(\d+(\.\d+)?)/)[1]);Sys.Browser.name="WebKit"}Sys.Application.notifyScriptLoaded()}
