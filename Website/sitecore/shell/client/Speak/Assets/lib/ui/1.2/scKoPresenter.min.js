/**!
 *
 * koPresenter
 *
 * Built: Tue Oct 28 2014 11:23:49 GMT+0000 (GMT Standard Time)
 * PackageVersion: 0.0.9
 *
 */

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=function(a,b){function c(a){if(8===a.nodeType)b(a);else if(a.childNodes.length>0)for(var d=0;d<a.childNodes.length;d++)c(a.childNodes[d],b)}return c(a,b)};b.exports={computeComments:c}},{}],2:[function(a,b){b.exports=function(b,c){return a("./ko")(b,c)}},{"./ko":3}],3:[function(a,b){var c=a("./dom");b.exports=function(a,b){var d=function(b){if(b.el){var d=[b.el],e=a.utils.array.toArray(b.el.querySelectorAll("[data-bind]"));d=d.concat(e),d.forEach(function(a){a.__registered=!0}),c.computeComments(b.el,function(a){a.__registered=!0}),b.el.__registered=!0}},e=function(){var a=new b.bindingProvider,c=a.nodeHasBindings;return a.nodeHasBindings=function(a){return a.__registered?!1:c.call(this,a)},a};return{markAsRegistered:d,SPEAKBindingProvider:e}}},{"./dom":1}],4:[function(a,b){var c={el:1,id:1,key:1,script:1,template:1,depth:1,ko:1,app:1,parent:1,on:1,trigger:1,once:1,listenToOnce:1,listenTo:1,off:1,children:1,__properties:1,processSubscribers:1,_s:1,viewModel:1};b.exports={skip:c}},{}],5:[function(a){!function(){var b="undefined"!=typeof window,c=window.ko||requirejs("knockout"),d=b&&window.Sitecore?window.Sitecore.Speak:requirejs("boot"),e=a("./conf"),f=e.skip,g=a("sc-kospeakbindingprovider")(d,c),h=a("./utils/viewModel")(c),i=a("./utils/component")(c),j=Sitecore.Speak.isDebug(),k=function(a,b){b||(b="log"),j&&console[b](a)},l=function(a,b,c,d){h.updateViewModelWhenComponentChange(a,b,c),i.updateComponentWhenViewModelChange(a,b,c,d)},m=function(a,b){for(var c in a)f[c]||b(c)},n=function(a,b,c){k("Create ViewModel for Component: "+a.id),m(a,function(d){h.buildPropertyForViewModel(d,a,b,c),l(d,a,b,c)}),h.buildComputed(a,b),k("Finish creating ViewModel "+a.id+", result is:"),k(b)};c.bindingProvider.instance=new g.SPEAKBindingProvider,Sitecore.Speak.module("scKoPresenter",{buildViewModel:function(a){a.viewModel=a.viewModel||{},n(a)}}),Sitecore.Speak.presenter({name:"scKoPresenter",updateViewModel:function(){n(this,this.viewModel,!0)},initialized:function(){this.viewModel=this.viewModel||{},this._subscriptions={},n(this,this.viewModel,!0),this.viewModel.app=this.app,this.hasTemplate||(k("Applying bindings for component: "+this.id),k("Dom element for "+this.id+" is:"),k(this.el),c.applyBindings(this.viewModel,this.el),g.markAsRegistered(this))}})}()},{"./conf":4,"./utils/component":6,"./utils/viewModel":8,"sc-kospeakbindingprovider":2}],6:[function(a,b){b.exports=function(b){var c=a("./sync")(b),d=function(a,d,e){e[a].arrayBinding?d._subscriptions[a]=c.syncFromKoObsToSpeakObs(a,d,e,b):b.isObservable(e[a])&&(d._subscriptions[a]=e[a].subscribe(c.updateComponent(a,d,e)))};return{updateComponentWhenViewModelChange:d}}},{"./sync":7}],7:[function(a,b){b.exports=function(a){var b=function(a,b,c){return function(){return Array.isArray(b[a])&&b[a].length>0&&b[a][0]?(c[a]._changing=!0,c[a]().length>0&&c[a].removeAll(),b[a].forEach(function(b){c[a].push(b)}),void(c[a]._changing=!1)):void(Array.isArray(b[a])||c[a](b[a]))}},c=function(a,b,c){var d=function(b){var d=b;return function(){c[a]._changing||(c[a]._changing=!0,c[a][d].apply(c[a],arguments),c[a]._changing=!1)}};b[a].on("push",d("push")),b[a].on("pop",d("pop")),b[a].on("slice",d("slice")),b[a].on("concat",d("concat")),b[a].on("shift",d("shift")),b[a].on("unshift",d("unshift")),b[a].on("reverse",d("reverse")),b[a].on("sort",d("sort"))},d=function(b,c,d){var e;return d[b].subscribe(function(a){e=a.slice(0)},void 0,"beforeChange"),d[b].subscribe(function(f){for(var g=a.utils.compareArrays(e,f),h=0,i=g.length;i>h;h++){var j=a.utils.arrayIndexOf(c[b].array||c[b],g[h].value);switch(g[h].status){case"retained":break;case"deleted":j>=0&&!d[b]._changing&&c[b].splice(j,1);break;case"added":d[b]._changing||(0===g[h].index?c[b].unshift(g[h].value):c[b].push(g[h].value))}}c[b].array||d[b]._changing||(c.trigger("change:"+b,c.get(b)),d[b]._changing=!1),e=void 0})},e=function(a,b,c){return function(d){c[a]._changing||(b[a]=d)}};return{updateViewModel:b,syncFromSpeakObsToKoObs:c,syncFromKoObsToSpeakObs:d,updateComponent:e}}},{}],8:[function(a,b){b.exports=function(b){var c=a("./sync")(b),d=function(a,c){var d=a.computed||{},e=Object.keys(d);e.forEach(function(a){var e=d[a];e[a].write&&!e[a].owner&&(e[a].owner=c),c[a]=e.write?b.computed(e):b.computed(e.read,c),c[a].isComputed=!0})},e=function(a,b,d){var e=b;"function"!=typeof e[a]&&("speak"!==d[a].arrayType?e.on("change:"+a,c.updateViewModel(a,e,d)):c.syncFromSpeakObsToKoObs(a,e,d))},f=function(a,c,d,e){var f,g=d,h=c[a],i=h&&h.array,j=Array.isArray(h);!g[a]&&e&&(j||i?(f=i?h.array:h,g[a]=b.observableArray(f.slice(0)),g[a].arrayBinding=!0,g[a].arrayType=i?"speak":"original"):c._s.utils.is.a.function(h)?!g[a]&&c._s.utils.is.a.function(h)&&(g[a]=function(){return c[a].call(c,arguments)}):g[a]=b.isObservable(h)?h:b.observable(h))};return{buildPropertyForViewModel:f,updateViewModelWhenComponentChange:e,buildComputed:d}}},{"./sync":7}]},{},[5]);