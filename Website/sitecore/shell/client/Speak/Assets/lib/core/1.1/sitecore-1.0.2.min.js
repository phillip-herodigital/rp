(function(){for(var n,u=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=t.length,r=window.console=window.console||{};i--;)n=t[i],r[n]||(r[n]=u)})(),function(){"use strict";var e=this,tt={},y=e.__SITECOREDEBUG||!1,dt=window._sc,r,t,f,h,u,b,c,it,l,d,g,at,vt;typeof e.Sitecore!="undefined"?tt=e.Sitecore.Speak:(e.Sitecore={},e.Sitecore.Speak={});t=typeof exports!="undefined"?r=exports:r=e.Sitecore.Speak=e._sc={};var i=e.jQuery,n=e._,s=e.ko;n||typeof require=="undefined"||(n=require("underscore"));Backbone||typeof require=="undefined"||(n=require("backbone"));s||typeof require=="undefined"||(s=require("knockout"));t.VERSION="1.0.1";t.__SPEAKDEBUG=y;t.__info={};t.Pipelines={};t.Factories={};t.Commands={};t.Behaviors={};t.Definitions={Models:{},Views:{},Data:{}};f=t.Definitions.Models;h=t.Definitions.Views;u=t.Definitions.Data;b=t.Commands;c=t.Factories;t.Web={};t.SiteInfo={};t.SiteInfo.virtualFolder="/";t.debug=function(){if(y){switch(arguments.length){case 1:console.log(arguments[0]);return;case 2:console.log(arguments[0],arguments[1]);return;case 3:console.log(arguments[0],arguments[1],arguments[2]);case 4:console.log(arguments[0],arguments[1],arguments[2],arguments[3]);return}console.log(arguments)}};it=function(n,t,r){var u=new s.bindingProvider,f=u.nodeHasBindings;return u.exclusionSelector=n,u.nodeHasBindings=function(n){return n.nodeType!==8&&!i(n).is(u.exclusionSelector)&&i(n).closest(t).length===0?f.call(this,n):n.nodeType===8&&!n.registered?f.call(this,n):!1},u.getBindings=function(n,t){var u=t.$root.$el,f=i(n).closest(r),e;return u&&f.length&&(e=u.is(f),!e)?null:s.bindingProvider.prototype.getBindings.apply(this,arguments)},u};s.bindingProvider.instance=new it(".data-sc-registered",".data-sc-waiting","[data-sc-id]");s.bindingHandlers.readonly={update:function(n,t){var i=s.utils.unwrapObservable(t());i?n.setAttribute("readOnly",!0):n.removeAttribute("readOnly")}};e.dialogClose=function(n){t.trigger("sc-frame-message",n)};e.receiveMessage=function(n,i){t.trigger("sc-frame-message",n,i)};e.getParameterByName=function(n){return n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),regexS="[\\?&]"+n+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href),results==null?"":decodeURIComponent(results[1].replace(/\+/g," "))},function(t){t.Model.extend=t.Collection.extend=t.Router.extend=t.View.extend=function(n,t){var i=r(this,n,t);return i.extend=this.extend,i};var i=function(){},r=function(r,u,f){var e,c=r.prototype,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,s,h,o;if(e=u&&u.hasOwnProperty("constructor")?u.constructor:function(){r.apply(this,arguments)},n.extend(e,r),i.prototype=r.prototype,e.prototype=new i,u){n.extend(e.prototype,u);s=u.nestedlayout||e.prototype.nestedlayout;h=e.prototype.modelType===t.Model;h||u.render||s||(u.render=function(){});h||u.afterRender||s||(u.afterRender=function(){});h||u.beforeRender||s||(u.beforeRender=function(){});for(o in u)typeof u[o]=="function"&&typeof c[o]=="function"&&l.test(u[o])&&(e.prototype[o]=function(n,t){return function(){var r=this._super,i;return this._super=c[n],i=t.apply(this,arguments),this._super=r,i}}(o,u[o])),s||h||o!=="render"&&o!=="beforeRender"&&o!=="afterRender"||(e.prototype[o]=function(t,i){return function(){if(i.apply(this,arguments),this.hasBehavior){var r=[];t==="render"&&(r=this.behaviorsRender);t==="afterRender"&&(r=this.behaviorsAfterRender);t==="beforeRender"&&(r=this.behaviorsBeforeRender);n.each(r,function(n){n.apply(this,arguments)},this)}}}(o,u[o]))}return f&&n.extend(e,f),e.prototype.constructor=e,e.__super__=r.prototype,e}}(Backbone);f.Model=Backbone.Model.extend({ko:!0,modelType:Backbone.Model,set:function(){var t=arguments[2],f,i,r,u;arguments[2]||(arguments[2]={});f=n.clone(arguments[2].silent);i=arguments[2].force;Backbone.Model.prototype.set.apply(this,arguments);t&&t.computed&&(this.computed=this.computed||{},this.computed[arguments[0]]=t);n.isObject(arguments[0])||t&&t.local||this.updateViewModel(arguments[0],i);!n.isObject(arguments[0])||t&&t.local||(r=arguments[0],u=n.keys(r),n.each(u,function(n){this.updateViewModel(n)},this))},constructor:function(t){this.ko&&(this.viewModel={});this.defaults&&t&&n.isObject(t)&&(this.defaults=n.extend(this.defaults,t));this.ko&&this.defaults&&(this._removeComputed(),this._creatingViewModelFromDefaults());this.useLocalStorage&&(this.localStorage=new r.Definitions.Data.LocalStorage(t.name));Backbone.Model.apply(this,[t]);this.ko&&(this._setComputed(),this._preventDefaultFunction(),this._creatingViewModel())},_preventDefaultFunction:function(){var t=["_creatingViewModel","_creatingViewModelFromDefaults","_setComputed","_findAppropriateAndApplyBinding","_removeComputed","_super","_preventDefaultFunction","_validate","bind","change","changedAttributes","clear","clone","constructor","destroy","escape","fetch","get","has","hasChanged","initialize","isNew","isValid","observable","off","on","parse","previous","previousAttributes","save","set","toJSON","trigger","unbind","unset","url"],i=n.functions(this);this.applicableFunctionsFromModel=n.reject(i,function(i){return n.indexOf(t,i)>=0})},_creatingViewModelFromDefaults:function(){var i=this,r=n.keys(this.defaults),t;n.each(r,function(n){this._findAppropriateAndApplyBinding(n,this.defaults)},this);t={};this.applicableFunctionsFromModel&&n.each(this.applicableFunctionsFromModel,function(n){t[n]=function(){i[n].apply(i,arguments)}});n.extend(this.viewModel,t)},_removeComputed:function(){var r=n.keys(this.defaults),t=this.defaults,u=this,i=[];n.each(r,function(r){var e=t[r],u,f;n.isObject(e)&&e.computed&&(u=n.clone(e),f={computed:!0,read:u.read},u.write&&(f=n.extend(f,{write:u.write})),u.owner&&(f=n.extend(f,{owner:u.owner})),i.push({key:r,value:u.value,computed:f}),delete t[r])});u.computeds=i},_setComputed:function(){n.each(this.computeds,function(t){var i=t.value||"",r=n.extend(t.computed,{local:!0});this.set(t.key,i,t.computed,r)},this)},updateViewModel:function(n,t){(this.viewModel&&!this.viewModel[n]||t)&&this._findAppropriateAndApplyBinding(n,this.attributes,t)},_findAppropriateAndApplyBinding:function(t,i,r){var u=this.viewModel||{},f;(!u[t]||r)&&(n.isArray(i[t])?i[t].length>0&&i[t][0]&&i[t][0].modelType===Backbone.Model?(f=[],n.each(i[t],function(n){f.push(n.viewModel)}),u[t]=s.observableArray(f),u[t].nested=!0):u[t]=s.observableArray(i[t]):i[t]&&i[t].constructor&&n.isObject(i[t].constructor.__super__)&&i[t].ko?(u[t]=i[t].viewModel,u[t].nested=!0):this.computed&&this.computed[t]||(u[t]=s.observable(i[t])),this._registerComputed(t),this._registerSubscribe(t))},_registerSubscribe:function(t){var i=this,u=this.subscriptions||[],r=this.viewModel||{};if(!r[t].nested){if(!r[t].isComputed)i.on("change:"+t,function(){if(n.isArray(i.get(t))&&i.get(t).length>0&&i.get(t)[0]&&i.get(t)[0].modelType&&i.get(t)[0].modelType===Backbone.Model){var u=[];n.each(i.get(t),function(n){u.push(n.viewModel)});r[t](u)}else r[t](i.get(t))});r[t].subscribe&&(u[t]=r[t].subscribe(function(n){i.set(t,n)}))}},_registerComputed:function(t){var i=this,u=this.viewModel||{},r;i.computed&&i.computed[t]&&(this.computed[t].write&&!this.computed[t].owner&&(i.computed[t].owner=this.viewModel),r=n.pick(i.computed[t],"write","owner","read"),u[t]=r.write?s.computed(r):s.computed(r.read,this.viewModel),u[t].isComputed=!0)},_creatingViewModel:function(){var t=n.keys(this.attributes);n.each(t,function(n){this._findAppropriateAndApplyBinding(n,this.attributes)},this);n.each(t,this._registerComputed,this);n.each(t,this._registerSubscribe,this)}});f.Model.extend=Backbone.Model.extend;h.View=function(t){t&&(this.app=t.app?t.app:"No parent for this app",delete t.app);var i=this;t&&t.behaviors&&n.each(t.behaviors.split(" "),function(n){i.addBehavior(r.Behaviors[n])});Backbone.View.apply(this,[t]);this.model&&this.$el&&!this.model.viewModel.$el&&(this.model.viewModel.$el=this.$el);this.model&&this.app&&!this.model.viewModel.app&&(this.model.viewModel.app=this.app);this.setupFunctionWhichCouldBeDataBound();this.sync()};n.extend(r.Definitions.Views.View.prototype,Backbone.View.prototype,{setupFunctionWhichCouldBeDataBound:function(){var i=["$","_configure","_ensureElement","setupFunctionWhichCouldBeDataBound","applyBindingsIfApplicable","bind","constructor","delegateEvents","initialize","make","off","on","remove","render","setElement","trigger","unbind","undelegateEvents","afterRender","beforeRender","sync"],r=n.functions(this),t;this.applicableFunctionsFromView=n.reject(r,function(t){return n.indexOf(i,t)>=0});t=this;n.each(this.applicableFunctionsFromView,function(n){if(this.model&&this.model.viewModel[n])throw"Conflicted names between Model and View, please provide different names: "+n;this.model&&(this.model.viewModel[n]=function(){return t[n].apply(t,arguments)})},this)},sync:function(){this.model&&this.model.ko&&(y&&console.log("Applying Binding for the element which has the data-sc-id: "+this.$el.data("sc-id")+". The viewModel you are trying to apply is:",this.model.viewModel),s.applyBindings(this.model.viewModel?this.model.viewModel:this.model,this.$el.get(0)))},listen:{}});h.View.extend=Backbone.View.extend;r.Definitions.App=Backbone.Model.extend({appId:undefined,modelType:"application",initialize:function(){this.Controls=[];this.localStorage=this.appId?new r.Definitions.Data.LocalStorage(this.appId):"you need to provide a appID in order to use localStorage"},run:function(n,i,r){var u=t.Factories.createApp(n,i,r,this);return typeof this.initialized!="undefined"&&this.initialized(),u.ScopedEl.find("[data-sc-cloak]").removeAttr("data-sc-cloak"),u.trigger("app:loaded"),u},insertControl:function(n,t,r){var u=this;i.post("/api/rendering",n,function(n){u.insertMarkups(n,name,t,r)})},insertRendering:function(r,u,f){var p=this,c,l,o=u.ajax||{},e={database:"core",path:"/api/sitecore/Layout/RenderItem"},a=f,s,h,v=i("meta[data-sc-name=sitecoreLanguage]").attr("data-sc-content"),y;return o&&o.success&&(s=o.success),h=o.error,n.isFunction(u)?a=u:u&&(e=n.extend(e,u),c=u.selector?u.selector:undefined,l=u.$el?u.$el:undefined),e.name||(e.name=n.uniqueId("subapp_")),y=e.path+"?sc_itemid="+r+"&sc_database="+e.database+(v?"&sc_lang="+v:""),i.ajax({url:y,method:"GET",beforeSend:o.beforeSend,success:function(n,t,i){s&&s.call(n,t,i);p.insertMarkups(n,e.name,{selector:c,$el:l},a)},error:function(n,i,r){if(n.status===401){t.Helpers.session.unauthorized();return}h&&h.call(n,i,r)},complete:o.complete})},insertMarkups:function(r,u,f,e){var h={prepend:!1,selector:undefined,parent:undefined,$el:undefined},f=n.extend(h,f),s="<div id='"+u+"' data-sc-app style='display:none;'>"+r+"<\/div>",o;o=f.$el?f.$el:f.selector?i(f.selector):i("body");f.prepend?o.prepend(s):o.append(s);t.load(window,o.find("#"+u),function(n){n.ScopedEl.show();e&&e(n)})},destroy:function(){var t=this,i;n.each(t.Controls,function(n){n.view.$el.data("sc-app",null);n.view.$el.removeClass("data-sc-registered")});for(i in t)t[i]instanceof r.Definitions.App&&n.each(t[i].Controls,function(n){n.view.$el.data("sc-app",null);n.view.$el.removeClass("data-sc-registered")});n.each(t.Controls,function(n){s.cleanNode(n.view.$el.get(0));delete n.model;delete n.view});for(i in t)delete t[i];return undefined},closeDialog:function(n){window.top.returnValue=n;window.top.dialogClose(n)},sendMessage:function(n){window.top.receiveMessage(n,e.getParameterByName("sp"))}});r.Definitions.App.extend=Backbone.View.extend;n.extend(r,Backbone.Events);n.extend(h.View.prototype,{addBehavior:function(t){if(this.hasBehavior=!0,this.behaviors=this.behaviors||[],this.behaviorsBeforeRender=this.behaviorsBeforeRender||[],this.behaviorsAfterRender=this.behaviorsAfterRender||[],this.behaviorsRender=this.behaviorsRender||[],!t.initialize&&!t.afterRender&&!t.render&&!t.beforeRender)throw"behavior should have an initialize or an after Render method";t.events&&(this.events?n.extend(this.events,t.events):this.events=t.events);t.initialize&&this.behaviors.push(t.initialize);t.afterRender&&this.behaviorsAfterRender.push(t.afterRender);t.render&&this.behaviorsRender.push(t.render);t.beforeRender&&this.behaviorsBeforeRender.push(t.beforeRender);var i=n.omit(t,"initialize","events","afterRender","render","beforeRender");n.extend(this,i)}});n.extend(t,{destroy:function(n){if(!n&&!n.destroy)throw"you need an app to be destroy";var t=n.name;n.destroy();delete r[t]},noConflict:function(n){return e._sc===r&&(e._sc=dt),n&&e.Speak===r&&(e.Speak=tt),r}});n.extend(t,{load:function(u,f,e){var c=[],s=[],l=!1,a,o,h;f||(f=i("html"),l=!0);i(f).find("[data-sc-require]").each(function(){var t=i(this);t.is("[data-sc-app]")||t.attr("type")==="text/x-sitecore-pagecode"||i.each(t.data("sc-require").split(","),function(t,i){n.indexOf(s,i)<0&&s.push(i)})});window.__speak_config&&window.__speak_config.useBundle?(a=window.location.origin+"/-/speak/v1/bundles/bundle.js?c=1&n=1&f="+s.join(","),c.push(a)):c=c.concat(s);o=[];h=u.__sc_define;u.__sc_define=function(n,t,i){typeof n=="string"&&o.push(n);h&&h(n,t,i)};i(f).find("script[type='text/x-sitecore-pagecode']").each(function(){u.__sc_define(i(this).attr("data-sc-require"))});require(c,function(){var v=i(f).find("script[type='text/x-sitecore-pagecode']"),p=i(f),c=v.attr("data-sc-require"),w=v.data("sc-behaviors"),y=null,a,n;p.attr("data-sc-behaviors",w);a=function(){var n,i;o.length==0?(u.__sc_define=h,n=new y,e?e(n.run(f.attr("id"),f.attr("id"))):n.run(),l&&t.Helpers.overlay.loadOverlays(n)):(i=o,o=[],t.debug("Requiring files: ",i),require(i,a))};n=function(){var i,s;o.length===0?c?(t.debug("Requiring page code: ",[c]),require([c],function(n){y=n;a()})):(u.__sc_define=h,l?(i=r.Factories.createApp(),t.Helpers.overlay.loadOverlays(i),typeof i.initialized!="undefined"&&i.initialized()):i=r.Factories.createApp(f.attr("id"),f.attr("id")),i.ScopedEl.find("[data-sc-cloak]").removeAttr("data-sc-cloak"),l&&i.trigger("app:loaded"),e&&e(i)):(s=o,o=[],t.debug("Requiring files: ",s),require(s,n))};window.__speak_config&&window.__speak_config.useBundle?require(s,function(){n()}):n()})}});n.extend(b,{resolve:function(t){var u,i,r;if(!n.isString(t))throw"provied a correct Path to resolve";for(u=t.split("."),i=e||window,r=0;r<u.length;r++)if(i=i[u[r]],i==null)throw"Reference '"+t+"' not found";return i},executeCommand:function(t,i){if(!t||!n.isString(t))throw"cannot execute command without commandName";var r=b.getCommand(t);r.canExecute(i)&&r.execute(i)},getCommand:function(n){return b.resolve(n)}});var gt=function(){var t=this._scAttrs;n.each(t,function(n){var t,i,r;n.value&&n.value.indexOf("$el.")!==-1&&(t=n.value.substring(4),t.indexOf(":")!==-1?(i=t.split(":"),i.length===2&&(r=this.$el[i[0]](i[1]),typeof r!="undefined"?this.model.set(n.name,r):n.defaultValue&&this.model.set(n.name,n.defaultValue))):this.model.set(n.name,this.$el[t]()))},this);n.each(t,function(n){if(n.on)this.model.on("change:"+n.name,this[n.on],this)},this)},ni=function(){this._scAttrs&&n.each(this._scAttrs,function(t){var i=n.keys(t),r=this.localStorage.get(t.name);r?this.set(t.name,r):i.indexOf("defaultValue")===-1&&t.value&&t.value.indexOf("$el.")!==-1?this.set(t.name,null):i.indexOf("defaultValue")===-1&&t.value.indexOf("$el.")===-1?this.set(t.name,t.value):i.indexOf("defaultValue")>-1?this.set(t.name,t.defaultValue):this.set(t.name,undefined)},this)},ti=function(){this._scAttrs&&n.each(this._scAttrs,function(t){var i=n.keys(t);n.indexOf(i,"defaultValue")===-1&&t.value&&t.value.indexOf("$el.")!==-1?this.set(t.name,null):n.indexOf(i,"defaultValue")===-1&&t.value.indexOf("$el.")===-1?this.set(t.name,t.value):n.indexOf(i,"defaultValue")>-1?this.set(t.name,t.defaultValue):this.set(t.name,undefined)},this)},ii=function(t){var i=t;return function(){var t,r,u;i.prototype.set.apply(this,arguments);t=arguments[2];!n.isObject(arguments[0])||t&&t.local||(r=arguments[0],u=n.keys(r),n.each(u,function(n){this.localStorage.set(n,r[n])},this));n.isObject(arguments[0])||t&&t.computed||this.localStorage.set(arguments[0],arguments[1])}};n.extend(c,{createBehavior:function(n,i){return t.Behaviors=t.Behaviors||{},t.Behaviors[n]?t.debug("You are trying to create twice the behaviour "+n):t.Behaviors[n]=i,t.Behaviors[n]},createBaseComponent:function(i){var s,r,k;if(!i.name||!i.selector)throw"provide a name and/or a selector";var l=i.name,d=i.selector,v=i.attributes,g=i.initialize,y=i.base,nt=n.omit(i,["attributes","name","selector","base","plugin","initialize","listenTo","_scInitFromObject","extendModel","_scInit","_scInitDefaultValue"]),u=f.Model,a=h.View,e,tt=i.localStorage,o=i.extendModel||{},p=i.collection,w;if(y&&(e=n.find(t.Components,function(n){return n.type===y})),e&&(u=e.model,a=e.view),o=tt?n.extend(o,{constructor:function(){u.apply(this,arguments);this._scInitDefaultValueFromLocalStorage()},set:ii(u),useLocalStorage:!0}):n.extend(o,{constructor:function(){u.apply(this,arguments);this._scInitDefaultValue()}}),s=u.extend(o),r=a.extend({initialize:function(){(t.debug("initialize - "+l),this._super(),this.model.componentName==l)&&(this._scInitFromObject?(this._scInit(),this._scInitFromObject()):this._scInit())}}),s=s.extend({_scAttrs:v,_scInitDefaultValue:ti,_scInitDefaultValueFromLocalStorage:ni}),w=n.extend(nt,{_scAttrs:v,_scInit:gt,_scInitFromObject:g}),i.listenTo){var c={},it=a.prototype.listen,b=i.listenTo,rt=n.keys(b);n.each(rt,function(n){c[n+":$this"]=b[n]});c=n.extend(it,c);r=n.extend(r,c)}return p&&(k=Backbone.Collection.extend({model:p})),r=r.extend(w),t.Factories.createComponent(l,s,r,d,k)},createComponent:function(i,r,u,f,e){var o;if(!n.isString(i)||!r||!u||!n.isString(f))throw"please provide a correct: type (str), model, view and el (html class or id)";return t.Components=t.Components||[],t.Definitions.Models[i]=r,t.Definitions.Views[i]=u,e&&(t.Definitions.Collections[i]=e),n.each(t.Components,function(n){if(n.el===f)throw"you are trying to add compoment with the same el (.class or #id)";}),o={type:i,model:r,view:u,el:f,collection:e},t.Components.push(o),o},createApp:function(i,r,u,f){var e={};return n.isObject(i)?(e=i,t.Pipelines.Application.execute(e),e.current):(e.name=i,e.id=r,e.mainApp=u,e.app=f,e.aborted=!1,t.Pipelines.Application.execute(e),e.current)},createPageCode:function(n,i){var r;return r=t.Definitions.App.extend(i),r.extend({appId:n})},createBindingConverter:function(n){if(!n.name||!n.convert)throw"invalid binding converter";if(t.BindingConverters&&t.BindingConverters[n.name])throw"already a converter with the same name";t.BindingConverters=t.BindingConverters||{};t.BindingConverters[n.name]=n.convert}});f.ComponentModel=f.Model.extend({initialize:function(){}});f.ControlModel=f.ComponentModel.extend({initialize:function(){this._super();this.set("isVisible",!0)},toggle:function(){this.set("isVisible",!this.get("isVisible"))}});f.BlockModel=f.ControlModel.extend({initialize:function(){this._super();this.set("width",0);this.set("height",0)}});f.InputModel=f.ControlModel.extend({initialize:function(){this._super();this.set("isEnabled",!0)}});f.ButtonBaseModel=f.ControlModel.extend({initialize:function(){this._super();this.set("isEnabled",!0)}});l=r.Definitions.Views;l.ComponentView=l.View.extend({listen:n.extend({},r.Definitions.Views.View.prototype.listen,{"set:$this":"set"}),initialize:function(){var t,i;if(!this.model)throw"Model required in order to instantiate ComponentView";if(!this.el)throw"Element required in order to instantiate ComponentView";t=this.$el.data("init");t&&(i=n.keys(t),n.each(i,function(n){this.set(n,t[n])},this.model))},set:function(t){t&&n.each(n.keys(t),function(n){this.model.set(n,t[n])},this)}});l.ControlView=l.ComponentView.extend({listen:n.extend({},r.Definitions.Views.ComponentView.prototype.listen,{"toggle:$this":"toggle","focus:$this":"focus","show:$this":"show","hide:$this":"hide"}),initialize:function(){this._super();this.model.set("isVisible",this.$el.css("display")!=="none")},focus:function(){this.$el.focus()},hide:function(){this.model.set("isVisible",!1)},show:function(){this.model.set("isVisible",!0)},toggle:function(){this.model.toggle()}});l.BlockView=l.ControlView.extend({initialize:function(){this._super();this.model.set("width",this.$el.width());this.model.set("height",this.$el.height())}});l.InputView=l.ControlView.extend({listen:n.extend({},r.Definitions.Views.ComponentView.prototype.listen,{"enable:$this":"enable","disable:$this":"disable"}),initialize:function(){this._super();this.model.set("isEnabled",i(this.el).attr("disabled")!="disabled")},disable:function(){this.model.set("isEnabled",!1)},enable:function(){this.model.set("isEnabled",!0)}});l.ButtonBaseView=l.ControlView.extend({listen:n.extend({},r.Definitions.Views.ControlView.prototype.listen,{"enable:$this":"enable","disable:$this":"disable"}),initialize:function(){this._super();this.model.set("isEnabled",i(this.el).attr("disabled")!="disabled")},click:function(){if(this.model.get("isEnabled")){var t=this.$el.attr("data-sc-click");t&&r.Helpers.invocation.execute(t,{control:this,app:this.app});this.model._events&&this.model._events.click&&n.each(this.model._events.click,function(n){n.callback&&n.context&&n.callback.call(n.context)})}},disable:function(){this.model.set("isEnabled",!1)},enable:function(){this.model.set("isEnabled",!0)}});t.Definitions.Collections=t.Definitions.Collections||[];c.createComponent("ComponentBase",f.ComponentModel,h.ComponentView,".sc-componentbase");c.createComponent("ControlBase",f.ControlModel,h.ControlView,".sc-controlbase");c.createComponent("BlockBase",f.BlockModel,h.BlockView,".sc-blockbase");c.createComponent("ButtonBase",f.ButtonBaseModel,h.ButtonBaseView,".sc-buttonBase");c.createComponent("InputBase",f.InputModel,h.InputView,".sc-inputbase");c.createComponent("PageBase",f.Model,h.View,"body");c.createBindingConverter({name:"Has",convert:function(t){return t&&t[0]?n.isArray(t[0])?t[0].length===0?!1:!0:!0:!1}});c.createBindingConverter({name:"Not",convert:function(n){return!(n&&n[0])}});var rt={combine:function(){if(arguments.length===0)return"";var t=n.reduce(arguments,function(t,i){return i&&n.isString(i)?t+"/"+n.compact(i.split("/")).join("/"):t});return t?t.indexOf("/")===0?t:"/"+t:""},isParameterNameAlreadyInUrl:function(n,t){return n.indexOf("?"+t+"=")>=0||n.indexOf("&"+t+"=")>=0},addQueryParameters:function(t,i){var f=n.pairs(i),e="([\\?&])({{param}}=[^&]+)",u,r=t;return n.each(f,function(n){rt.isParameterNameAlreadyInUrl(r,n[0])?(u=new RegExp(e.replace("{{param}}",encodeURIComponent(n[0])),"i"),r=r.replace(u,"$1"+n[0]+"="+n[1])):r=(r+=~r.indexOf("?")?"&":"?")+(encodeURIComponent(n[0])+"="+encodeURIComponent(n[1]))}),r},getQueryParameters:function(t){var r={},i;return n.isString(t)?(i=t.split("?"),i=i.length>1?i[1].split("&"):i[0].split("&"),!i)?undefined:(n.each(i,function(n){var t=n.split("=");t.length===2&&(r[t[0]]=decodeURIComponent(t[1].replace(/\+/g," ")))}),r):r}},ri={parseISO:function(t){var i,r,u,f,e,o;return n.isString(t)?(i=parseInt(t.substr(0,4),10),r=parseInt(t.substr(4,2),10)-1,u=parseInt(t.substr(6,2),10),t.indexOf("T")!==8)?new Date(Date.UTC(i,r,u,0,0,0,0)):(f=parseInt(t.substr(9,2),10),e=parseInt(t.substr(11,2),10),o=parseInt(t.substr(13,2),10),new Date(Date.UTC(i,r,u,f,e,o))):null},toISO:function(t){var i;return n.isDate(t)?(i="",i+=t.getUTCFullYear(),i+=this.ensureTwoDigits(t.getUTCMonth()+1),i+=this.ensureTwoDigits(t.getUTCDate()),i+="T",i+=this.ensureTwoDigits(t.getUTCHours()),i+=this.ensureTwoDigits(t.getUTCMinutes()),i+this.ensureTwoDigits(t.getUTCSeconds())):i},isISO:function(t){var i,r=n.isString(t);return(r&&t.charAt(15)===":"&&(t=t.substr(0,15)),!(r&&(t.length==8||t.length==15)))?!1:(i=this.parseISO(t),Object.prototype.toString.call(i)==="[object Date]"?isNaN(i.getYear())?!1:!0:!1)},ensureTwoDigits:function(n){return n<10?"0"+n.toString():n.toString()}},ut={isId:function(t){return n.isString(t)?/^\{?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\}?$/i.test(t):!1},toId:function(n){return!n||n.length!==32?n:"{"+n.substr(0,8)+"-"+n.substr(8,4)+"-"+n.substr(12,4)+"-"+n.substr(16,4)+"-"+n.substr(20,12)+"}"},toShortId:function(t){return!n.isString(t)||!ut.isId(t)?undefined:t.replace(/-|\{|\}/g,"")}},ui={endsWith:function(n,t){return!t||!n?!1:n.lastIndexOf(t)===n.length-t.length},equals:function(t,i,r){return!n.isString(t)||!n.isString(i)?undefined:r?n.isBoolean(r)?t===i:undefined:t.toLowerCase()===i.toLowerCase()},format:function(t){return t?(n.each(arguments,function(n,i){t=t.replace(new RegExp("\\{"+(i-1)+"\\}","gi"),n)}),t):t},formatByTemplate:function(t,i){if(typeof i!="function")return t;if(typeof t!="string")return"";var r=t.match(/{{(.*?)}}/gi);return n.each(r,function(n){var u=n.replace("{{","").replace("}}",""),r=i(u);typeof r!="undefined"&&r!=null&&(t=t.replace(n,r))}),t}},fi={getOwnProperties:function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t}},ei={execute:function(i,r){var u;if(i){if(u=i.indexOf(":"),u<=0)throw"Invocation is malformed (missing 'handler:')";r=r||{};var f=i.substr(0,u),e=i.substr(u+1),o=n.extend({},{handler:f,target:e},r);t.Pipelines.Invoke.execute(o)}}},oi={loadOverlays:function(n){var u=i("script[type='text/x-sitecore-overlays']"),r,o,f,e;if(u.length!=0){r=u.data("sc-overlays").split("|");o=u.data("sc-parameters");for(f in r)e=r[f]+"?speak="+t.VERSION+"&"+o,i.ajax({url:e,dataType:"json"}).done(function(i){t.Helpers.overlay.processOverlays(n,i,r[f])}).fail(function(n){console.log("Overlay url failed: "+e,n)})}},processOverlays:function(n,t,i){var r=t.overlays;for(var u in r)this.processOverlay(n,r[u],i)},processOverlay:function(t,r,u){var s=r.command,e=r.selector,l=r.placement,h=r.html,f,c,o;if(e.substr(0,10)=="component:"){if(c=e.substr(10),o=n.find(t.Controls,function(n){return n.name==c}),o==null){console.log("Overlay selector not found: "+e);return}f=o.view.$el}else f=i(e);if(f==null||f.length==0){console.log("Overlay selector not found: "+e);return}switch(s){case"insert":this.insert(t,f,l,h,u);break;case"remove":this.remove(t,f);break;case"replace":this.replace(t,f,h,u);break;default:console.log("Unknow overlay command: "+s)}},insert:function(r,u,f,e,o){e="<div data-sc-app id='"+n.uniqueId("overlay-")+"' >"+e+"<\/div>";var s=i(i.parseHTML(e));switch(f){case"before":s.insertBefore(u);break;case"after":s.insertAfter(u);break;case"prepend":u.prepend(e);break;case"append":u.append(e);break;default:console.log("Unknow overlay insert placement: "+f)}t.load(window,s,function(n){t.trigger("overlay-loaded",{app:n,url:o})})},remove:function(n,t){t.remove()},replace:function(n,r,u,f){u=i.parseHTML(u);$html=i(u);r.replaceWith($html);t.load(window,$html,function(n){t.trigger("overlay-loaded",{app:n,url:f})})}},si={init:function(){i(window).resize(function(){t.trigger("window:resize",i(window).width(),i(window).height())})},loaded:function(){t.trigger("window:loaded")}},hi=i("input[name=__RequestVerificationToken]").val(),ci={getAntiForgeryToken:function(){return{formKey:"__RequestVerificationToken",headerKey:"X-RequestVerificationToken",value:hi}}},ft={unauthorized:function(){ft.logout(function(){window.top.location.reload(!0)})},logout:function(n){var r={url:"/api/sitecore/Authentication/Logout?sc_database=master",type:"POST",data:{},cache:!1},u=t.Helpers.antiForgery.getAntiForgeryToken();r.data[u.formKey]=u.value;i.ajax(r).complete(n)}};n.extend(t,{Helpers:{antiForgery:ci,url:rt,date:ri,id:ut,string:ui,object:fi,invocation:ei,overlay:oi,window:si,session:ft}});t.Helpers.window.init();var o=t.Helpers,a={_current:0,converters:[],aborted:!1},li=function(){return a.converters.length},ai=function(t){if(t=t||{},!n.isFunction(t.canConvert)||!n.isFunction(t.convert)||!n.isFunction(t.reConvert)||!n.isString(t.name))throw"invalid converter";a.converters.push(t)},et=function(t){a.converters=n.reject(a.converters,function(n){return n.name===t})},vi=function(t){return n.find(a.converters,function(n){return n.name===t})},yi=function(){return a.converters},pi={name:"date",canConvert:function(n){return o.string.equals(n.type,this.name)||o.string.equals(n.type,"datetime")},convert:function(n){var t="",i=n.value;if(i)try{return o.date.parseISO(i).toLocaleDateString()}catch(r){return t}return t},reConvert:function(n){if(!n)return"";try{var t=new Date(n);return o.date.toISO(t)}catch(i){return n||""}},toStringWithFormat:function(n,t){var i,r,u,f,e,s;if(o.date.isISO(n))try{i=o.date.parseISO(n);r={mmss:{expression:"(\\W|^)mm(\\W+s{1,2}\\W|\\W+s{1,2}$)",value:o.date.ensureTwoDigits(i.getUTCMinutes())},mss:{expression:"(\\W|^)m(\\W+s{1,2}\\W|\\W+s{1,2}$)",value:i.getUTCMinutes().toString()},hmm:{expression:"(\\Wh{1,2}\\W+|^h{1,2}\\W+)mm(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCMinutes())},hm:{expression:"(\\Wh{1,2}\\W+|^h{1,2}\\W+)m(\\W|$)",value:i.getUTCMinutes().toString()},ms:{expression:"(\\Wss\\W|^ss\\W)00(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCMilliseconds())},ampm:{expression:"(\\W|^)AM/PM(\\W|$)",value:i.getUTCHours()>=12?"PM":"AM"},ap:{expression:"(\\W|^)A/P(\\W|$)",value:i.getUTCHours()>=12?"P":"A"},yyyy:{expression:"(\\W|^)yyyy(\\W|$)",value:i.getUTCFullYear().toString()},yy:{expression:"(\\W|^)yy(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCFullYear()%100)},mm:{expression:"(\\W|^)mm(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCMonth()+1)},m:{expression:"(\\W|^)m(\\W|$)",value:(i.getUTCMonth()+1).toString()},dd:{expression:"(\\W|^)dd(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCDate())},d:{expression:"(\\W|^)d(\\W|$)",value:i.getUTCDate().toString()},hh:{expression:"(\\W|^)hh(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCHours())},h:{expression:"(\\W|^)h(\\W|$)",value:i.getUTCHours()>12?(i.getUTCHours()-12).toString():(i.getUTCHours()==0?12:i.getUTCHours()).toString()},ss:{expression:"(\\W|^)ss(\\W|$)",value:o.date.ensureTwoDigits(i.getUTCSeconds())},s:{expression:"(\\W|^)s(\\W|$)",value:i.getUTCSeconds().toString()}};for(u in r)f=r[u]?r[u].expression:"",e="$1"+r[u].value+"$2",f!=""&&(s=new RegExp(f,"g"),t=t.replace(s,e));return t}catch(h){return n}return n}},wi={name:"Icon",baseUrl:o.url.combine(t.SiteInfo.virtualFolder,"~/icon/"),canConvert:function(n){return o.string.equals(n.type,this.name)},convert:function(n){if(this.canConvert(n)){var t=n.value||"/sitecore/images/blank.gif";return t.indexOf("/sitecore/")!==0&&(t=o.url.combine(this.baseUrl,t)),o.string.format('<img src="{0}" alt="" />',t)}},reConvert:function(){}},k={length:li,add:ai,remove:et,get:vi,getAll:yi};k.add(pi);k.add(wi);n.extend(t,{Converters:k});d=r.Pipelines=function(){var t=[];return{add:function(i){if(!i||!i.name||!n.isObject(i))throw new"invalid pipeline";t.push(i);this[i.name]=i},remove:function(i){t=n.reject(t,function(n){return n.name===i});delete r.Pipelines[i]},length:function(){return t.length}}}();d.Pipeline=function(t){return{name:t,processors:[],add:function(t){if(!t||!t.priority||!t.execute||!n.isNumber(t.priority)||!n.isFunction(t.execute))throw"not valid step";this.processors.push(t)},length:function(){return this.processors.length},remove:function(t){this.processors=n.reject(this.processors,function(n){return n===t})},execute:function(t){var i=n.sortBy(this.processors,function(n){return n.priority});n.each(i,function(n){if(t.aborted)return!1;n.execute(t)})}}};var ot=function(n,t){var u=n.split("."),i=u[0],r;i==="this"?new Function(n).call(t.control.model):t.app&&i==="app"?(r=n.replace("app","this"),new Function(r).call(t.app)):new Function(n)()},bi={priority:1e3,execute:function(t){t.handler==="javascript"&&(t.target.indexOf(";")>0?n.each(t.target.split(";"),function(n){ot(n,t)}):ot(t.target,t))}},ki={priority:2e3,execute:function(n){n.handler==="command"&&r.Commands.executeCommand(n.target)}},di={priority:3e3,execute:function(n){var t,u,f;n.handler==="serverclick"&&(t={url:n.target,type:"POST",dataType:"json",data:{}},u=r.Helpers.antiForgery.getAntiForgeryToken(),t.data[u.formKey]=u.value,f=function(t){r.Pipelines.ServerInvoke.execute({data:t,model:n.model})},i.ajax(t).done(f))}},gi={priority:4e3,execute:function(n){var u,e;if(n.handler==="trigger"){if(u=n.app,!u)throw"An application is a required when triggering events";var t=n.target,f={},r=t.indexOf("(");if(r>=0){if(t.indexOf(")",t.length-1)==-1)throw"Missing ')'";e=t.substr(r+1,t.length-r-2);f=i.parseJSON(e);t=t.substr(0,r)}f.sender=n.control;u.trigger(t,f)}}},nr={priority:1e3,execute:function(n){var t=n.data.ViewModel;t!=null&&s.mapping.fromJS(t,{},n.model)}},p=new r.Pipelines.Pipeline("Invoke");p.add(bi);p.add(ki);p.add(di);p.add(gi);r.Pipelines.add(p);g=new r.Pipelines.Pipeline("ServerInvoke");g.add(nr);r.Pipelines.add(g);var v=new d.Pipeline("Application"),st=function(t){return t?n.keys(t).length>0:!1},tr=function(){return{}},br=function(t,i){var r={},u;return st(i)&&(u=n.keys(i),n.each(u,function(n){r[n]=t.attributes[n]!==undefined?function(){return arguments.length?(t.set(n,arguments[0]),arguments[0]):t.get(n)}:function(i){t[n].call(t,i)}})),r},kr=function(t,i){var r={},u;return st(i)&&(u=n.keys(i),n.each(u,function(n){r[n]=function(i){t[n].call(t,i)}})),r},ht=function(t,r,u,f,e,o,s,h,c){var l=i(r),v,a,y,p,w,b,k,d,g;if(c&&(b=l.find("[data-sc-app]"),b.length>0&&i.each(b,function(){i(this).addClass("data-sc-waiting")})),!l.data("sc-app")){if(v=n.uniqueId("sc_"+t.type+"_"),a=l.attr("data-sc-id"),s.appId&&(a=s.appId+":"+a),k=n.filter(l.prop("class").split(" "),function(n){return n.indexOf("sc_")===-1}),l.prop("class",k.join(" ")),l.addClass(v),f&&i("[data-sc-exclude] ."+v).length)return{};if(e&&l.closest("[data-sc-app]").attr("id")&&"#"+l.closest("[data-sc-app]").attr("id")!=o)return{};y=new t.model({type:v,name:a});y.componentName=t.type;l.data("sc-app",u);l.addClass("data-sc-registered");t.collection&&(p=new t.collection);d=l.data("sc-behaviors");w=new t.view({el:"."+v,model:y,collection:p,app:s,behaviors:d});n.each(w.$el.find("[data-bind]"),function(n){var t=i(n);t.closest(".data-sc-waiting").length==0&&t.addClass("data-sc-registered")},this);w.$el.find("*").contents().each(function(){try{this.registered=this.nodeType===8?!0:!1}catch(n){}});s[a]=y;p&&n.extend(s[a],tr(p,t.collection.prototype.defaults));h.Controls.push({name:a,model:y,view:w,collection:p});c&&(g=l.find(".data-sc-waiting"),g.each(function(){i(this).removeClass("data-sc-waiting")}))}return s},ir=function(n,t){return n||(t="body",n="app"),t||(t=n),t!=="body"&&t.indexOf("#")<0&&(t="#"+t),{name:n,el:t,$el:i(t)}},ct=function(t,r){t.find("[data-sc-hasnested]").length===0?r(t):(n.each(t.find("[data-sc-hasnested]"),function(n){ct(i(n),r)}),r(t))},rr={priority:1e3,execute:function(u){u=u||{};var l=u.name,a=u.id,o=u.mainApp,f=u.app,e=ir(l,a),v=i(e.$el).find("[data-sc-exclude]"),h=v.length||!1,c=i(e.$el).find("[data-sc-app]").length||!1,s=[];if(f=f||new r.Definitions.App,f.Controls=u.Controls=[],o||(o=r),o[e.name])throw"already an app with this name";f.ScopedEl=e.$el;f.name=e.name;t.Components&&t.Components.length>0&&n.each(t.Components,function(n){i(e.$el).find(n.el+":not(.data-sc-registered)").each(function(){i(this).data("sc-hasnested")?s.push(n):ht(n,this,e.name,h,c,e.$el.selector,f,u)})});s.length>0&&n.each(s,function(t){i(e.$el).find(t.el+":not(.data-sc-registered)").each(function(){var t=i(this);ct(t,function(t){var i=n.find(s,function(n){return t.is(n.el)});ht(i,t.get(0),e.name,h,c,e.$el.selector,f,u,!0)})})});n.each(u.Controls,function(t){if(t.view.listen){var i=n.keys(t.view.listen);n.each(i,function(n){var i=n,r;if(i.indexOf(":$this")>=0)if(r=t.view.$el.attr("data-sc-id"),r)i=i.replace("$this",r);else return;f.on(i,t.view[t.view.listen[n]],t.view)})}});o===r?o[e.name]=y?f:"application":(o[e.name]=f,o.nested=o.nested||[],o.nested.push(f));e.$el.find("[data-sc-app]").each(function(){var u=i(this),n=u.attr("data-sc-app"),e=u.find("script[type='text/x-sitecore-pagecode']"),r;e&&(r=e.attr("data-sc-require"));r?require(r.split(","),function(t){var i=new t;i.run(n,n,f)}):t.Factories.createApp({name:n,id:n,mainApp:f,aborted:!1})});u.current=f}},ur=function(n){var i=t.BindingConverters[n];return i?i:undefined},lt=function(t){var i,r,u;return t.converter?(i=[],n.each(t.from,function(n){i.push(n.model.get(n.attribute))}),t.converter(i)):(r=t.from[0].model,u=t.from[0].attribute,r.get(u))},fr=function(t){n.each(t.from,function(n){n.model.on("change:"+n.attribute,function(){t.model.set(t.to,lt(t))})});t.model.set(t.to,lt(t))},nt=function(t,i){var r=n.keys(t.attributes),u=n.find(r,function(n){return n===i});return u?i:i.charAt(0).toLowerCase()+i.slice(1)},er=function(t,i){var r=n.keys(t),u=n.find(r,function(n){return n===i});return u?t[i]:t[i.charAt(0).toUpperCase()+i.slice(1)]},or=function(t,i,r){var h=r,u=t.attr("data-sc-bindings"),o=[],s=i[h],f,e;u.indexOf("{")!=0&&(f=[],n.each(u.split(","),function(t){var i=[];n.each(t.split(":"),function(n){i.push('"'+n+'"')});f.push(i.join(":"))}),u="{"+f.join(",")+"}");try{e=JSON.parse(u);n.each(n.keys(e),function(t){var u={from:[],to:t,converter:undefined,model:s},f=e[t],r,h;u.to=nt(s,t);n.isObject(f)?(u.converter=ur(f.converter),n.each(f.parameters,function(n){r=er(i,n.split(".")[0]);h=nt(r,n.split(".")[1]);u.from.push({model:r,attribute:h})})):(r=i[f.split(".")[0]],h=nt(r,f.split(".")[1]),u.from.push({model:r,attribute:h}));o.push(u)});n.each(o,fr)}catch(c){throw"Failed to data-bind: "+r+"\n"+c;}},sr={priority:1500,execute:function(t){t.current.Controls.length!==0&&n.each(t.current.Controls,function(n){n.view.$el.attr("data-sc-bindings")&&or(n.view.$el,t.current,n.view.$el.attr("data-sc-id"))})}},hr={priority:2e3,execute:function(t){n.each(t.Controls,function(n){n.view.beforeRender&&n.view.beforeRender()})}},cr={priority:3e3,execute:function(t){n.each(t.Controls,function(n){n.view.render&&n.view.render()})}},lr={priority:4e3,execute:function(t){n.each(t.Controls,function(n){n.view.afterRender&&n.view.afterRender()})}};v.add(rr);v.add(sr);v.add(hr);v.add(cr);v.add(lr);r.Pipelines.add(v);n.extend(t.Web,{itemWebApi:{takeValidScope:function(n){switch(n){case"self":return"s";case"children":return"c";case"parent":return"p";default:throw"Unsupported scope. It must be either 'self', 'children' or 'parent'";}},addScope:function(i,r){if(r&&n.isArray(r)){var u=n.compact(n.map(r,t.Web.itemWebApi.takeValidScope)).join("|");i=t.Helpers.url.addQueryParameters(i,{scope:u})}return i},addDatabase:function(i,r){return r&&n.isString(r)&&(i=t.Helpers.url.addQueryParameters(i,{sc_database:r})),i},addContentDatabase:function(i,r){return r&&n.isString(r)&&(i=t.Helpers.url.addQueryParameters(i,{sc_content:r})),i},addItemSelectorUrlPortion:function(i,u,f){return u&&n.isString(u)&&(f&&f.facetsRootItemId&&(i=t.Helpers.url.addQueryParameters(i,{facetsRootItemId:f.facetsRootItemId})),u.indexOf("search:")===0?(i=t.Helpers.url.addQueryParameters(i,{search:u.substr(7)}),f&&f.root&&r.Helpers.id.isId(f.root)&&(i=t.Helpers.url.addQueryParameters(i,{root:f.root})),f&&f.searchConfig&&(i=t.Helpers.url.addQueryParameters(i,{searchConfig:f.searchConfig}))):i=u.indexOf("query:")===0?t.Helpers.url.addQueryParameters(i,{query:u.substr(6)}):t.Helpers.id.isId(u)?t.Helpers.url.addQueryParameters(i,{sc_itemid:u}):t.Helpers.url.combine(i,u)),i},addLanguage:function(n,i){return i&&(n=t.Helpers.url.addQueryParameters(n,{language:i})),n},addItemVersion:function(n,i){return i&&(n=t.Helpers.url.addQueryParameters(n,{sc_itemversion:i})),n},getUrl:function(n,i){var u,f,r;return i=i||{},u="/-/item/v1",f="",i.webApi&&(u=i.webApi),i.virtualFolder&&(f=i.virtualFolder),r=t.Helpers.url.combine(u,f),r=this.addItemSelectorUrlPortion(r,n,i),i.scope&&(r=this.addScope(r,i.scope)),i.database&&n!=""&&n.indexOf("search:")===0?r=this.addContentDatabase(r,i.database):i.database&&(r=this.addDatabase(r,i.database)),i.language&&(r=this.addLanguage(r,i.language)),i.version&&(r=this.addItemVersion(r,i.version)),i.payLoad&&(r=t.Helpers.url.addQueryParameters(r,{payload:"full"})),i.formatting&&(r=t.Helpers.url.addQueryParameters(r,{format:i.formatting})),i.sorting&&(r=t.Helpers.url.addQueryParameters(r,{sorting:i.sorting})),i.showHiddenItems&&(r=t.Helpers.url.addQueryParameters(r,{showHiddenItems:i.showHiddenItems})),i.fields&&(r=t.Helpers.url.addQueryParameters(r,{fields:i.fields.join("|")})),i.pageSize&&i.pageSize>0&&(r=t.Helpers.url.addQueryParameters(r,{pageIndex:i.pageIndex,pageSize:i.pageSize})),r}}}),function(n){var o,u=n.Backbone,t=n._,f=n.$,s=u.View.prototype._configure,l=u.View.prototype.render,h=Array.prototype.push,e=Array.prototype.concat,c=Array.prototype.splice,i=r.Definitions.Views.View.extend({constructor:function(n){n=n||{};i.setupView(this,n);u.View.call(this,n)},nestedlayout:!0,insertView:function(n,t){return t?this.setView(n,t,!0):this.setView(n,!0)},insertViews:function(n){return t.isArray(n)?this.setViews({"":n}):(t.each(n,function(i,r){n[r]=t.isArray(i)?i:[i]}),this.setViews(n))},getView:function(n){return this.getViews(n).first().value()},getViews:function(n){var i=t.chain(this.views).map(function(n){return t.isArray(n)?n:[n]},this).flatten().value();return typeof n=="string"?t.chain([this.views[n]]).flatten():t.chain(typeof n=="function"?t.filter(i,n):i)},setView:function(n,i,r){var u,f,o,s=this;if(typeof n!="string"&&(r=i,i=n,n=""),this.views=this.views||{},u=i.__manager__,f=this.views[n],!u)throw new Error("Please set `View#manage` property with selector '"+n+"' to `true`.");return(o=i._options(),u.parent=s,u.selector=n,!r)?(u.hasRendered&&o.partial(s.el,u.selector,i.el,u.append),f&&t.each(e.call([],f),function(n){n.remove()}),this.views[n]=i):(this.views[n]=e.call([],f||[],i),u.append=!0,i)},setViews:function(n){return t.each(n,function(n,i){if(t.isArray(n))return t.each(n,function(n){this.insertView(i,n)},this);this.setView(i,n)},this),this},render:function(){function s(){function s(){var t=f.afterRender;t&&t.call(n,n);n.trigger("afterRender",n)}var i,t;if(u&&(f.contains(u.el,n.el)||f.partial(u.el,r.selector,n.el,r.append)),n.delegateEvents(),r.hasRendered=!0,e.resolveWith(n,[n]),(i=r.queue.shift())?i():delete r.queue,o&&o.queue){t=function(){u.off("afterRender",t,this);s()};return u.on("afterRender",t,n)}s()}function c(){var r=n._options(),f=n.__manager__,u=f.parent,e=u&&u.__manager__;n._render(i._viewRender,r).done(function(){if(!t.keys(n.views).length)return s();var i=t.map(n.views,function(n){var i=t.isArray(n);return i&&n.length?n[0].render().pipe(function(){return r.when(t.map(n.slice(1),function(n){return n.render()}))}):i?n:n.render()});r.when(i).done(function(){s()})})}var n=this,f=n._options(),r=n.__manager__,u=r.parent,o=u&&u.__manager__,e=f.deferred();return r.queue?h.call(r.queue,function(){c()}):(r.queue=[],c(n,e)),e.view=n,e},remove:function(){return i._removeView(this,!0),this._remove.apply(this,arguments)},_options:function(){return i.augment({},this,i.prototype.options,this.options)}},{_cache:{},_makeAsync:function(n,t){var i=n.deferred();return i.async=function(){return i._isAsync=!0,t},i},_viewRender:function(n,r){function s(t){t&&r.html(n.$el,t);u.resolveWith(n,[n])}function o(n,t){var u,f=i._makeAsync(r,function(n){s(n)});i.cache(e,t);t&&(u=r.render.call(f,t,n));f._isAsync||s(u)}var e,f,u,h=n.__manager__;return{render:function(){var l=n.serialize||r.serialize,a=n.data||r.data,s=l||a,h=n.template||r.template,c="";return(n.parent&&n.parent.$el&&(c=n.parent.$el.data("sc-id")),t.isFunction(s)&&(s=s.call(n)),u=i._makeAsync(r,function(n){o(s,n)}),typeof h=="string"&&(e=r.prefix+h),f=i.cache(e+c))?(o(s,f,e),u):(typeof h=="string"?f=r.fetch.call(u,r.prefix+h,c):h!=null&&(f=r.fetch.call(u,h)),u._isAsync||o(s,f),u)}}},_removeViews:function(n,t){typeof n=="boolean"&&(t=n,n=this);n=n||this;n.getViews().each(function(n){(n.__manager__.hasRendered||t)&&i._removeView(n,t)})},_removeView:function(n,r){var f,u=n.__manager__,e=typeof n.keep=="boolean"?n.keep:n.options.keep;if(!e&&(u.append===!0||r)){if(i.cleanViews(n),n._removeViews(!0),n.$el.remove(),!u.parent)return;if(f=u.parent.views[u.selector],t.isArray(f))return t.each(t.clone(f),function(n,t){n&&n.__manager__===u&&c.call(f,t,1)});delete u.parent.views[u.selector]}},cleanViews:function(n){t.each(e.call([],n),function(n){n.unbind();n.model instanceof u.Model&&n.model.off(null,null,n);n.collection instanceof u.Collection&&n.collection.off(null,null,n);n.cleanup&&n.cleanup.call(n)})},cache:function(n,t){return n in this._cache?this._cache[n]:n!=null&&t!=null?this._cache[n]=t:void 0},configure:function(n){this.augment(i.prototype.options,n);n.manage&&(u.View.prototype.manage=!0)},augment:t.forIn?function(n){return t.reduce(Array.prototype.slice.call(arguments,1),function(n,i){return t.forIn(i,function(t,i){n[i]=t}),n},n)}:t.extend,setupView:function(n,r){if(!n.__manager__){var s,c,l,h=u.LayoutManager.prototype,f=t.pick(n,o);t.defaults(n,{views:{},__manager__:{},_removeViews:i._removeViews,_removeView:i._removeView},i.prototype);r=n.options=t.defaults(r||{},n.options,h.options);l=t.pick(r,e.call(["events"],t.values(r.events||{})));i.augment(n,l);(f.render===i.prototype.render||f.render===u.View.prototype.render)&&delete f.render;i.augment(r,f);n._remove=u.View.prototype.remove;n._render=function(n,t){var r=this,u=r.__manager__,i=t.beforeRender;return u.hasRendered&&this._removeViews(),i&&i.call(this,this),this.trigger("beforeRender",this),n(this,t).render()};n.render=i.prototype.render;n.remove!==h.remove&&(n._remove=n.remove,n.remove=h.remove);s=r.views||n.views;t.keys(s).length&&(c=s,n.views={},n.setViews(c));n.options.template?n.options.template=r.template:n.template&&(r.template=n.template,delete n.template)}}});r.Definitions.Views.CompositeView=u.Layout=u.LayoutView=u.LayoutManager=i;i.VERSION="0.7.5";u.View.prototype._configure=function(){var n=s.apply(this,arguments);return this.manage&&i.setupView(this),n};i.prototype.options={prefix:"",deferred:function(){return f.Deferred()},fetch:function(n){return t.template(f(n).html())},partial:function(n,t,i,r){var u=t?f(n).find(t):f(n);this[r?"append":"html"](u,i)},html:function(n,t){n.html(t)},append:function(n,t){n.append(t)},when:function(n){return f.when.apply(null,n)},render:function(n,t){return n(t)},contains:function(n,t){return f.contains(n,t)}};o=t.keys(i.prototype.options);i.prototype.options=t.extend(i.prototype.options,{fetch:function(n,i){var u="[data-layout-"+n+"]",r;if(i&&(u="[data-layout-"+n+"='"+i+"']"),r=f(u).html(),r===undefined)throw"missing template data-layout-"+n+" in order to work";return t.template(r)}})}(this);u.DatabaseUri=function(n){if(!n)throw"Parameter 'databaseName' is null or empty";this.databaseName=n;this.webApi="";this.virtualFolder="/sitecore/shell"};n.extend(u.DatabaseUri.prototype,{getDatabaseName:function(){return this.databaseName}});u.ItemUri=function(n,t){if(!n)throw"Parameter 'databaseUri' is null or empty";if(!t)throw"Parameter 'itemId' is null or empty";this.databaseUri=n;this.itemId=t};n.extend(u.ItemUri.prototype,{getDatabaseName:function(){return this.databaseUri.databaseName},getDatabaseUri:function(){return this.databaseUri},getItemId:function(){return this.itemId}});u.ItemVersionUri=function(t,i,r){if(!t)throw"Parameter 'itemUri' is null";if(!i)throw"Parameter 'language' is null or empty";if(!n.isNumber(r))throw"Parameter 'version' is null or not a number";this.itemUri=t;this.language=i;this.version=r};n.extend(u.ItemVersionUri.prototype,{getDatabaseUri:function(){return this.itemUri.getDatabaseUri()},getDatabaseName:function(){return this.itemUri.getDatabaseName()},getItemUri:function(){return this.itemUri},getItemId:function(){return this.itemUri.getItemId()},getLanguage:function(){return this.language},getVersion:function(){return this.version}});u.FieldUri=function(n,t){if(!n)throw"Parameter 'itemVersionUri' is null or empty";if(!t)throw"Parameter 'fieldId' is null or empty";this.itemVersionUri=n;this.fieldId=t};n.extend(u.FieldUri.prototype,{getDatabaseUri:function(){return this.itemVersionUri.getDatabaseUri()},getDatabaseName:function(){return this.itemVersionUri.getDatabaseName()},getItemUri:function(){return this.itemVersionUri.getItemUri()},getItemId:function(){return this.itemVersionUri.getItemId()},getLanguage:function(){return this.itemVersionUri.getLanguage()},getVersion:function(){return this.itemVersionUri.getVersion()},getFieldId:function(){return this.fieldId}});u.Database=function(n){if(!n)throw"Parameter 'databaseUri' is null";this.databaseUri=n;this.ajaxOptions={dataType:"json"}};n.extend(u.Database.prototype,{convertToItem:function(n){return n.result?n.result.items?n.result.items.length===0?null:n.result.items.length>1?(console.debug("ERROR: Expected a single item"),null):new t.Definitions.Data.Item(n.result.items[0]):(console.debug("ERROR: No items from server"),null):(console.debug("ERROR: No data from server"),null)},convertToItems:function(i){if(!i.result)return console.debug("ERROR: No data from server"),{items:[],totalCount:0,data:i};if(!i.result.items)return console.debug("ERROR: No items from server"),{items:[],totalCount:0,data:i};var r=n.map(i.result.items,function(n){return new t.Definitions.Data.Item(n)});return{items:r,total:i.result.totalCount,data:i.result}},getItem:function(i,r,u){if(!i)throw"Parameter 'id' is null";if(!r)throw"Parameter 'completed' is null";u=u||{};i instanceof t.Definitions.Data.ItemUri&&(u.database=i.getDatabaseName(),i=i.getItemId());i instanceof t.Definitions.Data.ItemVersionUri&&(u.database=i.getDatabaseName(),u.language=i.getLanguage(),u.version=i.getVersion(),i=i.getItemId());var f=this.getUrl(i,u);u.scope&&(n.contains(u.scope,"parent")||n.contains(u.scope,"children"))?this.get(f).pipe(this.convertToItems).done(r).fail(function(n){r(null,n)}):this.get(f).pipe(this.convertToItem).done(r).fail(function(n){r(null,n)})},search:function(n,t,i){if(!t)throw"Parameter 'completed' is null";var r=this.getUrl("search:"+n,i);this.get(r).pipe(this.convertToItems).done(function(n){t(n.items,n.total,n.data)}).fail(function(n){t([],0,n)})},query:function(n,t,i){if(!n)throw"Parameter 'queryExpression' is null";if(!t)throw"Parameter 'completed' is null";var r=this.getUrl("query:"+n,i);this.get(r).pipe(this.convertToItems).done(function(n){t(n.items,n.total,n.data)}).fail(function(n){t([],0,n)})},getChildren:function(n,t,i){if(!n)throw"Parameter 'id' is null";if(!t)throw"Parameter 'completed' is null";i=i||{};i.scope||(i.scope=["children"]);var r=this.getUrl(n,i);this.get(r).pipe(this.convertToItems).done(function(n){t(n.items,n.total,n.data)}).fail(function(n){t([],0,n)})},getUrl:function(n,t){t=t||{};t.database||(t.database=this.databaseUri.getDatabaseName());t.webApi||(t.webApi=this.databaseUri.webApi);t.virtualFolder||(t.virtualFolder=this.databaseUri.virtualFolder);return r.Web.itemWebApi.getUrl(n,t)},get:function(n){return i.ajax({url:n,dataType:this.ajaxOptions.dataType})}});u.Field=function(n,t,i,r,f){if(!n)throw"Parameter 'item' is null";if(!(t instanceof u.FieldUri))throw"Parameter 'fieldUri' is null";this.item=n;this.fieldUri=t;this.fieldName=i||"";this.value=r||"";this.type=f||"Single-Line Text"};n.extend(u.Field.prototype,{toModel:function(){return this.$model||(this.$model=new t.Definitions.Models.Model(this)),this.$model},toViewModel:function(){var t={fieldId:this.fieldUri.getFieldId(),fieldName:this.fieldName,type:this.type,value:new s.observable(this.value)},n=this;return t.value.subscribe(function(t){n.item[n.fieldName]=t;n.value=t}),t}});u.LocalStorage=function(n){if(!n)throw"you need to provide a unique key";this.appID=n;this.fullKey=this.prefix+this.appID;this.localStorageLibrary=i.jStorage};n.extend(u.LocalStorage.prototype,{prefix:"#sc#",get:function(n){var t=this.fullKey+n;return this.localStorageLibrary.get(t)},getAll:function(){var r=this.localStorageLibrary.index(),t={},i;return i=n.filter(r,function(n){return n.indexOf(this.fullKey)>=0},this),n.each(i,function(n){var i=n.substring(this.fullKey.length,n.length);t[i]=this.localStorageLibrary.get(n)},this),t},deleteRecord:function(n){var t=this.fullKey+n;return this.localStorageLibrary.deleteKey(t)},set:function(n,t,i){var r=this.fullKey+n;return this.localStorageLibrary.set(r,t,i)},flush:function(){var t=this.localStorageLibrary.index(),i=n.filter(t,function(n){return n.indexOf(this.fullKey)>=0},this);n.each(i,function(n){this.localStorageLibrary.deleteKey(n)},this)}});var w={options:function(n,t){return{dataType:"json",type:n,data:t}},convertResponse:function(n){return n.statusCode!==200?i.Deferred().reject({readyState:4,status:n.statusCode,responseText:n.error.message}):n.result},createItem:function(n){return new t.Definitions.Data.Item(n.items[0])},triggerCreated:function(n){return t.trigger("item:created",n),n}},ar=function(n,r,u){var e=n,f;if(!n.name||!n.templateId||!n.parentId)throw"Provide valid parameter in order to create an Item";return n.database||(n.database="core"),f=t.Web.itemWebApi.getUrl(e.parentId,{webApi:"/-/item/v1/sitecore/shell",database:n.database}),f=t.Helpers.url.addQueryParameters(f,{name:n.name}),f=t.Helpers.url.addQueryParameters(f,{template:n.templateId}),i.when(i.ajax(f,w.options("POST",r))).pipe(w.convertResponse).pipe(w.createItem).pipe(w.triggerCreated).done(u)},vr=function(r,u){var f;this.$fields?f=n.map(this.$fields,function(n){return{name:n.fieldName,value:this[n.fieldName]}},this):(f=n.map(this.attributes.$fields,function(n){if(this.attributes[n.fieldName]!==n.value)return{name:n.fieldName,value:this.attributes[n.fieldName]}},this),f=n.filter(f,function(n){return typeof n!="undefined"}));var e=this.getUrl(),o={dataType:"json",type:"PUT",data:f},s=function(n){return t.trigger("item:updated",this),n};return i.when(i.ajax(e,o)).pipe(this.convertResponse).pipe(s).done(i.proxy(r,u))},yr=function(t,u){var f=this.getUrl(),e=function(t){if(!t.items)return this;if(t.items.length===0)throw"Item not found";if(date.items.length>1)throw"Expected a single item";var i=t.items[0];return n.each(i.Fields,function(n,t){this[n.Name]=n.Value;var i=this.getFieldById(t);i!=null?i.value=n.Value:this.$fields.push(this,new r.Definitions.Data.Field(fieldUri,n.Name,n.Value,n.Type))},this),this};return i.when(i.ajax(f,{dataType:"json",type:"GET"})).pipe(this.convertResponse).pipe(e).done(i.proxy(t,u))},et=function(n,r){var u=this.getUrl(),f=function(n){return t.trigger("item:deleted",this),n};return i.when(i.ajax(u,{dataType:"json",type:"DELETE"})).pipe(this.convertResponse).pipe(f).done(i.proxy(n,r))},pr=function(n,r,u){var f=[{name:"__itemName",value:n}],e=this.getUrl(),o={dataType:"json",type:"PUT",data:f},s=function(n){return t.trigger("item:renamed",this),n};return i.when(i.ajax(e,o)).pipe(this.convertResponse).pipe(s).done(i.proxy(r,u))};if(u.createItem=ar,at=function(n,t,i){var u=this,r;i=i||{};r=i.success||function(){t&&t(u)};switch(n){case"read":this.read(this).pipe(r);break;case"create":throw"The 'create' operation is not supported";case"update":this.update(this,i).pipe(r);break;case"delete":this.remove(this).pipe(r)}},vt=r.Definitions.Models.Model.extend({idAttribute:"itemId",getUrl:function(){var n=this.get("itemUri"),t=new u.Database(n.getDatabaseUri());return t.getUrl(n.getItemId())},read:yr,remove:et,rename:pr,update:vr}),u.Item=function(t,i){if(!i)if(i=t,i.itemUri)t=i.itemUri;else{var r=new u.DatabaseUri(i.Database);t=new u.ItemUri(r,i.ID)}if(i instanceof u.Item){this.shallowCopy(i);return}this.$fields=[];n.each(i.Fields,function(n,i){this[n.Name]=n.Value;var f=new u.FieldUri(t,i),r=new u.Field(this,f,n.Name,n.Value,n.Type);n.FormattedValue&&(r.formattedValue=n.FormattedValue);n.LongDateValue&&(r.longDateValue=n.LongDateValue);n.ShortDateValue&&(r.shortDateValue=n.ShortDateValue);this.$fields.push(r)},this);this.itemUri=t;this.itemId=t.getItemId();this.itemName=i.Name||"";this.$displayName=i.DisplayName||"";this.$database=i.Database||"";this.$language=i.Language||"";this.$version=i.Version||0;this.$templateName=i.TemplateName||"";this.$templateId=i.TemplateId||"";this.$hasChildren=i.HasChildren||!1;this.$path=i.Path||"";this.$url=i.Url||"";this.$mediaurl=i.MediaUrl||"";this.$icon=i.Icon||""},n.extend(u.Item.prototype,{getFieldById:function(t){return n.find(this.$fields,function(n){return n.fieldUri.getFieldId()==t},this)},shallowCopy:function(t){this.$fields=t.$fields;n.each(t.$fields,function(n){this[n.Name]=n.Value},this);this.itemUri=t.itemUri;this.itemId=t.itemId;this.itemName=t.itemName;this.$displayName=t.$displayName;this.$language=t.$language;this.$version=t.$version;this.$templateName=t.$templateName;this.$templateId=t.$templateId;this.$hasChildren=t.$hasChildren;this.$path=t.$path;this.$url=t.$url;this.$mediaurl=t.$mediaurl},toModel:function(){if(!this.$model){var n=new vt(this);return n.sync=at,n}return this.$model},toViewModel:function(){return this.toModel().viewModel},convertResponse:w.convertResponse}),n.extend(t.Factories,{createJQueryUIComponent:function(t,i,r,u){var o=t.ControlModel.extend({initialize:function(){this._super();r.model&&n.each(n.keys(r.model),function(n){this.model[n]=r.model[n]},this);n.each(r.attributes,function(n){var t=typeof n.defaultValue!="undefined"?n.defaultValue:null;this.set(n.name,t)},this);typeof this.initialized!="undefined"&&this.initialized()}}),f,e;u&&(f=t.ControlModel.extend({initialize:function(){this._super();n.each(r.attributes,function(n){if(n.added!=!0){var t=typeof n.pluginProperty!="undefined"?n.pluginProperty:n.name,i=typeof n.defaultValue!="undefined"?n.defaultValue:null;this.set(t,i)}},this);typeof this.initialized!="undefined"&&this.initialized()}}));e=i.ControlView.extend({initialize:function(t){this._super();var i;if(t=t||{},r.view&&n.each(n.keys(r.view),function(n){this[n]=r.view[n]},this),u&&(this.widgetModel=new f),n.each(r.attributes,function(n){var f,r;i=typeof n.pluginProperty!="undefined"?n.pluginProperty:n.name;f=typeof n.defaultValue!="undefined"?n.defaultValue:null;typeof f!="undefined"&&f!==null&&(t[i]=f);r=this.$el.attr("data-sc-option-"+i);r&&(r=="true"&&(r=!0),r=="false"&&(r=!1),u?this.widgetModel.has(i)&&this.model.set(i,r):this.model.set(n.name,r),t[i]=r)},this),n.each(r.events,function(n){if(typeof t[n.name]=="undefined"){var i=this;t[n.name]=function(t,r){i.raiseEvent(n,t,r)}}},this),this.$el[r.control](t),this.widget=this.$el[r.control],this.widget=this.widget||this.$el.data(r.control),this.widget=this.widget||this.$el.data(r.namespace+r.control),n.each(r.functions,function(n){var t=this;this[n.name]=function(){if(!t.widget[n.name]){var i=t.widget;return i.apply(t.$el,[n.name,arguments[0]])}return t.widget[n.name].apply(t.widget,arguments)}},this),u){this.widgetModel.on("change",function(t){var i={};t.changed&&(n.each(n.keys(t.changed),function(n){i[n]=t.get(n)}),this.$el[r.control]("option",i))},this);this.model.on("change",function(t){var u,i;t.changed&&(n.each(n.keys(t.changed),function(f){i=n.find(r.attributes,function(n){return n.name==f});!i||i.added==!0||i.manualSync==!0||(u=i&&typeof i.pluginProperty!="undefined"?i.pluginProperty:f,this.widgetModel.set(u,t.get(f)))},this),this.$el[r.control]("option",{}))},this)}else this.model.on("change",function(t){var u={},f,i;t.changed&&(n.each(n.keys(t.changed),function(e){n.find(r.attributes,function(n){return n.name==e&&n.added==!0})||(i=n.find(r.attributes,function(n){return n.name==e}),f=i&&typeof i.pluginProperty!="undefined"?i.pluginProperty:e,u[f]=t.get(e))}),this.$el[r.control]("option",u))},this);typeof this.initialized!="undefined"&&this.initialized()},raiseEvent:function(n,t,i){n.on&&this[n.on](t,i);var u=this.$el.attr("data-sc-id"),r=this.app[u];r&&typeof r[n.name]!="undefined"&&r[n.name](r,t,i);u&&this.app.trigger(n.name+":"+u,t,i)}});c.createComponent(r.componentName,o,e,r.selector)}}),y){var yt=0,pt=0,wt=0,bt=[],kt=function(t){var f=0,r=[],u=0,i,t;for(i in t)t[i]&&t[i].modelType==="application"&&(t=t[i],wt+=1,f+=1,n.each(t.Controls,function(n){pt+=1;u+=1;bt.push(n)}),r.push(kt(t[i])));return{numberOfNestedApp:yt,nestedApps:r,nbControlInThisApp:u}},wr=function(){var n=kt(r);return{numberOfApps:yt,totalNumberOfControls:pt,totlaNumberOfApp:wt,alltheControls:bt,allApplications:n}};t.__info=function(){return{Components:{totalComponents:r.Components.length,compontentList:r.Components},Pipelines:{totalPipelines:r.Pipelines.length()},Applications:wr()}}}}.call(window);
/*
//# sourceMappingURL=sitecore-1.0.2.min.js.map
*/