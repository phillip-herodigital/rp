/**!
 *
 * sitecore SPEAK framework
 *
 * Built: Thu Jun 26 2014 08:58:31 GMT+0100 (GMT Daylight Time)
 * PackageVersion: 1.1.0
 *
 */

!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.sc=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(){},{}],2:[function(a,b){var c=function(a){return typeof{}==typeof a},d=function(a,b){for(var c in b){if(a[c])throw"key "+c+" already exists in the module";a[c]=b[c]}},e=function(a,b){var e,f;if(e=this.fn=this.fn||{},!a&&!b)throw"Please, pass at least a module name";return e[a]&&!b?e[a]:e[a]||b?(f=c(b)?b:b.apply({},[this]),!e[a]&&b?e[a]=f:d(e[a],f),e[a]):null};b.exports={attach:function(a){a.module||(a.module=e.bind(a))}}},{}],3:[function(a,b){var c=a("./model/pipelines");c.Pipeline=a("./model/pipeline");var d=a("./pipelines/Invoke/index"),e=a("./pipelines/ServerInvoke/index");c.add(d),c.add(e),b.exports=c},{"./model/pipeline":4,"./model/pipelines":5,"./pipelines/Invoke/index":10,"./pipelines/ServerInvoke/index":12}],4:[function(a,b){var c=a("../utils/index"),d=function(a){var b={processors:[],name:a,add:function(a){if(!(a&&a.priority&&a.execute&&c.isNumber(a.priority)&&c.isFunction(a.execute)))throw"not valid step";this.processors.push(a)},length:function(){return this.processors.length},remove:function(a){this.processors=c.reject(this.processors,function(b){return b.priority===a.priority})},execute:function(a){var b=c.sortBy(this.processors,function(a){return a.priority});b.forEach(function(b){return a.aborted?!1:void b.execute(a)})}};return b};b.exports=d},{"../utils/index":14}],5:[function(a,b){var c=a("../utils/index"),d=[],e={get:function(a){var b;return d.forEach(function(c){c.name===a&&(b=c)}),b},add:function(a){if(!a||!a.name||!c.isObject(a))throw new Error("invalid pipeline");d.push(a),this[a.name]=a},remove:function(a){d=c.reject(d,function(b){return b.name===a})},length:function(){return d.length}};b.exports=e},{"../utils/index":14}],6:[function(a,b){var c=a("../../utils/index"),d={priority:1e3,execute:function(a){"javascript"===a.handler&&(a.target.indexOf(";")>0?a.target.split(";").forEach(function(b){c.executeContext(b,a)}):c.executeContext(a.target,a))}};b.exports=d},{"../../utils/index":14}],7:[function(a,b){var c=(a("../../utils/index"),a("../../utils/command")),d={priority:2e3,execute:function(a){"command"===a.handler&&c.executeCommand(a.target)}};b.exports=d},{"../../utils/command":13,"../../utils/index":14}],8:[function(a,b){var c=(a("../../utils/index"),{priority:3e3,execute:function(a){if("serverclick"===a.handler){var b={url:a.target,type:"POST",dataType:"json"},c=function(b){sitecore.module("pipelines").get("ServerInvoke").execute({data:b,model:a.model})},d=new XMLHttpRequest;d.open(b.type,b.url,!0),"post"===b.type.toLowerCase()&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.send(null),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c(JSON.parse(d.responseText)):console.log("Error: "+d.responseText))}}}});b.exports=c},{"../../utils/index":14}],9:[function(a,b){var c=(a("../../utils/index"),{priority:4e3,execute:function(a){var b=a.app,c=a.target,d={};if("trigger"===a.handler){if(!b)throw new Error("An application is a required when triggering events");var e=c.indexOf("(");if(e>=0){if(-1===c.indexOf(")",c.length-1))throw"Missing ')'";var f=c.substr(e+1,c.length-e-2);d=JSON.parse(f),c=c.substr(0,e)}d.sender=a.control,b.trigger(c,d)}}});b.exports=c},{"../../utils/index":14}],10:[function(a,b){var c=a("../../model/pipeline"),d=new c("Invoke");d.add(a("./1000-HandleJavascript")),d.add(a("./2000-HandleCommand")),d.add(a("./3000-ServerClick")),d.add(a("./4000-TriggerEvent")),b.exports=d},{"../../model/pipeline":4,"./1000-HandleJavascript":6,"./2000-HandleCommand":7,"./3000-ServerClick":8,"./4000-TriggerEvent":9}],11:[function(a,b){var c={priority:1e3,execute:function(a){var b=a.data.ViewModel;null!=b&&ko.mapping.fromJS(b,{},a.model)}};b.exports=c},{}],12:[function(a,b){var c=a("../../model/pipeline"),d=new c("ServerInvoke");d.add(a("./1000-UpdateModel")),b.exports=d},{"../../model/pipeline":4,"./1000-UpdateModel":11}],13:[function(a,b){var c=a("./index"),d=function(a){if(!c.isString(a))throw"provied a correct Path to resolve";for(var b=a.split("."),d=root||window,e=0;e<b.length;e++)if(d=d[b[e]],null==d)throw"Reference '"+a+"' not found";return d},e=function(a){return d(a)},f=function(a,b){if(!a||!c.isString(a))throw new Error("cannot execute command without commandName");var d=e(a);d.canExecute(b)&&d.execute(b)},g={resolve:d,getCommand:e,executeCommand:f};b.exports=g},{"./index":14}],14:[function(a,b){var c=Object.prototype.toString,d={lookupIterator:function(a){return d.isFunction(a)?a:function(b){return b[a]}},isFunction:function(a){return"function"==typeof a},isObject:function(a){return"[object Object]"===c.call(a)},isNumber:function(a){return"[object Number]"===c.call(a)},isString:function(a){return"[object String]"===ttoString.call(a)},pluck:function(a,b){return a.map(function(a){return a[b]})},reject:function(a,b,c){return a.filter(function(a,d,e){return!b.call(c,a,d,e)})},sortBy:function(a,b,c){var e=d.lookupIterator(b);return d.pluck(a.map(function(a,b,d){return{value:a,index:b,criteria:e.call(c,a,b,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")},executeContext:function(a,b){var c=a.split("."),d=c[0];if("this"===d)new Function(a).call(b.control.model);else if(b.app&&"app"===d){var e=a.replace("app","this");new Function(e).call(b.app)}else new Function(a)()}};b.exports=d},{}],15:[function(a,b){var c=0,d=function(){var a=++c+"";return prefix?prefix+a:a},e=/\s+/,f=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},g=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(d));return!1}if(e.test(c)){for(var g=c.split(e),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(d));return!1}return!0},h={on:function(a,b,c){if(!g(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!g(this,"once",a,[b,c])||!b)return this;var d=this,e=_.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,h,i,j,k,l;if(!this._events||!g(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:Object.keys(this._events),i=0,j=h.length;j>i;i++)if(a=h[i],f=this._events[a]){if(this._events[a]=d=[],b||c)for(k=0,l=f.length;l>k;k++)e=f[k],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=Array.prototype.slice.call(arguments,1);if(!g(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&f(c,b),d&&f(d,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var f in d)a=d[f],a.off(b,c,this),(e||0===Object.keys(a._events))&&delete this._listeningTo[f];return this}},i={listenTo:"on",listenToOnce:"once"};for(var j in i){var k=i[j],l=j;h[l]=function(a,b,c){var e=this._listeningTo||(this._listeningTo={}),f=a._listenId||(a._listenId=d("l"));return e[f]=a,c||"object"!=typeof b||(c=this),a[k](b,c,this),this}}b.exports=h},{}],16:[function(a,b){var c="data-sc-component",d="data-sc-id",e="data-sc-app",f="data-sc-require",g="script[type='text/x-sitecore-pagecode']",h="data-sc-template",i="data-sc-properties",j="data-sc-presenter",k="data-sc-pluginId",l="data-sc-hasnested",m="data-sc-id",n="script[type='text/x-sitecore-pluginscript']";b.exports={TYPE:c,ID:d,SCRIPT:f,ROOTSTATICURL:"",TEMPLATE:h,PROPERTIES:i,PRESENTER:j,APP_KEY:e,NESTED:l,ATTR_COMPONENT:"["+m+"]",ATTR_TYPE:"["+c+"]",ATTR_ID:"["+d+"]",ATTR_APP:"["+e+"]",ATTR_SCRIPT:"["+f+"]",ATTR_PAGECODE:g,ATTR_PLUGIN:n,PLUGIN_ID:k,deferred:!1,useBundle:!1,cloak:"data-sc-cloak",defaultPresenter:"scComponentPresenter",lifeCycle:["initialize","initialized","beforeRender","render","afterRender"]}},{}],17:[function(a,b){b.exports=function(a){var b={handleEvent:function(b,c){if(!b)throw new Error("You must pass an invocation");var d=b.indexOf(":");if(0>=d)throw new Error("Invocation is malformed (missing 'handler:')");var e={control:c,app:c.app,handler:b.substr(0,d),target:b.substr(d+1)};a.module("pipelines").get("Invoke").execute(e)}};return b}},{}],18:[function(a,b){var c=a("../model/property"),d=c.prototype,e=a("../utils/index"),f=function(a){var b=function(){c.apply(this,arguments)};e.isFunction(a)&&(b=function(){c.apply(this,arguments),a.apply(this,arguments)});for(var f in d)b.prototype[f]=d[f];for(var g in a)b.prototype[g]=a[g];return b};b.exports={make:f}},{"../model/property":31,"../utils/index":43}],19:[function(a,b){var c=a("../model/pageCode"),d=a("../utils/inheritance"),e=a("../utils/app"),f=a("speakevent"),g=a("../utils/index");b.exports=function(a,b){return{createApplication:function(h,i){var j,k=g.uniqueId(),l=b.setupInjectMethod(i),m=a.find(h.key);return m&&(j=d.wrap(c,m),h=new j(h)),g.extend(h,e),g.extend(h,f),h.inject=function(){l.apply(this,arguments)},h.el&&(h.el.__domID=k,h.__domID=k),h}}}},{"../model/pageCode":30,"../utils/app":40,"../utils/index":43,"../utils/inheritance":44,speakevent:15}],20:[function(a,b){var c=a("../utils/inheritance"),d=function(a){var b=function(a,b){var c={}.constructor!==b.constructor?b.constructor:a.prototype.constructor,d=a.prototype,e=function(a){return function(){a.apply(this,arguments)}}(c);b.constructor!=={}.constructor&&b.prototype&&(d=b.prototype);for(var f in d)e.prototype[f]=d.hasOwnProperty(f)&&b[f]?b[f]:d[f];return e};return{make:function(d,e,f){var g,h=d||a.prototype;return h.make?h.make(e,f):(g=b(a,h),c.wrap(g,e))}}};b.exports=d},{"../utils/inheritance":44}],21:[function(a,b){var c,d,e,f,g=a("../model/store"),h={create:function(){return presenter=new g("presenters"),c=new g("plugins"),d=new g("components"),e=new g("pagecodes"),f=new g("applications"),propertyType=new g("properties"),{presenter:presenter,plugin:c,component:d,pageCode:e,app:f,propertyType:propertyType,build:function(a){f.flush(),d.flush(),e.flush(),c.flush(),f.build(a.applications),d.build(a.components),e.build(a.pageCodes),c.build(a.plugins)}}}};b.exports=h},{"../model/store":32}],22:[function(a,b,c){var d=a("./utils/index"),e=a("modulejs"),f=a("./conf"),g=a("./utils/DOM"),h=a("speakevent"),i={};e.attach(i);var j="undefined"!=typeof window,k=j?window:b.exports,l=k.__SPEAK_LOADED,m=k.__speak_config||{},n=k.Handlebars,o=m.deferred,p=m.lifeCycle||f.lifeCycle,q=function(){},r=function(){},s=function(){},t=function(){},u=function(){},v=j&&m.conf?m.conf:[],w={loader:function(a,b){var c=d.flatten(a);c.length?requirejs(c,function(){b.apply(this,arguments)}):b()},template:n};j&&!k.console&&(k.log=function(){}),m=d.defaults(m,w);var x=m.template,y=a("./manager/template")(x),z=a("./loader/loader")(m),A=a("./factory/store").create(),B=a("./parser/index"),C=a("./manager/plugin")(A.plugin),D=a("./model/basePresenter")(C,A.propertyType),E=a("./model/baseModel")(A.propertyType);componentFactory=a("./factory/component")(D),componentManager=a("./manager/component")(p,A.component,A.presenter,v,componentFactory,i),injectMethod=a("./utils/inject")(z,B,A),applicationFactory=a("./factory/application")(A.pageCode,injectMethod),applicationManager=a("./manager/app")(A.app,componentManager.componentPipeline,C.initializeApplication,applicationFactory),i.init=function(a){if(!l){l=!0,r(i);var b=B.parse();s(i),A.build(b),t(i),z.load(A,function(){u(i),applicationManager.start(function(b,c){1===b.length&&(b=b[0]),i.app=b,i.applications=c,i.trigger("apps:loaded",b),a&&a(b)})})}},i.template=y,i.isDebug=function(){return m.debug||d.getParameterByName("sc_debug")},i.tmpl=y.tmp,i.uniqueId=d.uniqueId,i.async=d.async,i.presenter=A.presenter.create.bind(A.presenter),i.presenter({name:f.defaultPresenter}),i.plugin=A.plugin.create.bind(A.plugin),i.component=A.component.create.bind(A.component),i.pageCode=function(){A.pageCode.isPageCode=!0,A.pageCode.create.apply(A.pageCode,arguments)},i.propertyType=A.propertyType.create.bind(A.propertyType),i.exposeComponent=componentManager.exposeComponent,i.extend=d.extend,i.applyPlugins=C.initializeComponent,i.utils=d,i.Pipelines=i.module("pipelines",a("sc-pipeline")),i.Events=a("./events/index")(i),i.bindable=function(a){return new E(a)},d.extend(i,h),j&&(g.addCloak(),k.document.onreadystatechange=function(){o||l||i.init(q)}),i.ready=function(a){q=a},i.parser={before:function(a){r=a},after:function(a){s=a}},i.loaded={before:function(a){t=a},after:function(a){onAfterParseLoad=a}},c=b.exports=i,j&&(window.Sitecore=window.Sitecore||{},window.Sitecore.Speak=c)},{"./conf":16,"./events/index":17,"./factory/application":19,"./factory/component":20,"./factory/store":21,"./loader/loader":23,"./manager/app":24,"./manager/component":25,"./manager/plugin":26,"./manager/template":27,"./model/baseModel":28,"./model/basePresenter":29,"./parser/index":35,"./utils/DOM":38,"./utils/index":43,"./utils/inject":45,modulejs:2,"sc-pipeline":3,speakevent:15}],23:[function(a,b){var c=a("../utils/index"),d=function(b){var d=b.useBundle,e=b.loader?b.loader:void 0;e||(e=a("loaderJS").use);var f=function(a,b){var f=a.keys();f.length?d?e(c.buildModRequest(f),b):e(a.scripts(),b):b&&b()},g=function(a,b,c,d){var f=a.scripts(),g=c.scripts(),h=b.deps(),i=[];i=i.concat(f).concat(h).concat(g),e(i,d)},h=function(a,b,c,d){var f=a.deps(),g=b.deps(),h=c.deps(),i=[];i=i.concat(f).concat(g).concat(h),e(i,d)};return{load:function(a,b){var c=a.component,d=a.pageCode,e=a.presenter,i=a.plugin;f(c,function(){g(d,c,i,function(){h(d,e,i,b)})})}}};b.exports=d},{"../utils/index":43,loaderJS:1}],24:[function(a,b){var c=a("../utils/index"),d=c.sortByDepth,e=["initialize","initialized","render"],f=function(a,b,f,g){var h=function(a){return function(b){var c=b[a];c&&c.call(b)}},i=function(a){a.trigger("app:loaded",a)},j=function(a){for(var b=e.slice(0);b.length;){var c=b.shift();a.forEach(h(c))}a.forEach(i)};return{start:function k(e,h){h||(h=e,e=void 0),e&&b(this,e);var i=d(c.flattenObject(a.stores)),l=[];i.length>0&&(i.forEach(function(a){var c=g.createApplication(a,k);l.push(c),b(c),f(c)}),j(l)),h(c.createTree(l),l)}}};b.exports=f},{"../utils/index":43}],25:[function(a,b){var c=a("../parser/component"),d=a("../conf"),e=a("../utils/index"),f=function(a,b,f,g,h,i){var j=function(a,b){var c=a.properties||{},d=e.extractProperties(b);for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f]);for(var g in a)a.hasOwnProperty(g)&&(c[g]=a[g]);return c},k=function(a,c){if(!a.el||!a.el.__speak){var d,g,k=b.find(a.key)||{},l=j(a,k),m=e.uniqueId(),n=f.find(k.presenter||a.presenter);return n&&n.make?d=n.make(k,a.el,c):(g=h.make(n,k,a.el,c),d=new g(l,c,a.el,i)),a.el&&(a.el.__speak=!0,a.el.__domID=m),d.id=a.id,d.__domID=m,d.type=a.type,d.name=a.name,d.el=a.el,d.app=c,d.parent=a.parent,d.template=a.template||a.id,d}},l=function(a,b,c){return function(b){b[a]&&(c?b[a](b):b[a]())}},m=function(a,b){var c=[];return a.forEach(function(a){var f=k(a,b);if(f&&(f.el.hasAttribute(d.cloak)&&f.el.removeAttribute(d.cloak),c.push(f),!f.parent||f.depricated)){var g=b[f.id];g?e.isArray(g)?g.push(f):b[f.id]=[g,f]:b[f.id]=f}}),c};return{exposeComponent:k,componentPipeline:function(b,d){d||(d=b.el);var f=c.parse(d),g=a.slice(0);if(!e.contains(g,"initialize"))throw new Error("you must have a initialize method in your lifeCycle");for(;"initialize"!==g[0];){var h=g.shift();f.forEach(l(h,b,!0))}var i=m(f,b);for(b.components=b.components||[],b.components=b.components.concat(i),g.shift();g.length;){var j=g.shift();i.forEach(l(j,b))}return e.createTree(i,"id",!0)}}};b.exports=f},{"../conf":16,"../parser/component":34,"../utils/index":43}],26:[function(a,b){var c=function(a){return{initializeComponent:function(b){a.each(function(a){a.extendComponent&&a.extendComponent(b)})},initializeApplication:function(b){a.each(function(a){a.extendApplication&&a.extendApplication(b)})}}};b.exports=c},{}],27:[function(a,b){var c=a("../utils/index"),d=function(a){if(!a)throw new Error("Template engine has not been set");var b={};return{get:function(a,d){var e=b[a];return e?d(e):void c.xhr({type:"GET",url:a,cb:function(c){return b[a]=c,d(c)}})},tmp:{compile:function(){return a.compile.apply(this,arguments)},original:a}}};b.exports=d},{"../utils/index":43}],28:[function(a,b){var c=a("../utils/index"),d=a("../utils/class"),e=a("../utils/inheritance"),f=a("../utils/events");b.exports=function(a){var b=function(a){c.initializeProperties(this,a),this.__parameterTemplates=a||{},this.defineProperties()};return e.extend(b.prototype,d(a)),e.extend(b.prototype,f),b}},{"../utils/class":41,"../utils/events":42,"../utils/index":43,"../utils/inheritance":44}],29:[function(a,b){var c=a("../utils/index"),d=a("../utils/inheritance"),e=a("../utils/class"),f=a("../utils/events"),g=a("../utils/DOM"),h=function(a,b){var h=function(){};return h.prototype.constructor=function(b,d,e,f){if(this.el=e,this._s=f,this.app=d,this.id=b.id,this.name=b.name,this.children=[],this.parent=b.parent,this.__properties={},this.__parameterTemplates=b.properties||{},c.initializeProperties(this,b),this.initialize.apply(this,arguments),a.initializeComponent(this),this.defineProperties(),this.listen)for(var g in this.listen)if(this.listen.hasOwnProperty(g)){if(-1===g.indexOf(":$this"))return;var h=g.replace("$this",this.id);this.app.on(h,this[this.listen[g]],this)}},h.prototype.initialize=function(){},h.prototype.initialized=function(){},h.prototype.render=function(a){if(this.hasTemplate){var b,c=this,d=this.template||this.type||void 0,e=c.serialize?c.serialize():c;return this._s.template.get(d,function(d){var f=c._s.tmpl.compile(d);return b=f(e),!b&&a?a(b):(c.el.appendChild(g.createDomElement(b)),c.el=c.el.firstChild,c.appendTo&&c.appendTo.appendChild(c.el),a?a(b):void 0)}),this}},h.prototype.serialize=function(){var a={};for(var b in this)if("template"!==b&&"render"!==b&&"serialize"!==b&&"placeholder"!==b&&"app"!==b){var c=this[b];"function"!=typeof c&&(a[b]=c)}return a},d.extend(h.prototype,e(b)),d.extend(h.prototype,f),h};b.exports=h},{"../utils/DOM":38,"../utils/class":41,"../utils/events":42,"../utils/index":43,"../utils/inheritance":44}],30:[function(a,b){var c=a("../utils/index"),d=function(a){c.initializeProperties(this,a)};b.exports=d},{"../utils/index":43}],31:[function(a,b){var c=function(a,b,c){this.propertyName=c,this.value=a,this.component=b,this.initialize.apply(this,arguments)};c.prototype.__type="Property",c.prototype.initialize=function(){},c.prototype.set=function(){throw new Error("read only property")},c.prototype.get=function(){return this.value},b.exports=c},{}],32:[function(a,b){var c=a("../utils/index"),d=function(a){this.name=a,this.dependencies=[],this.stores={}};d.prototype.create=function(a,b,d){var e=this,f=d,g=b;1===arguments.length&&(g=a,this.isPageCode&&c.isFunction(g)||(f=g.name),a=void 0),2!==arguments.length||c.isArray(a)||(g=a,a=void 0,f=b),!d&&2===arguments.length&&c.isArray(a)&&(c.isFunction(b)||(f=b.name)),d||f||(f="app"),this.stores[f]=g||{},this.stores[f].deps=a,c.isArray(a)?e.dependencies.push(a):a&&e.dependencies.push([a])},d.prototype.flush=function(){this.dependencies=[],this.stores={}},d.prototype.find=function(a){if(c.isFunction(a)){var b=[];return this.each(function(c){a(c)&&b.push(c)}),b[0]}return this.stores[a]},d.prototype.deps=function(){return this.dependencies},d.prototype.each=function(a){for(var b in this.stores)this.stores.hasOwnProperty(b)&&a(this.stores[b])},d.prototype.keys=function(){var a=Object.keys(this.stores),b=[];for(var c in a)a.hasOwnProperty(c)&&b.push([a[c]]);return b},d.prototype.build=function(a){var b=this;a.forEach(function(a){if(!b.stores[a.key]&&(b.stores[a.key]=a,a.presenterScript)){var c=[];b.dependencies.forEach(function(b){b.forEach(function(b){for(var d=a.presenterScript.length,e=0;d>e;e++)a.presenterScript[e]===b&&c.push(e)})}),c.forEach(function(b){a.presenterScript.splice(b,1)}),a.presenterScript.length>0&&b.dependencies.push(a.presenterScript)}})},d.prototype.scripts=function(){var a=[];for(var b in this.stores)this.stores.hasOwnProperty(b)&&this.stores[b].script&&(c.isArray(this.stores[b].script)?a=a.concat(this.stores[b].script):a.push(this.stores[b].script));return a},b.exports=d},{"../utils/index":43}],33:[function(a,b){var c=a("../conf"),d=a("../utils/DOM"),e=d.findApps,f=d.getDepth,g=d.findParentApp,h=(d.findNestedApplications,d.findPageCode),i={parse:function(a){var b=[];return e(a).forEach(function(a){var d=g(a),e=void 0,i=h(a);return d&&(e=d.getAttribute(c.APP_KEY)||"app"),b.push({el:a,key:a.getAttribute(c.APP_KEY)||"app",depth:f(a),components:[],parent:e,pageCode:i})}),b}};b.exports=i},{"../conf":16,"../utils/DOM":38}],34:[function(a,b){var c=a("../conf"),d=a("../utils/index"),e=a("../utils/DOM"),f=e.findComponents,g=e.findParentComponent,h=e.getDepth,i=function(a){var b,e,f=a.getAttribute(c.TYPE),i=h(a),j=a.getAttribute(c.ID),k=g(a),l=a.getAttribute(c.SCRIPT),m=a.getAttribute(c.TEMPLATE),n=a.hasAttribute(c.PRESENTER),o=a.getAttribute(c.PRESENTER),p=a.getAttribute(c.PROPERTIES),q=a.hasAttribute(c.TEMPLATE);if(l&&(l=l.split(",")),n&&o){var r=d.removeFileExtensionIfNeeded(o);r.toLowerCase()!==c.defaultPresenter.toLowerCase()&&(b=[r]),e=o.substring(o.lastIndexOf("/")+1,r.length)}if(!n){if(!l)return void 0;e="SpeakPresenter",f=l.join(",")}return{el:a,id:j,depth:i,key:f||"generic",parent:k?k.getAttribute(c.ID):void 0,script:l,template:m,properties:p?JSON.parse(p):void 0,hasTemplate:q,presenter:e?e:void 0,presenterScript:b?b:void 0}},j=function(a){return a},k={parse:function(a){var b=f(a);return d.sortByDepth(b.map(i).filter(j))}};b.exports=k},{"../conf":16,"../utils/DOM":38,"../utils/index":43}],35:[function(a,b){var c=a("./pageCode"),d=a("./component"),e=a("./app"),f=a("./plugin"),g={parse:function(a){var b=d.parse(a),g=e.parse(a),h=c.parse(a),i=f.parse(a);return{components:b,applications:g,pageCodes:h,plugins:i}}};b.exports=g},{"./app":33,"./component":34,"./pageCode":36,"./plugin":37}],36:[function(a,b){var c=a("../conf"),d=(a("../utils/index"),a("../utils/DOM")),e=d.findParentApp,f=d.findPageCodes,g={parse:function(){var a=[];return f().forEach(function(b){var d=e(b),f=b.getAttribute("src");d||(d=document);var g=d.getAttribute(c.APP_KEY);g||(g="app"),a.push({el:b,id:d.getAttribute(c.APP_KEY),key:g,script:[f]})}),a}};b.exports=g},{"../conf":16,"../utils/DOM":38,"../utils/index":43}],37:[function(a,b){var c=a("../conf"),d=(a("../utils/index"),a("../utils/DOM")),e=d.findPlugins,f={parse:function(){var a=[];return e().forEach(function(b){var d=b.getAttribute(c.SCRIPT);a.push({el:b,key:b.getAttribute(c.PLUGIN_ID),script:[d]})}),a}};b.exports=f},{"../conf":16,"../utils/DOM":38,"../utils/index":43}],38:[function(a,b){var c=a("./index").toArray,d=a("../conf"),e=document.createElement("table"),f=document.createElement("tr"),g={tr:document.createElement("tbody"),tbody:e,thead:e,tfoot:e,td:f,th:f,"*":document.createElement("div")},h=/^\s*<(\w+|!)[^>]*>/,i={findApps:function(a){var b=a?a:document;return c(b.querySelectorAll(d.ATTR_APP))},findComponents:function(a){var b=a?a:document;return c(b.querySelectorAll(d.ATTR_COMPONENT))},findPageCodes:function(a){var b=a?a:document;return c(b.querySelectorAll(d.ATTR_PAGECODE))},findPageCode:function(a){var b=a?a:document;return b.querySelector(d.ATTR_PAGECODE)},findPlugins:function(a){var b=a?a:document;return c(b.querySelectorAll(d.ATTR_PLUGIN))},getDepth:function(a,b){var c=a,d=null,e=0;for(b&&(d=b.id);c.parentNode!==d;)c=c.parentNode,e++;return e},findParentApp:function(a){do if(a=a.parentNode,a.hasAttribute&&a.hasAttribute(d.APP_KEY))return a;while(a.parentNode);return null},findParentComponent:function(a){do{if(a=a.parentNode,a.hasAttribute&&a.hasAttribute(d.ID)&&a.hasAttribute(d.NESTED))return a;if(a.hasAttribute&&a.hasAttribute(d.APP_KEY))return null}while(a.parentNode);return null},findNestedApplications:function(a){return c(a.querySelectorAll(d.ATTR_APP))},createDomElement:function(a){var b,c,d;if(!a)return document.createElement("div");d=h.test(a)&&RegExp.$1,d in g||(d="*"),c=g[d],c.innerHTML=""+a,b=c.childNodes;var e=Array.prototype.slice.call(c.childNodes);return e.forEach(function(a){c.removeChild(a)}),1===e.length&&(b=e[0]),b},addCss:function(a){var b=document.createElement("style");b.type="text/css",b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)),document.getElementsByTagName("head")[0].appendChild(b)},addCloak:function(){this.addCss("*["+d.cloak+"] { display:none; !important }")}};b.exports=i},{"../conf":16,"./index":43}],39:[function(a,b){b.exports={get:function(a,b){var c=function(c){console.log(c),b({error:"Something went wrong when loading: "+a})};request=new XMLHttpRequest,request.open("GET",a,!0),request.onload=function(){request.status>=200&&request.status<400?(resp=request.responseText,b({result:resp,error:null})):c()},request.onerror=c,request.send()}}},{}],40:[function(a,b){var c=a("../utils/index"),d=a("../utils/ajax"),e=a("../utils/DOM");b.exports={closeDialog:function(a){window.top.returnValue=a,window.top.dialogClose(a)},remove:function(a){c.isString(a)&&(a=this.el.querySelector(a)),a=a||this.el;var b=this,d=function(a){var d=function(b){return a.__domID===b.__domID},e=c.array.find(b.children,d);e&&(e.remove(),b.children=b.children.filter(d))},f=function(a){var d=function(b){return a.__domID===b.__domID},e=c.array.find(b.components,d);if(e){e.destroy&&e.destroy();var f=b[e.id];f&&(c.isArray(f)?b[e.id]=b[e.id].filter(d):delete b[e.id]),b.components=b.components.filter(d)}},g=e.findApps(a);g&&g.forEach(d);var h=e.findComponents(a);return h&&h.forEach(f),a.innerHTML="",b},sendMessage:function(a){window.top.receiveMessage(a,root.getParameterByName("sp"))},findComponent:function(a){var b,c,d=this.components,e=this.children;return d.forEach(function(d){c||d.id!==a||(c=!0,b=d)}),!b&&e&&e.length&&e.forEach(function(d){c||(b=d.findComponent(a),c=!0)}),b},findApplication:function(a){var b,c,d=this.children||[];return a?this.key===a?this:(d.forEach(function(d){if(!c){var e=d.findApplication(a);e&&(c=!0,b=e)}}),b):null},replace:function(a,b){a.el=a.el?this.el.querySelector(a.el):this.el,this.remove(a.el),this.inject(a,b)},append:function(a,b){c.isObject(a)?a.el=a.el?this.el.querySelector(a.el):this.el:a={html:a,el:this.el},a.append=!0,this.inject(a,b)},prepend:function(a,b){c.isObject(a)?a.el=a.el?this.el.querySelector(a.el):this.el:a={html:a,el:this.el},a.prepend=!0,this.inject(a,b)},insertRendering:function(a,b,e){var f=this,g={database:"core",path:"/"};c.isFunction(b)?e=b:b&&(g=c.extend(g,b)),g.name||(g.name=_.uniqueId("subapp_")),d.get(g.path+"?sc_itemid="+a+"&sc_database="+g.database,function(a){f.insertMarkups(a.result,g.name,g,e)})},insertMarkups:function(a,b,d){var e={prepend:!1,el:d.$el};e=c.extend(e,d),e.el=e.selector?document.querySelectorAll(d.selector):document,this.inject(e)}}},{"../utils/DOM":38,"../utils/ajax":39,"../utils/index":43}],41:[function(a,b){var c=a("../utils/propertyHelper"),d=a("../utils/index"),e=a("../factory/Property");b.exports=function(a){return{get:function(a){a=d.isCapitalize(a)?a:d.capitalize(a);var b=this.__properties[a];return b&&"Property"===b.__type?b.get(a):b},set:function(a,b,c){a=d.isCapitalize(a)?a:d.capitalize(a);var e,f=this.__properties[a];e=f&&"Property"===f.__type&&f.isNew?f.isNew(b):f!==b,e&&(c||this.trigger("beforeChange:"+a,this.get(a)),f&&"Property"===f.__type?f.set(b):this.__properties[a]=b,c||this.trigger("change:"+a,this.get(a)))},defineProperties:function(){this.__properties=this.__properties||{};for(var a in this.__parameterTemplates)c.isProperty(this.__parameterTemplates,a)&&this.defineProperty(a,this.__parameterTemplates[a])},defineProperty:function(b,f){var g=this,h=f,i=c.getCustomType(b),j=i.type?a.find(i.type):void 0,k=i.type?i.property:b;if(i.type){var l=e.make(j);this.__properties[d.capitalize(k)]=new l(h,this,b)}else this.__properties[d.capitalize(k)]=h;Object.defineProperty(this,k,{get:function(){return g.get(k)},set:function(a){g.set(k,a)},enumerable:!0})}}}},{"../factory/Property":18,"../utils/index":43,"../utils/propertyHelper":46}],42:[function(a,b){var c=a("./index"),d=/\s+/,e=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},f=function(a,b,e,f){if(!e)return!0;if("object"==typeof e){for(var g in e)a[b].apply(a,[g,e[g]].concat(f));return!1}if(d.test(e)){for(var h=e.split(d),i=0,j=h.length;j>i;i++){var k=h[i];k=k.split(":"),k[1]=c.capitalize(k[1]),a[b].apply(a,[k.join(":")].concat(f))}return!1}return!0},g={on:function(a,b,d){if(!f(this,"on",a,[b,d])||!b)return this;if(this._events||(this._events={}),a.indexOf(":")>0){var e=a.split(":");e[1]=c.capitalize(e[1]),a=e.join(":")}var g=this._events[a]||(this._events[a]=[]);return g.push({callback:b,context:d,ctx:d||this}),this},once:function(a,b,d){if(!f(this,"once",a,[b,d])||!b)return this;var e=this,g=c.once(function(){e.off(a,g),b.apply(this,arguments)});return g._callback=b,this.on(a,g,d)},off:function(a,b,d){var e,g,h,i,j,k,l,m;if(!this._events||!f(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events={},this;if(a.indexOf(":")>0){var n=a.split(":");n[1]=c.capitalize(n[1]),a=n.join(":")}for(i=a?[a]:Object.keys(this._events),j=0,k=i.length;k>j;j++)if(a=i[j],h=this._events[a]){if(this._events[a]=e=[],b||d)for(l=0,m=h.length;m>l;l++)g=h[l],(b&&b!==g.callback&&b!==g.callback._callback||d&&d!==g.context)&&e.push(g);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=Array.prototype.slice.call(arguments,1);if(!f(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&e(c,b),d&&e(d,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var f in d)a=d[f],a.off(b,c,this),(e||0===Object.keys(a._events))&&delete this._listeningTo[f];return this}},h={listenTo:"on",listenToOnce:"once"};for(var i in h){var j=h[i],k=i;g[k]=function(a,b,d){var e=this._listeningTo||(this._listeningTo={}),f=a._listenId||(a._listenId=c.uniqueId("l"));return e[f]=a,d||"object"!=typeof b||(d=this),a[j](b,d,this),this}}b.exports=g},{"./index":43}],43:[function(a,b){var c=(a("../conf"),0),d=Array.prototype,e=d.forEach,f=d.slice,g=function(a){var b=++c+"";return a?a+b:b},h=function(a){return e.call(f.call(arguments,1),function(b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a},i=function(a){return function(){var b=f.call(arguments);return a.apply(null,[_s.async.each].concat(b))}},j=function(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(window,arguments)}},k=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0;a.forEach(function(e){b(e,j(function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length&&c(null))
}))})},l=function(a,b,c,d){var e=[];b=b.map(function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})},m=function(a){for(var b=[],c=a.length>>>0;c--;)b[c]=a[c];return b},n=function(a,b,c){var d=function(){return a.apply(this,arguments)};h(d,a);var e=function(){this.constructor=d};if(e.prototype=a.prototype,d.prototype=new e,d.prototype.initialize=b||a.prototype.initialize||function(){},c)for(var f in c)c.hasOwnProperty(f)&&(d.prototype[f]=c[f]);return d.__super__=a.prototype,d},o=function(a){var b=a.type,c=a.url,d=a.data,e=a.cb,f=new XMLHttpRequest;f.open(b,c,!0),"post"===b.toLowerCase()&&f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send("post"===b?JSON.stringify(d):null),f.onreadystatechange=function(){4===f.readyState&&(200===f.status||0===f.status?e(f.responseText):console.log("Error: "+f.responseText))}},p=function(){console.log(arguments)},q=function(a,b){var c=document.createElement("script");c.src=a,c.onload=function(){b()},c.onerror=p,(document.head||document.getElementsByTagName("head")[0]).appendChild(c)},r=function(a){return"function"==typeof a},s=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a.prototype[c]=b[c]);return a},t=function(a){var b={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];"function"!=typeof proto&&(b[c]=d)}return b},u=function(a){var b={};for(var c in a){var d=a[c];"function"==typeof d&&"initialize"!==c&&"constructor"!==c&&(b[c]=d)}return b},v=function(a,b){for(var c in b)b.hasOwnProperty(c)&&!r(b[c])&&(a[c]=b[c])},w=function(a,b){return a.depth<b.depth?-1:a.depth>b.depth?1:0},x=function(a){return a.sort(w).reverse()},y=function(a){return a.join(",")+".js"},z=function(a,b,c){for(var d,e=a.length,f=b?b:"key",g={},h=[],i=0;e>i;i++)g[a[i][f]]=i,a[i].children=[];for(var j=0;e>j;j++)if(d=a[j],d.parent){var k=g[d.parent];if(k){var l=a[k];if(d.parent=l?l:void 0,l){var m=d.PageCodeObject||d;if(l.children.push(m),c){if(l[m[b]])throw new Error("Conflicting id for "+b+"in object "+m.id);l[m[b]]=m}}}}else h.push(d.PageCodeObject||d);return h},A=function(a){return a=a.trim(),/.js$/i.test(a)&&(a=a.slice(0,-3)),a},B=function(a,b){return b=b||[],Array.isArray(a)?(a.forEach(function(a){if(Array.isArray(a)){var c=B(a);Array.isArray?b=Array.prototype.concat(b,c):b.push(a)}else b.push(a)}),b):a},C=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},D=function(a){return f.call(arguments,1).forEach(function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},E=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return null==d?"":decodeURIComponent(d[1].replace(/\+/g," "))},F=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},G=function(a,b){var c;return a.forEach(function(d,e){b.call(context,d,e,a)&&(c=d)}),c},H=function(a){return a===Object(a)},I=function(a){return"[object String]"===a.toString()},J=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},K=function(a){return a.charAt(0)===a.charAt(0).toUpperCase()},L=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}};b.exports={uniqueId:g,capitalize:J,isCapitalize:K,extend:h,extractProto:u,isFunction:r,isObject:H,isString:I,attachScript:q,inherits:n,toArray:m,isArray:Array.isArray,once:L,xhr:o,defaults:D,flatten:B,extendProto:s,extractProperties:t,initializeProperties:v,buildModRequest:y,sortByDepth:x,contains:C,array:{find:G},async:{each:k,map:i(l)},flattenObject:F,createTree:z,removeFileExtensionIfNeeded:A,getParameterByName:E}},{"../conf":16}],44:[function(a,b){var c=a("./index"),d={wrap:function(a,b){var d=function(a){return function(){a.apply(this,arguments)}}(a.prototype.constructor);for(var e in a.prototype)a.prototype.hasOwnProperty(e)&&(d.prototype[e]=a.prototype[e]);b.prototype&&(b=b.prototype);for(var f in b)d.prototype[f]=d.prototype[f]&&c.isFunction(b[f])?function(a,b){return function(){b.apply(this,arguments),a.apply(this,arguments)}}(a.prototype[f],b[f]):b[f];return d},extend:function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a}};b.exports=d},{"./index":43}],45:[function(a,b){var c=a("./DOM");b.exports=function(a,b,d){return{setupInjectMethod:function(e){return function(f,g){{var h=this,i=f.el,j=f.html,k=f.append;f.prepend}if(k||k||(k=!0),!h||!i||!j)throw new Error("incorrect parameter passed");var l=c.createDomElement(),m=c.createDomElement(j);l.appendChild(m);var n=b.parse(l),o=function(a){a&&(h.children=h.children||[],h.children=h.children.concat(a)),Sitecore.Speak.applications=Sitecore.Speak.applications.concat(a),k?i.appendChild(m):i.parentNode.insertBefore(m,i),g&&g(h),h.trigger("change",h)};d.build(n),a.load(d,function(){e.call(h,l,o)})}}}}},{"./DOM":38}],46:[function(a,b){var c=[],d=function(a){return a===Object(a)},e=function(a,b){var e,f,g=a[b];return c.forEach(function(a){a===b&&(e=!0)}),e?!1:(g||(g=""),f=g.toString(),Array.isArray(g)?!0:!d(g)&&"[object Function]"!==f&&"[object RegExp]"!==f)},f={isProperty:function(a,b,d){return c=d||[],a.hasOwnProperty(b)&&e(a,b)},getCustomType:function(a){return-1===a.indexOf(":")?{type:void 0,property:a}:{type:a.split(":")[1],property:a.split(":")[0]}}};b.exports=f},{}]},{},[22])(22)});