/*! SPEAK.js, 1.0.2 - generated on 2014-08-12 */
(function(){var e=this,t=e._,n={},i=Array.prototype,r=Object.prototype,a=Function.prototype,o=i.push,s=i.slice,u=i.concat,l=r.toString,c=r.hasOwnProperty,d=i.forEach,f=i.map,h=i.reduce,p=i.reduceRight,m=i.filter,g=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,w=Array.isArray,_=Object.keys,x=a.bind,C=function(e){return e instanceof C?e:this instanceof C?(this._wrapped=e,void 0):new C(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):e._=C,C.VERSION="1.4.4";var S=C.each=C.forEach=function(e,t,i){if(null!=e)if(d&&e.forEach===d)e.forEach(t,i);else if(e.length===+e.length){for(var r=0,a=e.length;a>r;r++)if(t.call(i,e[r],r,e)===n)return}else for(var o in e)if(C.has(e,o)&&t.call(i,e[o],o,e)===n)return};C.map=C.collect=function(e,t,n){var i=[];return null==e?i:f&&e.map===f?e.map(t,n):(S(e,function(e,r,a){i[i.length]=t.call(n,e,r,a)}),i)};var k="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),h&&e.reduce===h)return i&&(t=C.bind(t,i)),r?e.reduce(t,n):e.reduce(t);if(S(e,function(e,a,o){r?n=t.call(i,n,e,a,o):(n=e,r=!0)}),!r)throw new TypeError(k);return n},C.reduceRight=C.foldr=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),p&&e.reduceRight===p)return i&&(t=C.bind(t,i)),r?e.reduceRight(t,n):e.reduceRight(t);var a=e.length;if(a!==+a){var o=C.keys(e);a=o.length}if(S(e,function(s,u,l){u=o?o[--a]:--a,r?n=t.call(i,n,e[u],u,l):(n=e[u],r=!0)}),!r)throw new TypeError(k);return n},C.find=C.detect=function(e,t,n){var i;return I(e,function(e,r,a){return t.call(n,e,r,a)?(i=e,!0):void 0}),i},C.filter=C.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(S(e,function(e,r,a){t.call(n,e,r,a)&&(i[i.length]=e)}),i)},C.reject=function(e,t,n){return C.filter(e,function(e,i,r){return!t.call(n,e,i,r)},n)},C.every=C.all=function(e,t,i){t||(t=C.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,i):(S(e,function(e,a,o){return(r=r&&t.call(i,e,a,o))?void 0:n}),!!r)};var I=C.some=C.any=function(e,t,i){t||(t=C.identity);var r=!1;return null==e?r:v&&e.some===v?e.some(t,i):(S(e,function(e,a,o){return r||(r=t.call(i,e,a,o))?n:void 0}),!!r)};C.contains=C.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):I(e,function(e){return e===t})},C.invoke=function(e,t){var n=s.call(arguments,2),i=C.isFunction(t);return C.map(e,function(e){return(i?t:e[t]).apply(e,n)})},C.pluck=function(e,t){return C.map(e,function(e){return e[t]})},C.where=function(e,t,n){return C.isEmpty(t)?n?null:[]:C[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},C.findWhere=function(e,t){return C.where(e,t,!0)},C.max=function(e,t,n){if(!t&&C.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&C.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return S(e,function(e,r,a){var o=t?t.call(n,e,r,a):e;o>=i.computed&&(i={value:e,computed:o})}),i.value},C.min=function(e,t,n){if(!t&&C.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&C.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return S(e,function(e,r,a){var o=t?t.call(n,e,r,a):e;i.computed>o&&(i={value:e,computed:o})}),i.value},C.shuffle=function(e){var t,n=0,i=[];return S(e,function(e){t=C.random(n++),i[n-1]=i[t],i[t]=e}),i};var T=function(e){return C.isFunction(e)?e:function(t){return t[e]}};C.sortBy=function(e,t,n){var i=T(t);return C.pluck(C.map(e,function(e,t,r){return{value:e,index:t,criteria:i.call(n,e,t,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var V=function(e,t,n,i){var r={},a=T(t||C.identity);return S(e,function(t,o){var s=a.call(n,t,o,e);i(r,s,t)}),r};C.groupBy=function(e,t,n){return V(e,t,n,function(e,t,n){(C.has(e,t)?e[t]:e[t]=[]).push(n)})},C.countBy=function(e,t,n){return V(e,t,n,function(e,t){C.has(e,t)||(e[t]=0),e[t]++})},C.sortedIndex=function(e,t,n,i){n=null==n?C.identity:T(n);for(var r=n.call(i,t),a=0,o=e.length;o>a;){var s=a+o>>>1;r>n.call(i,e[s])?a=s+1:o=s}return a},C.toArray=function(e){return e?C.isArray(e)?s.call(e):e.length===+e.length?C.map(e,C.identity):C.values(e):[]},C.size=function(e){return null==e?0:e.length===+e.length?e.length:C.keys(e).length},C.first=C.head=C.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:s.call(e,0,t)},C.initial=function(e,t,n){return s.call(e,0,e.length-(null==t||n?1:t))},C.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},C.rest=C.tail=C.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},C.compact=function(e){return C.filter(e,C.identity)};var $=function(e,t,n){return S(e,function(e){C.isArray(e)?t?o.apply(n,e):$(e,t,n):n.push(e)}),n};C.flatten=function(e,t){return $(e,t,[])},C.without=function(e){return C.difference(e,s.call(arguments,1))},C.uniq=C.unique=function(e,t,n,i){C.isFunction(t)&&(i=n,n=t,t=!1);var r=n?C.map(e,n,i):e,a=[],o=[];return S(r,function(n,i){(t?i&&o[o.length-1]===n:C.contains(o,n))||(o.push(n),a.push(e[i]))}),a},C.union=function(){return C.uniq(u.apply(i,arguments))},C.intersection=function(e){var t=s.call(arguments,1);return C.filter(C.uniq(e),function(e){return C.every(t,function(t){return C.indexOf(t,e)>=0})})},C.difference=function(e){var t=u.apply(i,s.call(arguments,1));return C.filter(e,function(e){return!C.contains(t,e)})},C.zip=function(){for(var e=s.call(arguments),t=C.max(C.pluck(e,"length")),n=Array(t),i=0;t>i;i++)n[i]=C.pluck(e,""+i);return n},C.object=function(e,t){if(null==e)return{};for(var n={},i=0,r=e.length;r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},C.indexOf=function(e,t,n){if(null==e)return-1;var i=0,r=e.length;if(n){if("number"!=typeof n)return i=C.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r>i;i++)if(e[i]===t)return i;return-1},C.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(b&&e.lastIndexOf===b)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var r=i?n:e.length;r--;)if(e[r]===t)return r;return-1},C.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=0,a=Array(i);i>r;)a[r++]=e,e+=n;return a},C.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,s.call(arguments,1));var n=s.call(arguments,2);return function(){return e.apply(t,n.concat(s.call(arguments)))}},C.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},C.bindAll=function(e){var t=s.call(arguments,1);return 0===t.length&&(t=C.functions(e)),S(t,function(t){e[t]=C.bind(e[t],e)}),e},C.memoize=function(e,t){var n={};return t||(t=C.identity),function(){var i=t.apply(this,arguments);return C.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},C.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},C.defer=function(e){return C.delay.apply(C,[e,1].concat(s.call(arguments,1)))},C.throttle=function(e,t){var n,i,r,a,o=0,s=function(){o=new Date,r=null,a=e.apply(n,i)};return function(){var u=new Date,l=t-(u-o);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,o=u,a=e.apply(n,i)):r||(r=setTimeout(s,l)),a}},C.debounce=function(e,t,n){var i,r;return function(){var a=this,o=arguments,s=function(){i=null,n||(r=e.apply(a,o))},u=n&&!i;return clearTimeout(i),i=setTimeout(s,t),u&&(r=e.apply(a,o)),r}},C.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},C.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},C.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},C.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},C.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)C.has(e,n)&&(t[t.length]=n);return t},C.values=function(e){var t=[];for(var n in e)C.has(e,n)&&t.push(e[n]);return t},C.pairs=function(e){var t=[];for(var n in e)C.has(e,n)&&t.push([n,e[n]]);return t},C.invert=function(e){var t={};for(var n in e)C.has(e,n)&&(t[e[n]]=n);return t},C.functions=C.methods=function(e){var t=[];for(var n in e)C.isFunction(e[n])&&t.push(n);return t.sort()},C.extend=function(e){return S(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},C.pick=function(e){var t={},n=u.apply(i,s.call(arguments,1));return S(n,function(n){n in e&&(t[n]=e[n])}),t},C.omit=function(e){var t={},n=u.apply(i,s.call(arguments,1));for(var r in e)C.contains(n,r)||(t[r]=e[r]);return t},C.defaults=function(e){return S(s.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},C.clone=function(e){return C.isObject(e)?C.isArray(e)?e.slice():C.extend({},e):e},C.tap=function(e,t){return t(e),e};var D=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof C&&(e=e._wrapped),t instanceof C&&(t=t._wrapped);var r=l.call(e);if(r!=l.call(t))return!1;switch(r){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var a=n.length;a--;)if(n[a]==e)return i[a]==t;n.push(e),i.push(t);var o=0,s=!0;if("[object Array]"==r){if(o=e.length,s=o==t.length)for(;o--&&(s=D(e[o],t[o],n,i)););}else{var u=e.constructor,c=t.constructor;if(u!==c&&!(C.isFunction(u)&&u instanceof u&&C.isFunction(c)&&c instanceof c))return!1;for(var d in e)if(C.has(e,d)&&(o++,!(s=C.has(t,d)&&D(e[d],t[d],n,i))))break;if(s){for(d in t)if(C.has(t,d)&&!o--)break;s=!o}}return n.pop(),i.pop(),s};C.isEqual=function(e,t){return D(e,t,[],[])},C.isEmpty=function(e){if(null==e)return!0;if(C.isArray(e)||C.isString(e))return 0===e.length;for(var t in e)if(C.has(e,t))return!1;return!0},C.isElement=function(e){return!(!e||1!==e.nodeType)},C.isArray=w||function(e){return"[object Array]"==l.call(e)},C.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){C["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),C.isArguments(arguments)||(C.isArguments=function(e){return!(!e||!C.has(e,"callee"))}),true&&(C.isFunction=function(e){return"function"==typeof e}),C.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},C.isNaN=function(e){return C.isNumber(e)&&e!=+e},C.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==l.call(e)},C.isNull=function(e){return null===e},C.isUndefined=function(e){return void 0===e},C.has=function(e,t){return c.call(e,t)},C.noConflict=function(){return e._=t,this},C.identity=function(e){return e},C.times=function(e,t,n){for(var i=Array(e),r=0;e>r;r++)i[r]=t.call(n,r);return i},C.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};A.unescape=C.invert(A.escape);var O={escape:RegExp("["+C.keys(A.escape).join("")+"]","g"),unescape:RegExp("("+C.keys(A.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(e){C[e]=function(t){return null==t?"":(""+t).replace(O[e],function(t){return A[e][t]})}}),C.result=function(e,t){if(null==e)return null;var n=e[t];return C.isFunction(n)?n.call(e):n},C.mixin=function(e){S(C.functions(e),function(t){var n=C[t]=e[t];C.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),U.call(this,n.apply(C,e))}})};var N=0;C.uniqueId=function(e){var t=++N+"";return e?e+t:t},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(e,t,n){var i;n=C.defaults({},n,C.templateSettings);var r=RegExp([(n.escape||M).source,(n.interpolate||M).source,(n.evaluate||M).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(r,function(t,n,i,r,s){return o+=e.slice(a,s).replace(E,function(e){return"\\"+j[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),a=s+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=Function(n.variable||"obj","_",o)}catch(s){throw s.source=o,s}if(t)return i(t,C);var u=function(e){return i.call(this,e,C)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},C.chain=function(e){return C(e).chain()};var U=function(e){return this._chain?C(e).chain():e};C.mixin(C),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];C.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],U.call(this,n)}}),S(["concat","join","slice"],function(e){var t=i[e];C.prototype[e]=function(){return U.call(this,t.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var e,t=this,n=t.Backbone,i=[],r=i.push,a=i.slice,o=i.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="0.9.10";var s=t._;!s&&"undefined"!=typeof require&&(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var u=/\s+/,l=function(e,t,n,i){if(!n)return!0;if("object"==typeof n)for(var r in n)e[t].apply(e,[r,n[r]].concat(i));else{if(!u.test(n))return!0;n=n.split(u),r=0;for(var a=n.length;a>r;r++)e[t].apply(e,[n[r]].concat(i))}},c=function(e,t){var n,i=-1,r=e.length;switch(t.length){case 0:for(;r>++i;)(n=e[i]).callback.call(n.ctx);break;case 1:for(;r>++i;)(n=e[i]).callback.call(n.ctx,t[0]);break;case 2:for(;r>++i;)(n=e[i]).callback.call(n.ctx,t[0],t[1]);break;case 3:for(;r>++i;)(n=e[i]).callback.call(n.ctx,t[0],t[1],t[2]);break;default:for(;r>++i;)(n=e[i]).callback.apply(n.ctx,t)}},i=e.Events={on:function(e,t,n){return l(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var i=this,r=s.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n),this},off:function(e,t,n){var i,r,a,o,u,c,d,f;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(o=e?[e]:s.keys(this._events),u=0,c=o.length;c>u;u++)if(e=o[u],i=this._events[e]){if(a=[],t||n)for(d=0,f=i.length;f>d;d++)r=i[d],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&a.push(r);this._events[e]=a}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&c(n,t),i&&c(i,arguments),this},listenTo:function(e,t,n){var i=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=s.uniqueId("l"));return i[r]=e,e.on(t,"object"==typeof t?this:n,this),this},stopListening:function(e,t,n){var i=this._listeners;if(i){if(e)e.off(t,"object"==typeof t?this:n,this),!t&&!n&&delete i[e._listenerId];else{"object"==typeof t&&(n=this);for(var r in i)i[r].off(t,n,this);this._listeners={}}return this}}};i.bind=i.on,i.unbind=i.off,s.extend(e,i);var d=e.Model=function(e,t){var n,i=e||{};this.cid=s.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(i=this.parse(i,t)||{}),(n=s.result(this,"defaults"))&&(i=s.defaults({},i,n)),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(d.prototype,i,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,r,a,o,u,l,c;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;a=n.unset,o=n.silent,e=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=s.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)t=r[i],s.isEqual(c[i],t)||e.push(i),s.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,a?delete c[i]:c[i]=t;if(!o)for(e.length&&(this._pending=!0),t=0,i=e.length;i>t;t++)this.trigger("change:"+e[t],this,c[e[t]],n);if(u)return this;if(!o)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t,n={};for(t in this.attributes)n[t]=void 0;return this.set(n,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(n in e)s.isEqual(r[n],t=e[n])||((i||(i={}))[n]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,i){return e.set(e.parse(n,i),i)?(t&&t(e,n,i),void 0):!1},this.sync("read",this,e)},save:function(e,t,n){var i,r,a=this.attributes;return null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t,!i||n&&n.wait||this.set(i,n)?(n=s.extend({validate:!0},n),this._validate(i,n)?(i&&n.wait&&(this.attributes=s.extend({},a,i)),void 0===n.parse&&(n.parse=!0),r=n.success,n.success=function(e,t,n){e.attributes=a;var o=e.parse(t,n);return n.wait&&(o=s.extend(i||{},o)),s.isObject(o)&&!e.set(o,n)?!1:(r&&r(e,t,n),void 0)},e=this.isNew()?"create":n.patch?"patch":"update","patch"===e&&(n.attrs=i),e=this.sync(e,this,n),i&&n.wait&&(this.attributes=a),e):!1):!1},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(e,t,r){(r.wait||e.isNew())&&i(),n&&n(e,t,r)},this.isNew())return e.success(this,null,e),!1;var r=this.sync("delete",this,e);return e.wait||i(),r},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||T();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var f=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))};s.extend(f.prototype,i,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var n,i,a,u,l,c,d,f,h,p;for(d=[],f=t.at,h=this.comparator&&null==f&&!1!=t.sort,p=s.isString(this.comparator)?this.comparator:null,n=0,i=e.length;i>n;n++)(a=this._prepareModel(u=e[n],t))?(l=this.get(a))?t.merge&&(l.set(u===a?a.attributes:u,t),h&&!c&&l.hasChanged(p)&&(c=!0)):(d.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)):this.trigger("invalid",this,u,t);if(d.length&&(h&&(c=!0),this.length+=d.length,null!=f?o.apply(this.models,[f,0].concat(d)):r.apply(this.models,d)),c&&this.sort({silent:!0}),t.silent)return this;for(n=0,i=d.length;i>n;n++)(a=d[n]).trigger("add",a,this,t);return c&&this.trigger("sort",this,t),this},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var n,i,r,a;for(n=0,i=e.length;i>n;n++)(a=this.get(e[n]))&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null!=e?(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]):void 0},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},update:function(e,t){t=s.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,i,r,a,o=[],u=[],l={};if(s.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(i=0,r=e.length;r>i;i++)n=e[i],a=this.get(n),t.remove&&a&&(l[a.cid]=!0),(t.add&&!a||t.merge&&a)&&o.push(n);if(t.remove)for(i=0,r=this.models.length;r>i;i++)n=this.models[i],l[n.cid]||u.push(n);return u.length&&this.remove(u,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,i){e[i.update?"update":"reset"](n,i),t&&t(e,n,i)},this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(e,t,r){r.wait&&n.add(e,r),i&&i(e,t,r)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"===e||"remove"===e)&&n!==this||("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var i=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,i,n)}}),s.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(e){f.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}}),s.each(["groupBy","countBy","sortBy"],function(e){f.prototype[e]=function(t,n){var i=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,i,n)}});var h=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/\((.*?)\)/g,m=/(\(\?)?:\w+/g,g=/\*\w+/g,v=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(h.prototype,i,{initialize:function(){},route:function(t,n,i){return s.isRegExp(t)||(t=this._routeToRegExp(t)),i||(i=this[n]),e.history.route(t,s.bind(function(r){r=this._extractParameters(t,r),i&&i.apply(this,r),this.trigger.apply(this,["route:"+n].concat(r)),this.trigger("route",n,r),e.history.trigger("route",this,n,r)},this)),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes)for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"(?:$1)?").replace(m,function(e,t){return t?e:"([^/]+)"}).replace(g,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var y=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},b=/^[#\/]|\s+$/g,w=/^\/+|\/+$/g,_=/msie [\w.]+/,x=/\/$/;y.started=!1,s.extend(y.prototype,i,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(x,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(b,"")},start:function(t){if(y.started)throw Error("Backbone.history has already been started");y.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),t=this.getFragment();var n=document.documentMode,n=_.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);return this.root=("/"+this.root+"/").replace(w,"/"),n&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,t=this.location,n=t.pathname.replace(/[^\/]$/,"$&/")===this.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!n?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&n&&t.hash&&(this.fragment=this.getHash().replace(b,""),this.history.replaceState({},document.title,this.root+this.fragment+t.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),y.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(e,t){if(!y.started)return!1;if(t&&!0!==t||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){n?(n=e.href.replace(/(javascript:|#).*$/,""),e.replace(n+"#"+t)):e.hash="#"+t}}),e.history=new y;var C=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,k="model collection el id attributes className tagName events".split(" ");s.extend(C.prototype,i,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=s.result(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];if(s.isFunction(n)||(n=this[e[t]]),!n)throw Error('Method "'+e[t]+'" does not exist');var i=t.match(S),r=i[1],i=i[2],n=s.bind(n,this),r=r+(".delegateEvents"+this.cid);""===i?this.$el.on(r,n):this.$el.on(r,i,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,k)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className")),t=e.$("<"+s.result(this,"tagName")+">").attr(t),this.setElement(t,!1)}}});var I={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.sync=function(t,n,i){var r=I[t];s.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:r,dataType:"json"};if(i.url||(a.url=s.result(n,"url")||T()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",i.emulateJSON&&(a.data._method=r);var o=i.beforeSend;i.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"!==a.type&&!i.emulateJSON&&(a.processData=!1);var u=i.success;i.success=function(e){u&&u(n,e,i),n.trigger("sync",n,e,i)};var l=i.error;return i.error=function(e){l&&l(n,e,i),n.trigger("error",n,e,i)},t=i.xhr=e.ajax(s.extend(a,i)),n.trigger("request",n,t,i),t},e.ajax=function(){return e.$.ajax.apply(e.$,arguments)},d.extend=f.extend=h.extend=C.extend=y.extend=function(e,t){var n,i=this;n=e&&s.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},s.extend(n,i,t);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,e&&s.extend(n.prototype,e),n.__super__=i.prototype,n};var T=function(){throw Error('A "url" property or function must be specified')}}.call(this),function(){function e(e){throw e}function t(e){return function(){return e}}function n(n){function d(e,t,n,i,a){var o=[];return e=O.j(function(){var e=t(n,a)||[];o.length>0&&(O.a.Ya(f(o),e),i&&O.r.K(i,r,[n,e,a])),o.splice(0,o.length),O.a.P(o,e)},r,{W:e,Ka:function(){return 0==o.length||!O.a.X(o[0])}}),{M:o,j:e.pa()?e:c}}function f(e){for(;e.length&&!O.a.X(e[0]);)e.splice(0,1);if(e.length>1){for(var t=e[0],n=e[e.length-1],i=[t];t!==n;){if(t=t.nextSibling,!t)return;i.push(t)}Array.prototype.splice.apply(e,[0,e.length].concat(i))}return e}function h(e,t,n,i,r){var a,o,s,u,l,c=Math.min,d=Math.max,f=[],h=e.length,p=t.length,m=p-h||1,g=h+p+1;
for(a=0;h>=a;a++)for(u=s,f.push(s=[]),l=c(p,a+m),o=d(0,a-1);l>=o;o++)s[o]=o?a?e[a-1]===t[o-1]?u[o-1]:c(u[o]||g,s[o-1]||g)+1:o+1:a+1;for(c=[],d=[],m=[],a=h,o=p;a||o;)p=f[a][o]-1,o&&p===f[a][o-1]?d.push(c[c.length]={status:n,value:t[--o],index:o}):a&&p===f[a-1][o]?m.push(c[c.length]={status:i,value:e[--a],index:a}):(c.push({status:"retained",value:t[--o]}),--a);if(d.length&&m.length){e=10*h;var v;for(t=n=0;(r||e>t)&&(v=d[n]);n++){for(i=0;f=m[i];i++)if(v.value===f.value){v.moved=f.index,f.moved=v.index,m.splice(i,1),t=i=0;break}t+=i}}return c.reverse()}function p(t,n,o,s,u){u=u||{};var l=t&&m(t),l=l&&l.ownerDocument,c=u.templateEngine||Q;switch(O.za.vb(o,c,l),o=c.renderTemplate(o,s,u,l),("number"!=typeof o.length||o.length>0&&"number"!=typeof o[0].nodeType)&&e(Error("Template engine must return an array of DOM nodes")),l=a,n){case"replaceChildren":O.e.N(t,o),l=i;break;case"replaceNode":O.a.Ya(t,o),l=i;break;case"ignoreTargetNode":break;default:e(Error("Unknown renderMode: "+n))}return l&&(g(o,s),u.afterRender&&O.r.K(u.afterRender,r,[o,s.$data])),o}function m(e){return e.nodeType?e:e.length>0?e[0]:r}function g(e,t){if(e.length){var n=e[0],i=e[e.length-1];v(n,i,function(e){O.Da(t,e)}),v(n,i,function(e){O.s.ib(e,[t])})}}function v(e,t,n){var i;for(t=O.e.nextSibling(t);e&&(i=e)!==t;)e=O.e.nextSibling(i),(1===i.nodeType||8===i.nodeType)&&n(i)}function y(t,n,i){t=O.g.aa(t);for(var r=O.g.Q,a=0;t.length>a;a++){var o=t[a].key;if(r.hasOwnProperty(o)){var s=r[o];"function"==typeof s?(o=s(t[a].value))&&e(Error(o)):s||e(Error("This template engine does not support the '"+o+"' binding within its templates"))}}return t="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+O.g.ba(t)+" } })()})",i.createJavaScriptEvaluatorBlock(t)+n}function b(t,n,i,a){function o(e){return function(){return u[e]}}function s(){return u}var u,l,d=0;return O.j(function(){var r=i&&i instanceof O.z?i:new O.z(O.a.d(i)),f=r.$data;if(a&&O.eb(t,r),u=("function"==typeof n?n(r,t):n)||O.J.instance.getBindings(t,r)){if(0===d){d=1;for(var h in u){var p=O.c[h];p&&8===t.nodeType&&!O.e.I[h]&&e(Error("The binding '"+h+"' cannot be used with virtual elements")),p&&"function"==typeof p.init&&(p=p.init(t,o(h),s,f,r))&&p.controlsDescendantBindings&&(l!==c&&e(Error("Multiple bindings ("+l+" and "+h+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")),l=h)}d=2}if(2===d)for(h in u)(p=O.c[h])&&"function"==typeof p.update&&p.update(t,o(h),s,f,r)}},r,{W:t}),{Nb:l===c}}function w(e,t,n){var a=i,o=1===t.nodeType;o&&O.e.Ta(t),(o&&n||O.J.instance.nodeHasBindings(t))&&(a=b(t,r,e,n).Nb),a&&_(e,t,!o)}function _(e,t,n){for(var i=O.e.firstChild(t);t=i;)i=O.e.nextSibling(t),w(e,t,n)}function x(e,t){var n=C(e,t);return n?n.length>0?n[n.length-1].nextSibling:e.nextSibling:r}function C(t,n){for(var i=t,a=1,o=[];i=i.nextSibling;){if(S(i)&&(a--,0===a))return o;o.push(i),k(i)&&a++}return n||e(Error("Cannot find closing comment tag to match: "+t.nodeValue)),r}function S(e){return 8==e.nodeType&&(P?e.text:e.nodeValue).match(H)}function k(e){return 8==e.nodeType&&(P?e.text:e.nodeValue).match(F)}function I(e,t){for(var n=r;e!=n;)n=e,e=e.replace(U,function(e,n){return t[n]});return e}function T(){var e=[],t=[];this.save=function(n,i){var r=O.a.i(e,n);r>=0?t[r]=i:(e.push(n),t.push(i))},this.get=function(n){return n=O.a.i(e,n),n>=0?t[n]:c}}function V(e,t,n){function i(i){var r=t(e[i]);switch(typeof r){case"boolean":case"number":case"string":case"function":a[i]=r;break;case"object":case"undefined":var o=n.get(r);a[i]=o!==c?o:V(r,t,n)}}if(n=n||new T,e=t(e),"object"!=typeof e||e===r||e===c||e instanceof Date)return e;var a=e instanceof Array?[]:{};n.save(e,a);var o=e;if(o instanceof Array){for(var s=0;o.length>s;s++)i(s);"function"==typeof o.toJSON&&i("toJSON")}else for(s in o)i(s);return a}function $(e,t){if(e)if(8==e.nodeType){var n=O.s.Ua(e.nodeValue);n!=r&&t.push({sb:e,Fb:n})}else if(1==e.nodeType)for(var n=0,i=e.childNodes,a=i.length;a>n;n++)$(i[n],t)}function D(e,t,n,r){O.c[e]={init:function(e){return O.a.f.set(e,z,{}),{controlsDescendantBindings:i}},update:function(e,a,o,s,u){o=O.a.f.get(e,z),a=O.a.d(a()),s=!n!=!a;var l=!o.Za;(l||t||s!==o.qb)&&(l&&(o.Za=O.a.Ia(O.e.childNodes(e),i)),s?(l||O.e.N(e,O.a.Ia(o.Za)),O.Ea(r?r(u,a):u,e)):O.e.Y(e),o.qb=s)}},O.g.Q[e]=a,O.e.I[e]=i}function A(e,t,n){n&&t!==O.k.q(e)&&O.k.T(e,t),t!==O.k.q(e)&&O.r.K(O.a.Ba,r,[e,"change"])}var O=n!==void 0?n:{};O.b=function(e,t){for(var n=e.split("."),i=O,r=0;n.length-1>r;r++)i=i[n[r]];i[n[n.length-1]]=t},O.p=function(e,t,n){e[t]=n},O.version="2.2.1",O.b("version",O.version),O.a=new function(){function t(e,t){if("input"!==O.a.u(e)||!e.type||"click"!=t.toLowerCase())return a;var n=e.type;return"checkbox"==n||"radio"==n}var n=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,d={},f={};d[/Firefox\/2/i.test(u.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");for(var h in d){var p=d[h];if(p.length)for(var m=0,g=p.length;g>m;m++)f[p[m]]=h}var v,y={propertychange:i},d=3;for(h=s.createElement("div"),p=h.getElementsByTagName("i");h.innerHTML="<!--[if gt IE "+ ++d+"]><i></i><![endif]-->",p[0];);return v=d>4?d:c,{Na:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],o:function(e,t){for(var n=0,i=e.length;i>n;n++)t(e[n])},i:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},lb:function(e,t,n){for(var i=0,a=e.length;a>i;i++)if(t.call(n,e[i]))return e[i];return r},ga:function(e,t){var n=O.a.i(e,t);n>=0&&e.splice(n,1)},Ga:function(e){e=e||[];for(var t=[],n=0,i=e.length;i>n;n++)0>O.a.i(t,e[n])&&t.push(e[n]);return t},V:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)n.push(t(e[i]));return n},fa:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)t(e[i])&&n.push(e[i]);return n},P:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,i=t.length;i>n;n++)e.push(t[n]);return e},extend:function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},ka:function(e){for(;e.firstChild;)O.removeNode(e.firstChild)},Hb:function(e){e=O.a.L(e);for(var t=s.createElement("div"),n=0,i=e.length;i>n;n++)t.appendChild(O.A(e[n]));return t},Ia:function(e,t){for(var n=0,r=e.length,a=[];r>n;n++){var o=e[n].cloneNode(i);a.push(t?O.A(o):o)}return a},N:function(e,t){if(O.a.ka(e),t)for(var n=0,i=t.length;i>n;n++)e.appendChild(t[n])},Ya:function(e,t){var n=e.nodeType?[e]:e;if(n.length>0){for(var i=n[0],r=i.parentNode,a=0,o=t.length;o>a;a++)r.insertBefore(t[a],i);for(a=0,o=n.length;o>a;a++)O.removeNode(n[a])}},bb:function(e,t){7>v?e.setAttribute("selected",t):e.selected=t},D:function(e){return(e||"").replace(n,"")},Rb:function(e,t){for(var n=[],i=(e||"").split(t),r=0,a=i.length;a>r;r++){var o=O.a.D(i[r]);""!==o&&n.push(o)}return n},Ob:function(e,t){return e=e||"",t.length>e.length?a:e.substring(0,t.length)===t},tb:function(e,t){if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e!=r;){if(e==t)return i;e=e.parentNode}return a},X:function(e){return O.a.tb(e,e.ownerDocument)},u:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},n:function(n,r,o){var s=v&&y[r];if(s||l===void 0)s||"function"!=typeof n.addEventListener?n.attachEvent!==void 0?n.attachEvent("on"+r,function(e){o.call(n,e)}):e(Error("Browser doesn't support addEventListener or attachEvent")):n.addEventListener(r,o,a);else{if(t(n,r)){var u=o;o=function(e,t){var n=this.checked;t&&(this.checked=t.nb!==i),u.call(this,e),this.checked=n}}l(n).bind(r,o)}},Ba:function(n,r){if((!n||!n.nodeType)&&e(Error("element must be a DOM node when calling triggerEvent")),l!==void 0){var u=[];t(n,r)&&u.push({nb:n.checked}),l(n).trigger(r,u)}else"function"==typeof s.createEvent?"function"==typeof n.dispatchEvent?(u=s.createEvent(f[r]||"HTMLEvents"),u.initEvent(r,i,i,o,0,0,0,0,0,a,a,a,a,0,n),n.dispatchEvent(u)):e(Error("The supplied element doesn't support dispatchEvent")):n.fireEvent!==void 0?(t(n,r)&&(n.checked=n.checked!==i),n.fireEvent("on"+r)):e(Error("Browser doesn't support triggering events"))},d:function(e){return O.$(e)?e():e},ua:function(e){return O.$(e)?e.t():e},da:function(e,t,n){if(t){var i=/[\w-]+/g,r=e.className.match(i)||[];O.a.o(t.match(i),function(e){var t=O.a.i(r,e);t>=0?n||r.splice(t,1):n&&r.push(e)}),e.className=r.join(" ")}},cb:function(e,t){var n=O.a.d(t);if((n===r||n===c)&&(n=""),3===e.nodeType)e.data=n;else{var i=O.e.firstChild(e);!i||3!=i.nodeType||O.e.nextSibling(i)?O.e.N(e,[s.createTextNode(n)]):i.data=n,O.a.wb(e)}},ab:function(e,t){if(e.name=t,7>=v)try{e.mergeAttributes(s.createElement("<input name='"+e.name+"'/>"),a)}catch(n){}},wb:function(e){v>=9&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},ub:function(e){if(v>=9){var t=e.style.width;e.style.width=0,e.style.width=t}},Lb:function(e,t){e=O.a.d(e),t=O.a.d(t);for(var n=[],i=e;t>=i;i++)n.push(i);return n},L:function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},Pb:6===v,Qb:7===v,Z:v,Oa:function(e,t){for(var n=O.a.L(e.getElementsByTagName("input")).concat(O.a.L(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],a=n.length-1;a>=0;a--)i(n[a])&&r.push(n[a]);return r},Ib:function(e){return"string"==typeof e&&(e=O.a.D(e))?o.JSON&&o.JSON.parse?o.JSON.parse(e):Function("return "+e)():r},xa:function(t,n,i){return("undefined"==typeof JSON||JSON.stringify===void 0)&&e(Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js")),JSON.stringify(O.a.d(t),n,i)},Jb:function(e,t,n){n=n||{};var i=n.params||{},r=n.includeFields||this.Na,a=e;if("object"==typeof e&&"form"===O.a.u(e))for(var a=e.action,o=r.length-1;o>=0;o--)for(var u=O.a.Oa(e,r[o]),l=u.length-1;l>=0;l--)i[u[l].name]=u[l].value;t=O.a.d(t);var c=s.createElement("form");c.style.display="none",c.action=a,c.method="post";for(var d in t)e=s.createElement("input"),e.name=d,e.value=O.a.xa(O.a.d(t[d])),c.appendChild(e);for(d in i)e=s.createElement("input"),e.name=d,e.value=i[d],c.appendChild(e);s.body.appendChild(c),n.submitter?n.submitter(c):c.submit(),setTimeout(function(){c.parentNode.removeChild(c)},0)}}},O.b("utils",O.a),O.b("utils.arrayForEach",O.a.o),O.b("utils.arrayFirst",O.a.lb),O.b("utils.arrayFilter",O.a.fa),O.b("utils.arrayGetDistinctValues",O.a.Ga),O.b("utils.arrayIndexOf",O.a.i),O.b("utils.arrayMap",O.a.V),O.b("utils.arrayPushAll",O.a.P),O.b("utils.arrayRemoveItem",O.a.ga),O.b("utils.extend",O.a.extend),O.b("utils.fieldsIncludedWithJsonPost",O.a.Na),O.b("utils.getFormFields",O.a.Oa),O.b("utils.peekObservable",O.a.ua),O.b("utils.postJson",O.a.Jb),O.b("utils.parseJson",O.a.Ib),O.b("utils.registerEventHandler",O.a.n),O.b("utils.stringifyJson",O.a.xa),O.b("utils.range",O.a.Lb),O.b("utils.toggleDomNodeCssClass",O.a.da),O.b("utils.triggerEvent",O.a.Ba),O.b("utils.unwrapObservable",O.a.d),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments);return e=n.shift(),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),O.a.f=new function(){var e=0,t="__ko__"+(new Date).getTime(),n={};return{get:function(e,t){var n=O.a.f.la(e,a);return n===c?c:n[t]},set:function(e,t,n){n===c&&O.a.f.la(e,a)===c||(O.a.f.la(e,i)[t]=n)},la:function(i,r){var a=i[t];if(!a||"null"===a||!n[a]){if(!r)return c;a=i[t]="ko"+e++,n[a]={}}return n[a]},clear:function(e){var o=e[t];return o?(delete n[o],e[t]=r,i):a}}},O.b("utils.domData",O.a.f),O.b("utils.domData.clear",O.a.f.clear),O.a.F=new function(){function t(e,t){var n=O.a.f.get(e,r);return n===c&&t&&(n=[],O.a.f.set(e,r,n)),n}function n(e){var i=t(e,a);if(i)for(var i=i.slice(0),r=0;i.length>r;r++)i[r](e);if(O.a.f.clear(e),"function"==typeof l&&"function"==typeof l.cleanData&&l.cleanData([e]),s[e.nodeType])for(i=e.firstChild;e=i;)i=e.nextSibling,8===e.nodeType&&n(e)}var r="__ko_domNodeDisposal__"+(new Date).getTime(),o={1:i,8:i,9:i},s={1:i,9:i};return{Ca:function(n,r){"function"!=typeof r&&e(Error("Callback must be a function")),t(n,i).push(r)},Xa:function(e,n){var i=t(e,a);i&&(O.a.ga(i,n),0==i.length&&O.a.f.set(e,r,c))},A:function(e){if(o[e.nodeType]&&(n(e),s[e.nodeType])){var t=[];O.a.P(t,e.getElementsByTagName("*"));for(var i=0,r=t.length;r>i;i++)n(t[i])}return e},removeNode:function(e){O.A(e),e.parentNode&&e.parentNode.removeChild(e)}}},O.A=O.a.F.A,O.removeNode=O.a.F.removeNode,O.b("cleanNode",O.A),O.b("removeNode",O.removeNode),O.b("utils.domNodeDisposal",O.a.F),O.b("utils.domNodeDisposal.addDisposeCallback",O.a.F.Ca),O.b("utils.domNodeDisposal.removeDisposeCallback",O.a.F.Xa),O.a.ta=function(e){var t;if(l!==void 0){if(l.parseHTML)t=l.parseHTML(e);else if((t=l.clean([e]))&&t[0]){for(e=t[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var n=O.a.D(e).toLowerCase();for(t=s.createElement("div"),n=n.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!n.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!n.indexOf("<td")||!n.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],e="ignored<div>"+n[1]+e+n[2]+"</div>","function"==typeof o.innerShiv?t.appendChild(o.innerShiv(e)):t.innerHTML=e;n[0]--;)t=t.lastChild;t=O.a.L(t.lastChild.childNodes)}return t},O.a.ca=function(e,t){if(O.a.ka(e),t=O.a.d(t),t!==r&&t!==c)if("string"!=typeof t&&(t=""+t),l!==void 0)l(e).html(t);else for(var n=O.a.ta(t),i=0;n.length>i;i++)e.appendChild(n[i])},O.b("utils.parseHtmlFragment",O.a.ta),O.b("utils.setHtml",O.a.ca);var N={};O.s={ra:function(t){"function"!=typeof t&&e(Error("You can only pass a function to ko.memoization.memoize()"));var n=(0|4294967296*(1+Math.random())).toString(16).substring(1)+(0|4294967296*(1+Math.random())).toString(16).substring(1);return N[n]=t,"<!--[ko_memo:"+n+"]-->"},hb:function(t,n){var a=N[t];a===c&&e(Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized."));try{return a.apply(r,n||[]),i}finally{delete N[t]}},ib:function(e,t){var n=[];$(e,n);for(var i=0,r=n.length;r>i;i++){var a=n[i].sb,o=[a];t&&O.a.P(o,t),O.s.hb(n[i].Fb,o),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},Ua:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:r}},O.b("memoization",O.s),O.b("memoization.memoize",O.s.ra),O.b("memoization.unmemoize",O.s.hb),O.b("memoization.parseMemoText",O.s.Ua),O.b("memoization.unmemoizeDomNodeAndDescendants",O.s.ib),O.Ma={throttle:function(e,t){e.throttleEvaluation=t;var n=r;return O.j({read:e,write:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}})},notify:function(e,n){return e.equalityComparer="always"==n?t(a):O.m.fn.equalityComparer,e}},O.b("extenders",O.Ma),O.fb=function(e,t,n){this.target=e,this.ha=t,this.rb=n,O.p(this,"dispose",this.B)},O.fb.prototype.B=function(){this.Cb=i,this.rb()},O.S=function(){this.w={},O.a.extend(this,O.S.fn),O.p(this,"subscribe",this.ya),O.p(this,"extend",this.extend),O.p(this,"getSubscriptionsCount",this.yb)},O.S.fn={ya:function(e,t,n){n=n||"change";var i=new O.fb(this,t?e.bind(t):e,function(){O.a.ga(this.w[n],i)}.bind(this));return this.w[n]||(this.w[n]=[]),this.w[n].push(i),i},notifySubscribers:function(e,t){t=t||"change",this.w[t]&&O.r.K(function(){O.a.o(this.w[t].slice(0),function(t){t&&t.Cb!==i&&t.ha(e)})},this)},yb:function(){var e,t=0;for(e in this.w)this.w.hasOwnProperty(e)&&(t+=this.w[e].length);return t},extend:function(e){var t=this;if(e)for(var n in e){var i=O.Ma[n];"function"==typeof i&&(t=i(t,e[n]))}return t}},O.Qa=function(e){return"function"==typeof e.ya&&"function"==typeof e.notifySubscribers},O.b("subscribable",O.S),O.b("isSubscribable",O.Qa);var M=[];O.r={mb:function(e){M.push({ha:e,La:[]})},end:function(){M.pop()},Wa:function(t){if(O.Qa(t)||e(Error("Only subscribable things can act as dependencies")),M.length>0){var n=M[M.length-1];n&&!(O.a.i(n.La,t)>=0)&&(n.La.push(t),n.ha(t))}},K:function(e,t,n){try{return M.push(r),e.apply(t,n||[])}finally{M.pop()}}};var j={undefined:i,"boolean":i,number:i,string:i};O.m=function(e){function t(){return arguments.length>0?(t.equalityComparer&&t.equalityComparer(n,arguments[0])||(t.H(),n=arguments[0],t.G()),this):(O.r.Wa(t),n)}var n=e;return O.S.call(t),t.t=function(){return n},t.G=function(){t.notifySubscribers(n)},t.H=function(){t.notifySubscribers(n,"beforeChange")},O.a.extend(t,O.m.fn),O.p(t,"peek",t.t),O.p(t,"valueHasMutated",t.G),O.p(t,"valueWillMutate",t.H),t},O.m.fn={equalityComparer:function(e,t){return e===r||typeof e in j?e===t:a}};var E=O.m.Kb="__ko_proto__";O.m.fn[E]=O.m,O.ma=function(e,t){return e===r||e===c||e[E]===c?a:e[E]===t?i:O.ma(e[E],t)},O.$=function(e){return O.ma(e,O.m)},O.Ra=function(e){return"function"==typeof e&&e[E]===O.m||"function"==typeof e&&e[E]===O.j&&e.zb?i:a},O.b("observable",O.m),O.b("isObservable",O.$),O.b("isWriteableObservable",O.Ra),O.R=function(t){0==arguments.length&&(t=[]),t!==r&&t!==c&&!("length"in t)&&e(Error("The argument passed when initializing an observable array must be an array, or null, or undefined."));var n=O.m(t);return O.a.extend(n,O.R.fn),n},O.R.fn={remove:function(e){for(var t=this.t(),n=[],i="function"==typeof e?e:function(t){return t===e},r=0;t.length>r;r++){var a=t[r];i(a)&&(0===n.length&&this.H(),n.push(a),t.splice(r,1),r--)}return n.length&&this.G(),n},removeAll:function(e){if(e===c){var t=this.t(),n=t.slice(0);return this.H(),t.splice(0,t.length),this.G(),n}return e?this.remove(function(t){return O.a.i(e,t)>=0}):[]},destroy:function(e){var t=this.t(),n="function"==typeof e?e:function(t){return t===e};this.H();for(var r=t.length-1;r>=0;r--)n(t[r])&&(t[r]._destroy=i);this.G()},destroyAll:function(e){return e===c?this.destroy(t(i)):e?this.destroy(function(t){return O.a.i(e,t)>=0}):[]},indexOf:function(e){var t=this();return O.a.i(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.H(),this.t()[n]=t,this.G())}},O.a.o("pop push reverse shift sort splice unshift".split(" "),function(e){O.R.fn[e]=function(){var t=this.t();return this.H(),t=t[e].apply(t,arguments),this.G(),t}}),O.a.o(["slice"],function(e){O.R.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),O.b("observableArray",O.R),O.j=function(n,o,s){function u(){O.a.o(x,function(e){e.B()}),x=[]}function l(){var e=f.throttleEvaluation;e&&e>=0?(clearTimeout(C),C=setTimeout(d,e)):d()}function d(){if(!g)if(m&&w())_();else{g=i;try{var e=O.a.V(x,function(e){return e.target});O.r.mb(function(t){var n;(n=O.a.i(e,t))>=0?e[n]=c:x.push(t.ya(l))});for(var t=v.call(o),n=e.length-1;n>=0;n--)e[n]&&x.splice(n,1)[0].B();m=i,f.notifySubscribers(p,"beforeChange"),p=t}finally{O.r.end()}f.notifySubscribers(p),g=a,x.length||_()}}function f(){return arguments.length>0?("function"==typeof y?y.apply(o,arguments):e(Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")),this):(m||d(),O.r.Wa(f),p)}function h(){return!m||x.length>0}var p,m=a,g=a,v=n;v&&"object"==typeof v?(s=v,v=s.read):(s=s||{},v||(v=s.read)),"function"!=typeof v&&e(Error("Pass a function that returns the value of the ko.computed"));var y=s.write,b=s.disposeWhenNodeIsRemoved||s.W||r,w=s.disposeWhen||s.Ka||t(a),_=u,x=[],C=r;if(o||(o=s.owner),f.t=function(){return m||d(),p},f.xb=function(){return x.length},f.zb="function"==typeof s.write,f.B=function(){_()},f.pa=h,O.S.call(f),O.a.extend(f,O.j.fn),O.p(f,"peek",f.t),O.p(f,"dispose",f.B),O.p(f,"isActive",f.pa),O.p(f,"getDependenciesCount",f.xb),s.deferEvaluation!==i&&d(),b&&h()){_=function(){O.a.F.Xa(b,arguments.callee),u()},O.a.F.Ca(b,_);var S=w,w=function(){return!O.a.X(b)||S()}}return f},O.Bb=function(e){return O.ma(e,O.j)},n=O.m.Kb,O.j[n]=O.m,O.j.fn={},O.j.fn[n]=O.j,O.b("dependentObservable",O.j),O.b("computed",O.j),O.b("isComputed",O.Bb),O.gb=function(t){return 0==arguments.length&&e(Error("When calling ko.toJS, pass the object you want to convert.")),V(t,function(e){for(var t=0;O.$(e)&&10>t;t++)e=e();return e})},O.toJSON=function(e,t,n){return e=O.gb(e),O.a.xa(e,t,n)},O.b("toJS",O.gb),O.b("toJSON",O.toJSON),O.k={q:function(e){switch(O.a.u(e)){case"option":return e.__ko__hasDomDataOptionValue__===i?O.a.f.get(e,O.c.options.sa):7>=O.a.Z?e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return e.selectedIndex>=0?O.k.q(e.options[e.selectedIndex]):c;default:return e.value}},T:function(e,t){switch(O.a.u(e)){case"option":switch(typeof t){case"string":O.a.f.set(e,O.c.options.sa,c),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:O.a.f.set(e,O.c.options.sa,t),e.__ko__hasDomDataOptionValue__=i,e.value="number"==typeof t?t:""}break;case"select":for(var n=e.options.length-1;n>=0;n--)if(O.k.q(e.options[n])==t){e.selectedIndex=n;break}break;default:(t===r||t===c)&&(t=""),e.value=t}}},O.b("selectExtensions",O.k),O.b("selectExtensions.readValue",O.k.q),O.b("selectExtensions.writeValue",O.k.T);var U=/\@ko_token_(\d+)\@/g,B=["true","false"],R=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i;O.g={Q:[],aa:function(e){var t=O.a.D(e);if(3>t.length)return[];"{"===t.charAt(0)&&(t=t.substring(1,t.length-1)),e=[];for(var n,i=r,a=0;t.length>a;a++){var o=t.charAt(a);if(i===r)switch(o){case'"':case"'":case"/":i=a,n=o}else if(o==n&&"\\"!==t.charAt(a-1)){o=t.substring(i,a+1),e.push(o);var s="@ko_token_"+(e.length-1)+"@",t=t.substring(0,i)+s+t.substring(a+1),a=a-(o.length-s.length),i=r}}n=i=r;for(var u=0,l=r,a=0;t.length>a;a++){if(o=t.charAt(a),i===r)switch(o){case"{":i=a,l=o,n="}";break;case"(":i=a,l=o,n=")";break;case"[":i=a,l=o,n="]"}o===l?u++:o===n&&(u--,0===u&&(o=t.substring(i,a+1),e.push(o),s="@ko_token_"+(e.length-1)+"@",t=t.substring(0,i)+s+t.substring(a+1),a-=o.length-s.length,i=r))}for(n=[],t=t.split(","),i=0,a=t.length;a>i;i++)u=t[i],l=u.indexOf(":"),l>0&&u.length-1>l?(o=u.substring(l+1),n.push({key:I(u.substring(0,l),e),value:I(o,e)})):n.push({unknown:I(u,e)});return n},ba:function(e){var t="string"==typeof e?O.g.aa(e):e,n=[];e=[];for(var i,o=0;i=t[o];o++)if(n.length>0&&n.push(","),i.key){var s;e:{s=i.key;var u=O.a.D(s);switch(u.length&&u.charAt(0)){case"'":case'"':break e;default:s="'"+u+"'"}}i=i.value,n.push(s),n.push(":"),n.push(i),i=O.a.D(i),O.a.i(B,O.a.D(i).toLowerCase())>=0?i=a:(u=i.match(R),i=u===r?a:u[1]?"Object("+u[1]+")"+u[2]:i),i&&(e.length>0&&e.push(", "),e.push(s+" : function(__ko_value) { "+i+" = __ko_value; }"))}else i.unknown&&n.push(i.unknown);return t=n.join(""),e.length>0&&(t=t+", '_ko_property_writers' : { "+e.join("")+" } "),t},Eb:function(e,t){for(var n=0;e.length>n;n++)if(O.a.D(e[n].key)==t)return i;return a},ea:function(e,t,n,i,r){e&&O.Ra(e)?(!r||e.t()!==i)&&e(i):(e=t()._ko_property_writers)&&e[n]&&e[n](i)}},O.b("expressionRewriting",O.g),O.b("expressionRewriting.bindingRewriteValidators",O.g.Q),O.b("expressionRewriting.parseObjectLiteral",O.g.aa),O.b("expressionRewriting.preProcessBindings",O.g.ba),O.b("jsonExpressionRewriting",O.g),O.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",O.g.ba);var P="<!--test-->"===s.createComment("test").text,F=P?/^\x3c!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*--\x3e$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/,H=P?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,L={ul:i,ol:i};O.e={I:{},childNodes:function(e){return k(e)?C(e):e.childNodes},Y:function(e){if(k(e)){e=O.e.childNodes(e);for(var t=0,n=e.length;n>t;t++)O.removeNode(e[t])}else O.a.ka(e)},N:function(e,t){if(k(e)){O.e.Y(e);for(var n=e.nextSibling,i=0,r=t.length;r>i;i++)n.parentNode.insertBefore(t[i],n)}else O.a.N(e,t)},Va:function(e,t){k(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},Pa:function(e,t,n){n?k(e)?e.parentNode.insertBefore(t,n.nextSibling):n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):O.e.Va(e,t)},firstChild:function(e){return k(e)?!e.nextSibling||S(e.nextSibling)?r:e.nextSibling:e.firstChild},nextSibling:function(e){return k(e)&&(e=x(e)),e.nextSibling&&S(e.nextSibling)?r:e.nextSibling},jb:function(e){return(e=k(e))?e[1]:r},Ta:function(e){if(L[O.a.u(e)]){var t=e.firstChild;if(t)do if(1===t.nodeType){var n;n=t.firstChild;var a=r;if(n)do if(a)a.push(n);else if(k(n)){var o=x(n,i);o?n=o:a=[n]}else S(n)&&(a=[n]);while(n=n.nextSibling);if(n=a)for(a=t.nextSibling,o=0;n.length>o;o++)a?e.insertBefore(n[o],a):e.appendChild(n[o])}while(t=t.nextSibling)}}},O.b("virtualElements",O.e),O.b("virtualElements.allowedBindings",O.e.I),O.b("virtualElements.emptyNode",O.e.Y),O.b("virtualElements.insertAfter",O.e.Pa),O.b("virtualElements.prepend",O.e.Va),O.b("virtualElements.setDomNodeChildren",O.e.N),O.J=function(){this.Ha={}},O.a.extend(O.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind")!=r;case 8:return O.e.jb(e)!=r;default:return a}},getBindings:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e):r},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return O.e.jb(e);default:return r}},parseBindingsString:function(t,n,i){try{var r;if(!(r=this.Ha[t])){var a,o=this.Ha,s="with($context){with($data||{}){return{"+O.g.ba(t)+"}}}";a=Function("$context","$element",s),r=o[t]=a}return r(n,i)}catch(u){e(Error("Unable to parse bindings.\nMessage: "+u+";\nBindings value: "+t))}}}),O.J.instance=new O.J,O.b("bindingProvider",O.J),O.c={},O.z=function(e,t,n){t?(O.a.extend(this,t),this.$parentContext=t,this.$parent=t.$data,this.$parents=(t.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=e,this.ko=O),this.$data=e,n&&(this[n]=e)},O.z.prototype.createChildContext=function(e,t){return new O.z(e,this,t)},O.z.prototype.extend=function(e){var t=O.a.extend(new O.z,this);return O.a.extend(t,e)},O.eb=function(e,t){return 2!=arguments.length?O.a.f.get(e,"__ko_bindingContext__"):(O.a.f.set(e,"__ko_bindingContext__",t),void 0)},O.Fa=function(e,t,n){return 1===e.nodeType&&O.e.Ta(e),b(e,t,n,i)},O.Ea=function(e,t){(1===t.nodeType||8===t.nodeType)&&_(e,t,i)},O.Da=function(t,n){n&&1!==n.nodeType&&8!==n.nodeType&&e(Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node")),n=n||o.document.body,w(t,n,i)},O.ja=function(e){switch(e.nodeType){case 1:case 8:var t=O.eb(e);if(t)return t;if(e.parentNode)return O.ja(e.parentNode)}return c},O.pb=function(e){return(e=O.ja(e))?e.$data:c},O.b("bindingHandlers",O.c),O.b("applyBindings",O.Da),O.b("applyBindingsToDescendants",O.Ea),O.b("applyBindingsToNode",O.Fa),O.b("contextFor",O.ja),O.b("dataFor",O.pb);var W={"class":"className","for":"htmlFor"};O.c.attr={update:function(e,t){var n,i=O.a.d(t())||{};for(n in i)if("string"==typeof n){var o=O.a.d(i[n]),s=o===a||o===r||o===c;s&&e.removeAttribute(n),8>=O.a.Z&&n in W?(n=W[n],s?e.removeAttribute(n):e[n]=o):s||e.setAttribute(n,""+o),"name"===n&&O.a.ab(e,s?"":""+o)}}},O.c.checked={init:function(e,n,r){O.a.n(e,"click",function(){var t;if("checkbox"==e.type)t=e.checked;else{if("radio"!=e.type||!e.checked)return;t=e.value}var a=n(),o=O.a.d(a);"checkbox"==e.type&&o instanceof Array?(t=O.a.i(o,e.value),e.checked&&0>t?a.push(e.value):!e.checked&&t>=0&&a.splice(t,1)):O.g.ea(a,r,"checked",t,i)}),"radio"==e.type&&!e.name&&O.c.uniqueName.init(e,t(i))},update:function(e,t){var n=O.a.d(t());"checkbox"==e.type?e.checked=n instanceof Array?O.a.i(n,e.value)>=0:n:"radio"==e.type&&(e.checked=e.value==n)}},O.c.css={update:function(e,t){var n=O.a.d(t());if("object"==typeof n)for(var r in n){var o=O.a.d(n[r]);O.a.da(e,r,o)}else n=(n||"")+"",O.a.da(e,e.__ko__cssValue,a),e.__ko__cssValue=n,O.a.da(e,n,i)}},O.c.enable={update:function(e,t){var n=O.a.d(t());n&&e.disabled?e.removeAttribute("disabled"):!n&&!e.disabled&&(e.disabled=i)}},O.c.disable={update:function(e,t){O.c.enable.update(e,function(){return!O.a.d(t())})}},O.c.event={init:function(e,t,n,r){var o,s=t()||{};for(o in s)(function(){var s=o;"string"==typeof s&&O.a.n(e,s,function(e){var o,u=t()[s];if(u){var l=n();try{var c=O.a.L(arguments);c.unshift(r),o=u.apply(r,c)}finally{o!==i&&(e.preventDefault?e.preventDefault():e.returnValue=a)}l[s+"Bubble"]===a&&(e.cancelBubble=i,e.stopPropagation&&e.stopPropagation())}})})()}},O.c.foreach={Sa:function(e){return function(){var t=e(),n=O.a.ua(t);return n&&"number"!=typeof n.length?(O.a.d(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:O.C.oa}):{foreach:t,templateEngine:O.C.oa}}},init:function(e,t){return O.c.template.init(e,O.c.foreach.Sa(t))},update:function(e,t,n,i,r){return O.c.template.update(e,O.c.foreach.Sa(t),n,i,r)}},O.g.Q.foreach=a,O.e.I.foreach=i,O.c.hasfocus={init:function(e,t,n){function o(r){e.__ko_hasfocusUpdating=i;var o=e.ownerDocument;"activeElement"in o&&(r=o.activeElement===e),o=t(),O.g.ea(o,n,"hasfocus",r,i),e.__ko_hasfocusUpdating=a}var s=o.bind(r,i),u=o.bind(r,a);O.a.n(e,"focus",s),O.a.n(e,"focusin",s),O.a.n(e,"blur",u),O.a.n(e,"focusout",u)},update:function(e,t){var n=O.a.d(t());e.__ko_hasfocusUpdating||(n?e.focus():e.blur(),O.r.K(O.a.Ba,r,[e,n?"focusin":"focusout"]))}},O.c.html={init:function(){return{controlsDescendantBindings:i}},update:function(e,t){O.a.ca(e,t())}};var z="__ko_withIfBindingData";D("if"),D("ifnot",a,i),D("with",i,a,function(e,t){return e.createChildContext(t)}),O.c.options={update:function(t,n,r){"select"!==O.a.u(t)&&e(Error("options binding applies only to SELECT elements"));for(var a=0==t.length,o=O.a.V(O.a.fa(t.childNodes,function(e){return e.tagName&&"option"===O.a.u(e)&&e.selected}),function(e){return O.k.q(e)||e.innerText||e.textContent}),u=t.scrollTop,l=O.a.d(n());t.length>0;)O.A(t.options[0]),t.remove(0);if(l){r=r();var d=r.optionsIncludeDestroyed;if("number"!=typeof l.length&&(l=[l]),r.optionsCaption){var f=s.createElement("option");O.a.ca(f,r.optionsCaption),O.k.T(f,c),t.appendChild(f)}n=0;for(var h=l.length;h>n;n++){var p=l[n];if(!p||!p._destroy||d){var f=s.createElement("option"),m=function(e,t,n){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:n},g=m(p,r.optionsValue,p);O.k.T(f,O.a.d(g)),p=m(p,r.optionsText,g),O.a.cb(f,p),t.appendChild(f)}}for(l=t.getElementsByTagName("option"),n=d=0,h=l.length;h>n;n++)O.a.i(o,O.k.q(l[n]))>=0&&(O.a.bb(l[n],i),d++);t.scrollTop=u,a&&"value"in r&&A(t,O.a.ua(r.value),i),O.a.ub(t)}}},O.c.options.sa="__ko.optionValueDomData__",O.c.selectedOptions={init:function(e,t,n){O.a.n(e,"change",function(){var i=t(),r=[];O.a.o(e.getElementsByTagName("option"),function(e){e.selected&&r.push(O.k.q(e))}),O.g.ea(i,n,"value",r)})},update:function(t,n){"select"!=O.a.u(t)&&e(Error("values binding applies only to SELECT elements"));var i=O.a.d(n());i&&"number"==typeof i.length&&O.a.o(t.getElementsByTagName("option"),function(e){var t=O.a.i(i,O.k.q(e))>=0;O.a.bb(e,t)})}},O.c.style={update:function(e,t){var n,i=O.a.d(t()||{});for(n in i)if("string"==typeof n){var r=O.a.d(i[n]);e.style[n]=r||""}}},O.c.submit={init:function(t,n,r,o){"function"!=typeof n()&&e(Error("The value for a submit binding must be a function")),O.a.n(t,"submit",function(e){var r,s=n();try{r=s.call(o,t)}finally{r!==i&&(e.preventDefault?e.preventDefault():e.returnValue=a)}})}},O.c.text={update:function(e,t){O.a.cb(e,t())}},O.e.I.text=i,O.c.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++O.c.uniqueName.ob;O.a.ab(e,n)}}},O.c.uniqueName.ob=0,O.c.value={init:function(e,t,n){function r(){u=a;var i=t(),r=O.k.q(e);O.g.ea(i,n,"value",r)}var o=["change"],s=n().valueUpdate,u=a;s&&("string"==typeof s&&(s=[s]),O.a.P(o,s),o=O.a.Ga(o)),!O.a.Z||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=O.a.i(o,"propertychange")||(O.a.n(e,"propertychange",function(){u=i
}),O.a.n(e,"blur",function(){u&&r()})),O.a.o(o,function(t){var n=r;O.a.Ob(t,"after")&&(n=function(){setTimeout(r,0)},t=t.substring(5)),O.a.n(e,t,n)})},update:function(e,t){var n="select"===O.a.u(e),r=O.a.d(t()),o=O.k.q(e),s=r!=o;0===r&&0!==o&&"0"!==o&&(s=i),s&&(o=function(){O.k.T(e,r)},o(),n&&setTimeout(o,0)),n&&e.length>0&&A(e,r,a)}},O.c.visible={update:function(e,t){var n=O.a.d(t()),i="none"!=e.style.display;n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},O.c.click={init:function(e,t,n,i){return O.c.event.init.call(this,e,function(){var e={};return e.click=t(),e},n,i)}},O.v=function(){},O.v.prototype.renderTemplateSource=function(){e(Error("Override renderTemplateSource"))},O.v.prototype.createJavaScriptEvaluatorBlock=function(){e(Error("Override createJavaScriptEvaluatorBlock"))},O.v.prototype.makeTemplateSource=function(t,n){if("string"==typeof t){n=n||s;var i=n.getElementById(t);return i||e(Error("Cannot find template with ID "+t)),new O.l.h(i)}return 1==t.nodeType||8==t.nodeType?new O.l.O(t):(e(Error("Unknown template type: "+t)),void 0)},O.v.prototype.renderTemplate=function(e,t,n,i){return e=this.makeTemplateSource(e,i),this.renderTemplateSource(e,t,n)},O.v.prototype.isTemplateRewritten=function(e,t){return this.allowTemplateRewriting===a?i:this.makeTemplateSource(e,t).data("isRewritten")},O.v.prototype.rewriteTemplate=function(e,t,n){e=this.makeTemplateSource(e,n),t=t(e.text()),e.text(t),e.data("isRewritten",i)},O.b("templateEngine",O.v);var q=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,J=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;O.za={vb:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return O.za.Gb(e,t)},n)},Gb:function(e,t){return e.replace(q,function(e,n,i,r,a,o,s){return y(s,n,t)}).replace(J,function(e,n){return y(n,"<!-- ko -->",t)})},kb:function(e){return O.s.ra(function(t,n){t.nextSibling&&O.Fa(t.nextSibling,e,n)})}},O.b("__tr_ambtns",O.za.kb),O.l={},O.l.h=function(e){this.h=e},O.l.h.prototype.text=function(){var e=O.a.u(this.h),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.h[e];var t=arguments[0];"innerHTML"===e?O.a.ca(this.h,t):this.h[e]=t},O.l.h.prototype.data=function(e){return 1===arguments.length?O.a.f.get(this.h,"templateSourceData_"+e):(O.a.f.set(this.h,"templateSourceData_"+e,arguments[1]),void 0)},O.l.O=function(e){this.h=e},O.l.O.prototype=new O.l.h,O.l.O.prototype.text=function(){if(0==arguments.length){var e=O.a.f.get(this.h,"__ko_anon_template__")||{};return e.Aa===c&&e.ia&&(e.Aa=e.ia.innerHTML),e.Aa}O.a.f.set(this.h,"__ko_anon_template__",{Aa:arguments[0]})},O.l.h.prototype.nodes=function(){return 0==arguments.length?(O.a.f.get(this.h,"__ko_anon_template__")||{}).ia:(O.a.f.set(this.h,"__ko_anon_template__",{ia:arguments[0]}),void 0)},O.b("templateSources",O.l),O.b("templateSources.domElement",O.l.h),O.b("templateSources.anonymousTemplate",O.l.O);var Q;O.wa=function(t){t!=c&&!(t instanceof O.v)&&e(Error("templateEngine must inherit from ko.templateEngine")),Q=t},O.va=function(t,n,i,a,o){if(i=i||{},(i.templateEngine||Q)==c&&e(Error("Set a template engine before calling renderTemplate")),o=o||"replaceChildren",a){var s=m(a);return O.j(function(){var e=n&&n instanceof O.z?n:new O.z(O.a.d(n)),r="function"==typeof t?t(e.$data,e):t,e=p(a,o,r,e,i);"replaceNode"==o&&(a=e,s=m(a))},r,{Ka:function(){return!s||!O.a.X(s)},W:s&&"replaceNode"==o?s.parentNode:s})}return O.s.ra(function(e){O.va(t,n,i,e,"replaceNode")})},O.Mb=function(e,t,n,i,a){function o(e,t){g(t,u),n.afterRender&&n.afterRender(t,e)}function s(t,i){u=a.createChildContext(O.a.d(t),n.as),u.$index=i;var o="function"==typeof e?e(t,u):e;return p(r,"ignoreTargetNode",o,u,n)}var u;return O.j(function(){var e=O.a.d(t)||[];e.length===void 0&&(e=[e]),e=O.a.fa(e,function(e){return n.includeDestroyed||e===c||e===r||!O.a.d(e._destroy)}),O.r.K(O.a.$a,r,[i,e,s,n,o])},r,{W:i})},O.c.template={init:function(e,t){var n=O.a.d(t());return"string"==typeof n||n.name||1!=e.nodeType&&8!=e.nodeType||(n=1==e.nodeType?e.childNodes:O.e.childNodes(e),n=O.a.Hb(n),new O.l.O(e).nodes(n)),{controlsDescendantBindings:i}},update:function(e,t,n,a,o){t=O.a.d(t()),n={},a=i;var s,u=r;"string"!=typeof t&&(n=t,t=n.name,"if"in n&&(a=O.a.d(n["if"])),a&&"ifnot"in n&&(a=!O.a.d(n.ifnot)),s=O.a.d(n.data)),"foreach"in n?u=O.Mb(t||e,a&&n.foreach||[],n,e,o):a?(o="data"in n?o.createChildContext(s,n.as):o,u=O.va(t||e,o,n,e)):O.e.Y(e),o=u,(s=O.a.f.get(e,"__ko__templateComputedDomDataKey__"))&&"function"==typeof s.B&&s.B(),O.a.f.set(e,"__ko__templateComputedDomDataKey__",o&&o.pa()?o:c)}},O.g.Q.template=function(e){return e=O.g.aa(e),1==e.length&&e[0].unknown||O.g.Eb(e,"name")?r:"This template engine does not support anonymous templates nested within its templates"},O.e.I.template=i,O.b("setTemplateEngine",O.wa),O.b("renderTemplate",O.va),O.a.Ja=function(e,t,n){return e=e||[],t=t||[],e.length<=t.length?h(e,t,"added","deleted",n):h(t,e,"deleted","added",n)},O.b("utils.compareArrays",O.a.Ja),O.a.$a=function(e,t,n,r,a){function o(e,t){w=l[t],v!==t&&(C[e]=w),w.na(v++),f(w.M),m.push(w),b.push(w)}function s(e,t){if(e)for(var n=0,i=t.length;i>n;n++)t[n]&&O.a.o(t[n].M,function(i){e(i,n,t[n].U)})}t=t||[],r=r||{};var u=O.a.f.get(e,"setDomNodeChildrenFromArrayMapping_lastMappingResult")===c,l=O.a.f.get(e,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],h=O.a.V(l,function(e){return e.U}),p=O.a.Ja(h,t),m=[],g=0,v=0,y=[],b=[];t=[];for(var w,_,x,C=[],h=[],S=0;_=p[S];S++)switch(x=_.moved,_.status){case"deleted":x===c&&(w=l[g],w.j&&w.j.B(),y.push.apply(y,f(w.M)),r.beforeRemove&&(t[S]=w,b.push(w))),g++;break;case"retained":o(S,g++);break;case"added":x!==c?o(S,x):(w={U:_.value,na:O.m(v++)},m.push(w),b.push(w),u||(h[S]=w))}s(r.beforeMove,C),O.a.o(y,r.beforeRemove?O.A:O.removeNode);for(var k,S=0,u=O.e.firstChild(e);w=b[S];S++){for(w.M||O.a.extend(w,d(e,n,w.U,a,w.na)),g=0;p=w.M[g];u=p.nextSibling,k=p,g++)p!==u&&O.e.Pa(e,p,k);!w.Ab&&a&&(a(w.U,w.M,w.na),w.Ab=i)}s(r.beforeRemove,t),s(r.afterMove,C),s(r.afterAdd,h),O.a.f.set(e,"setDomNodeChildrenFromArrayMapping_lastMappingResult",m)},O.b("utils.setDomNodeChildrenFromArrayMapping",O.a.$a),O.C=function(){this.allowTemplateRewriting=a},O.C.prototype=new O.v,O.C.prototype.renderTemplateSource=function(e){var t=9>O.a.Z||!e.nodes?r:e.nodes();return t?O.a.L(t.cloneNode(i).childNodes):(e=e.text(),O.a.ta(e))},O.C.oa=new O.C,O.wa(O.C.oa),O.b("nativeTemplateEngine",O.C),O.qa=function(){var t=this.Db=function(){if(l===void 0||!l.tmpl)return 0;try{if((""+l.tmpl.tag.tmpl.open).indexOf("__")>=0)return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,i,a){a=a||{},2>t&&e(Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later."));var o=n.data("precompiled");return o||(o=n.text()||"",o=l.template(r,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),n.data("precompiled",o)),n=[i.$data],i=l.extend({koBindingContext:i},a.templateOptions),i=l.tmpl(o,n,i),i.appendTo(s.createElement("div")),l.fragments={},i},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){s.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},t>0&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},O.qa.prototype=new O.v,n=new O.qa,n.Db>0&&O.wa(n),O.b("jqueryTmplTemplateEngine",O.qa)}var i=!0,r=null,a=!1,o=window,s=document,u=navigator,l=window.jQuery,c=void 0;"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?n(module.exports||exports):"function"==typeof define&&define.amd?define(["exports"],n):n(o.ko={})}(),function(){function e(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),e=!0,window.localStorage.removeItem("_tmptest")}catch(n){}if(e)try{window.localStorage&&(x=window.localStorage,k="localStorage",V=x.jStorage_update)}catch(a){}else if("globalStorage"in window)try{window.globalStorage&&(x=window.globalStorage[window.location.hostname],k="globalStorage",V=x.jStorage_update)}catch(o){}else{if(C=document.createElement("link"),!C.addBehavior)return C=null,void 0;C.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(C);try{C.load("jStorage")}catch(s){C.setAttribute("jStorage","{}"),C.save("jStorage"),C.load("jStorage")}var l="{}";try{l=C.getAttribute("jStorage")}catch(c){}try{V=C.getAttribute("jStorage_update")}catch(h){}x.jStorage=l,k="userDataBehavior"}u(),d(),t("local"),t("session"),i(),f(),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&r()},!1)}function t(e,n){function i(){if("session"==e)try{l=b.parse(window.name||"{}")}catch(t){l={}}}function r(){"session"==e&&(window.name=b.stringify(l))}var a,o,s=!1,u=0,l={};if(Math.random(),n||void 0===window[e+"Storage"]){if("local"==e&&window.globalStorage)return localStorage=window.globalStorage[window.location.hostname],void 0;if("userDataBehavior"==k){n&&window[e+"Storage"]&&window[e+"Storage"].parentNode&&window[e+"Storage"].parentNode.removeChild(window[e+"Storage"]),o=document.createElement("button"),document.getElementsByTagName("head")[0].appendChild(o),"local"==e?l=_:"session"==e&&i();for(a in l)l.hasOwnProperty(a)&&"__jstorage_meta"!=a&&"length"!=a&&l[a]!==void 0&&(a in o||u++,o[a]=l[a]);o.length=u,o.key=function(e){var t,n=0;i();for(t in l)if(l.hasOwnProperty(t)&&"__jstorage_meta"!=t&&"length"!=t&&l[t]!==void 0){if(n==e)return t;n++}},o.getItem=function(t){return i(),"session"==e?l[t]:y.jStorage.get(t)},o.setItem=function(e,t){void 0!==t&&(o[e]=""+(t||""))},o.removeItem=function(t){return"local"==e?y.jStorage.deleteKey(t):(o[t]=void 0,s=!0,t in o&&o.removeAttribute(t),s=!1,void 0)},o.clear=function(){return"session"==e?(window.name="",t("session",!0),void 0):(y.jStorage.flush(),void 0)},"local"==e&&(O=function(e,t){"length"!=e&&(s=!0,t===void 0?e in o&&(u--,o.removeAttribute(e)):(e in o||u++,o[e]=""+(t||"")),o.length=u,s=!1)}),o.attachEvent("onpropertychange",function(t){if("length"!=t.propertyName&&!s&&"length"!=t.propertyName){if("local"==e)t.propertyName in l||void 0===o[t.propertyName]||u++;else if("session"==e)return i(),void 0===o[t.propertyName]||t.propertyName in l?o[t.propertyName]===void 0&&t.propertyName in l?(delete l[t.propertyName],u--):l[t.propertyName]=o[t.propertyName]:(l[t.propertyName]=o[t.propertyName],u++),r(),o.length=u,void 0;y.jStorage.set(t.propertyName,o[t.propertyName]),o.length=u}}),window[e+"Storage"]=o}}}function n(){var e="{}";if("userDataBehavior"==k){C.load("jStorage");try{e=C.getAttribute("jStorage")}catch(t){}try{V=C.getAttribute("jStorage_update")}catch(n){}x.jStorage=e}u(),d(),f()}function i(){"localStorage"==k||"globalStorage"==k?"addEventListener"in window?window.addEventListener("storage",r,!1):document.attachEvent("onstorage",r):"userDataBehavior"==k&&setInterval(r,1e3)}function r(){var e;clearTimeout(T),T=setTimeout(function(){if("localStorage"==k||"globalStorage"==k)e=x.jStorage_update;else if("userDataBehavior"==k){C.load("jStorage");try{e=C.getAttribute("jStorage_update")}catch(t){}}e&&e!=V&&(V=e,a())},25)}function a(){var e,t=b.parse(b.stringify(_.__jstorage_meta.CRC32));n(),e=b.parse(b.stringify(_.__jstorage_meta.CRC32));var i,r=[],a=[];for(i in t)if(t.hasOwnProperty(i)){if(!e[i]){a.push(i);continue}t[i]!=e[i]&&"2."==(t[i]+"").substr(0,2)&&r.push(i)}for(i in e)e.hasOwnProperty(i)&&(t[i]||r.push(i));o(r,"updated"),o(a,"deleted")}function o(e,t){if(e=[].concat(e||[]),"flushed"==t){e=[];for(var n in I)I.hasOwnProperty(n)&&e.push(n);t="deleted"}for(var i=0,r=e.length;r>i;i++)if(I[e[i]])for(var a=0,o=I[e[i]].length;o>a;a++)I[e[i]][a](e[i],t)}function s(){var e=""+ +new Date;"localStorage"==k||"globalStorage"==k?x.jStorage_update=e:"userDataBehavior"==k&&(C.setAttribute("jStorage_update",e),C.save("jStorage")),r()}function u(){if(x.jStorage)try{_=b.parse(x.jStorage+"")}catch(e){x.jStorage="{}"}else x.jStorage="{}";S=x.jStorage?(x.jStorage+"").length:0,_.__jstorage_meta||(_.__jstorage_meta={}),_.__jstorage_meta.CRC32||(_.__jstorage_meta.CRC32={})}function l(){p();try{x.jStorage=b.stringify(_),C&&(C.setAttribute("jStorage",x.jStorage),C.save("jStorage")),S=x.jStorage?(x.jStorage+"").length:0}catch(e){}}function c(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==e)throw new TypeError("Reserved key name");return!0}function d(){var e,t,n,i,r=1/0,a=!1,u=[];if(clearTimeout(w),_.__jstorage_meta&&"object"==typeof _.__jstorage_meta.TTL){e=+new Date,n=_.__jstorage_meta.TTL,i=_.__jstorage_meta.CRC32;for(t in n)n.hasOwnProperty(t)&&(e>=n[t]?(delete n[t],delete i[t],delete _[t],a=!0,u.push(t)):r>n[t]&&(r=n[t]));1/0!=r&&(w=setTimeout(d,r-e)),a&&(l(),s(),o(u,"deleted"))}}function f(){if(_.__jstorage_meta.PubSub){for(var e,t=D,n=len=_.__jstorage_meta.PubSub.length-1;n>=0;n--)e=_.__jstorage_meta.PubSub[n],e[0]>D&&(t=e[0],h(e[1],e[2]));D=t}}function h(e,t){if($[e])for(var n=0,i=$[e].length;i>n;n++)$[e][n](e,b.parse(b.stringify(t)))}function p(){if(_.__jstorage_meta.PubSub){for(var e=+new Date-2e3,t=0,n=_.__jstorage_meta.PubSub.length;n>t;t++)if(e>=_.__jstorage_meta.PubSub[t][0]){_.__jstorage_meta.PubSub.splice(t,_.__jstorage_meta.PubSub.length-t);break}_.__jstorage_meta.PubSub.length||delete _.__jstorage_meta.PubSub}}function m(e,t){_.__jstorage_meta||(_.__jstorage_meta={}),_.__jstorage_meta.PubSub||(_.__jstorage_meta.PubSub=[]),_.__jstorage_meta.PubSub.unshift([+new Date,e,t]),l(),s()}function g(e,t){for(var n,i=e.length,r=t^i,a=0;i>=4;)n=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24,n=1540483477*(65535&n)+((65535&1540483477*(n>>>16))<<16),n^=n>>>24,n=1540483477*(65535&n)+((65535&1540483477*(n>>>16))<<16),r=1540483477*(65535&r)+((65535&1540483477*(r>>>16))<<16)^n,i-=4,++a;switch(i){case 3:r^=(255&e.charCodeAt(a+2))<<16;case 2:r^=(255&e.charCodeAt(a+1))<<8;case 1:r^=255&e.charCodeAt(a),r=1540483477*(65535&r)+((65535&1540483477*(r>>>16))<<16)}return r^=r>>>13,r=1540483477*(65535&r)+((65535&1540483477*(r>>>16))<<16),r^=r>>>15,r>>>0}var v="0.3.2",y=window.jQuery||window.$||(window.$={}),b={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return(e+"").evalJSON()}||y.parseJSON||y.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||y.toJSON};if(!b.parse||!b.stringify)throw Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var w,_={__jstorage_meta:{CRC32:{}}},x={jStorage:"{}"},C=null,S=0,k=!1,I={},T=!1,V=0,$={},D=+new Date,A={isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?"HTML"!==t.nodeName:!1},encode:function(e){if(!this.isXML(e))return!1;try{return(new XMLSerializer).serializeToString(e)}catch(t){try{return e.xml}catch(n){}}return!1},decode:function(e){var t,n="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t};return n?(t=n.call("DOMParser"in window&&new DOMParser||window,e,"text/xml"),this.isXML(t)?t:!1):!1}},O=function(){};y.jStorage={version:v,set:function(e,t,n){if(c(e),n=n||{},t===void 0)return this.deleteKey(e),t;if(A.isXML(t))t={_is_xml:!0,xml:A.encode(t)};else{if("function"==typeof t)return void 0;t&&"object"==typeof t&&(t=b.parse(b.stringify(t)))}return _[e]=t,_.__jstorage_meta.CRC32[e]="2."+g(b.stringify(t)),this.setTTL(e,n.TTL||0),O(e,t),o(e,"updated"),t},get:function(e,t){return c(e),e in _?_[e]&&"object"==typeof _[e]&&_[e]._is_xml?A.decode(_[e].xml):_[e]:t===void 0?null:t},deleteKey:function(e){return c(e),e in _?(delete _[e],"object"==typeof _.__jstorage_meta.TTL&&e in _.__jstorage_meta.TTL&&delete _.__jstorage_meta.TTL[e],delete _.__jstorage_meta.CRC32[e],O(e,void 0),l(),s(),o(e,"deleted"),!0):!1},setTTL:function(e,t){var n=+new Date;return c(e),t=Number(t)||0,e in _?(_.__jstorage_meta.TTL||(_.__jstorage_meta.TTL={}),t>0?_.__jstorage_meta.TTL[e]=n+t:delete _.__jstorage_meta.TTL[e],l(),d(),s(),!0):!1},getTTL:function(e){var t,n=+new Date;return c(e),e in _&&_.__jstorage_meta.TTL&&_.__jstorage_meta.TTL[e]?(t=_.__jstorage_meta.TTL[e]-n,t||0):0},flush:function(){return _={__jstorage_meta:{CRC32:{}}},t("local",!0),l(),s(),o(null,"flushed"),!0},storageObj:function(){function e(){}return e.prototype=_,new e},index:function(){var e,t=[];for(e in _)_.hasOwnProperty(e)&&"__jstorage_meta"!=e&&t.push(e);return t},storageSize:function(){return S},currentBackend:function(){return k},storageAvailable:function(){return!!k},listenKeyChange:function(e,t){c(e),I[e]||(I[e]=[]),I[e].push(t)},stopListening:function(e,t){if(c(e),I[e]){if(!t)return delete I[e],void 0;for(var n=I[e].length-1;n>=0;n--)I[e][n]==t&&I[e].splice(n,1)}},subscribe:function(e,t){if(e=""+(e||""),!e)throw new TypeError("Channel not defined");$[e]||($[e]=[]),$[e].push(t)},publish:function(e,t){if(e=""+(e||""),!e)throw new TypeError("Channel not defined");m(e,t)},reInit:function(){n()}},e()}(),function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=n.length,r=window.console=window.console||{};i--;)e=n[i],r[e]||(r[e]=t)}(),function(){"use strict";var e,t,n,i,r,a,o,s=this,u={},l=s.__SITECOREDEBUG||!1,c={},d=window._sc;void 0!==s.Sitecore?u=s.Sitecore.Speak:(s.Sitecore={},s.Sitecore.Speak={}),t=e="undefined"!=typeof exports?exports:s.Sitecore.Speak=s._sc={};var f=s.jQuery,h=s._,p=s.ko;h||"undefined"==typeof require||(h=require("underscore")),Backbone||"undefined"==typeof require||(h=require("backbone")),p||"undefined"==typeof require||(p=require("knockout")),t.VERSION="1.0.1",t.__SPEAKDEBUG=l,t.__info=c,t.Pipelines={},t.Factories={},t.Commands={},t.Behaviors={},t.Definitions={Models:{},Views:{},Data:{}},n=t.Definitions.Models,i=t.Definitions.Views,r=t.Definitions.Data,a=t.Commands,o=t.Factories,t.Web={},t.SiteInfo={},t.SiteInfo.virtualFolder="/",t.debug=function(){if(l){switch(arguments.length){case 1:return console.log(arguments[0]),void 0;case 2:return console.log(arguments[0],arguments[1]),void 0;case 3:console.log(arguments[0],arguments[1],arguments[2]);case 4:return console.log(arguments[0],arguments[1],arguments[2],arguments[3]),void 0}console.log(arguments)}};var m=function(e,t){var n=new p.bindingProvider,i=n.nodeHasBindings;return n.exclusionSelector=e,n.nodeHasBindings=function(e){return 8===e.nodeType||f(e).is(n.exclusionSelector)||0!==f(e).closest(t).length?8!==e.nodeType||e.registered?!1:i.call(this,e):i.call(this,e)},n};p.bindingProvider.instance=new m(".data-sc-registered",".data-sc-waiting"),p.bindingHandlers.readonly={update:function(e,t){var n=p.utils.unwrapObservable(t());n?e.setAttribute("readOnly",!0):e.removeAttribute("readOnly")}},s.dialogClose=function(e){t.trigger("sc-frame-message",e)},s.receiveMessage=function(e,n){t.trigger("sc-frame-message",e,n)},s.getParameterByName=function(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),regexS="[\\?&]"+e+"=([^&#]*)",regex=RegExp(regexS),results=regex.exec(window.location.href),null==results?"":decodeURIComponent(results[1].replace(/\+/g," "))},function(e){e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=function(e,t){var i=n(this,e,t);return i.extend=this.extend,i};var t=function(){},n=function(n,i,r){var a,o=n.prototype,s=/xyz/.test(function(){})?/\b_super\b/:/.*/;if(a=i&&i.hasOwnProperty("constructor")?i.constructor:function(){n.apply(this,arguments)},h.extend(a,n),t.prototype=n.prototype,a.prototype=new t,i){h.extend(a.prototype,i);var u=i.nestedlayout||a.prototype.nestedlayout,l=a.prototype.modelType===e.Model;l||i.render||u||(i.render=function(){}),l||i.afterRender||u||(i.afterRender=function(){}),l||i.beforeRender||u||(i.beforeRender=function(){});for(var c in i)"function"==typeof i[c]&&"function"==typeof o[c]&&s.test(i[c])&&(a.prototype[c]=function(e,t){return function(){var n=this._super;this._super=o[e];var i=t.apply(this,arguments);return this._super=n,i}}(c,i[c])),u||l||"render"!==c&&"beforeRender"!==c&&"afterRender"!==c||(a.prototype[c]=function(e,t){return function(){if(t.apply(this,arguments),this.hasBehavior){var n=[];"render"===e&&(n=this.behaviorsRender),"afterRender"===e&&(n=this.behaviorsAfterRender),"beforeRender"===e&&(n=this.behaviorsBeforeRender),h.each(n,function(e){e.apply(this,arguments)},this)}}}(c,i[c]))}return r&&h.extend(a,r),a.prototype.constructor=a,a.__super__=n.prototype,a}}(Backbone),n.Model=Backbone.Model.extend({ko:!0,modelType:Backbone.Model,set:function(){var e=arguments[2];arguments[2]||(arguments[2]={}),h.clone(arguments[2].silent);var t=arguments[2].force;if(Backbone.Model.prototype.set.apply(this,arguments),e&&e.computed&&(this.computed=this.computed||{},this.computed[arguments[0]]=e),h.isObject(arguments[0])||e&&e.local||this.updateViewModel(arguments[0],t),h.isObject(arguments[0])&&(!e||!e.local)){var n=arguments[0],i=h.keys(n);h.each(i,function(e){this.updateViewModel(e)},this)}},constructor:function(t){this.ko&&(this.viewModel={}),this.defaults&&t&&h.isObject(t)&&(this.defaults=h.extend(this.defaults,t)),this.ko&&this.defaults&&(this._removeComputed(),this._creatingViewModelFromDefaults()),this.useLocalStorage&&(this.localStorage=new e.Definitions.Data.LocalStorage(t.name)),Backbone.Model.apply(this,[t]),this.ko&&(this._setComputed(),this._preventDefaultFunction(),this._creatingViewModel())},_preventDefaultFunction:function(){var e=["_creatingViewModel","_creatingViewModelFromDefaults","_setComputed","_findAppropriateAndApplyBinding","_removeComputed","_super","_preventDefaultFunction","_validate","bind","change","changedAttributes","clear","clone","constructor","destroy","escape","fetch","get","has","hasChanged","initialize","isNew","isValid","observable","off","on","parse","previous","previousAttributes","save","set","toJSON","trigger","unbind","unset","url"],t=h.functions(this);this.applicableFunctionsFromModel=h.reject(t,function(t){return h.indexOf(e,t)>=0})},_creatingViewModelFromDefaults:function(){var e=this,t=h.keys(this.defaults);h.each(t,function(e){this._findAppropriateAndApplyBinding(e,this.defaults)},this);var n={};this.applicableFunctionsFromModel&&h.each(this.applicableFunctionsFromModel,function(t){n[t]=function(){e[t].apply(e,arguments)}}),h.extend(this.viewModel,n)},_removeComputed:function(){var e=h.keys(this.defaults),t=this.defaults,n=this,i=[];h.each(e,function(e){var n=t[e];if(h.isObject(n)&&n.computed){var r=h.clone(n),a={computed:!0,read:r.read};r.write&&(a=h.extend(a,{write:r.write})),r.owner&&(a=h.extend(a,{owner:r.owner})),i.push({key:e,value:r.value,computed:a}),delete t[e]}}),n.computeds=i},_setComputed:function(){h.each(this.computeds,function(e){var t=e.value||"",n=h.extend(e.computed,{local:!0});this.set(e.key,t,e.computed,n)},this)},updateViewModel:function(e,t){(this.viewModel&&!this.viewModel[e]||t)&&this._findAppropriateAndApplyBinding(e,this.attributes,t)},_findAppropriateAndApplyBinding:function(e,t,n){var i=this.viewModel||{};if(!i[e]||n){if(h.isArray(t[e]))if(t[e].length>0&&t[e][0]&&t[e][0].modelType===Backbone.Model){var r=[];h.each(t[e],function(e){r.push(e.viewModel)}),i[e]=p.observableArray(r),i[e].nested=!0}else i[e]=p.observableArray(t[e]);else t[e]&&t[e].constructor&&h.isObject(t[e].constructor.__super__)&&t[e].ko?(i[e]=t[e].viewModel,i[e].nested=!0):this.computed&&this.computed[e]||(i[e]=p.observable(t[e]));this._registerComputed(e),this._registerSubscribe(e)}},_registerSubscribe:function(e){var t=this,n=this.subscriptions||[],i=this.viewModel||{};i[e].nested||(i[e].isComputed||t.on("change:"+e,function(){if(h.isArray(t.get(e))&&t.get(e).length>0&&t.get(e)[0]&&t.get(e)[0].modelType&&t.get(e)[0].modelType===Backbone.Model){var n=[];h.each(t.get(e),function(e){n.push(e.viewModel)}),i[e](n)}else i[e](t.get(e))}),i[e].subscribe&&(n[e]=i[e].subscribe(function(n){t.set(e,n)})))},_registerComputed:function(e){var t=this,n=this.viewModel||{};if(t.computed&&t.computed[e]){this.computed[e].write&&!this.computed[e].owner&&(t.computed[e].owner=this.viewModel);var i=h.pick(t.computed[e],"write","owner","read");n[e]=i.write?p.computed(i):p.computed(i.read,this.viewModel),n[e].isComputed=!0}},_creatingViewModel:function(){var e=h.keys(this.attributes);h.each(e,function(e){this._findAppropriateAndApplyBinding(e,this.attributes)},this),h.each(e,this._registerComputed,this),h.each(e,this._registerSubscribe,this)}}),n.Model.extend=Backbone.Model.extend,i.View=function(t){t&&(this.app=t.app?t.app:"No parent for this app",delete t.app);var n=this;t&&t.behaviors&&h.each(t.behaviors.split(" "),function(t){n.addBehavior(e.Behaviors[t])}),Backbone.View.apply(this,[t]),this.model&&this.$el&&!this.model.viewModel.$el&&(this.model.viewModel.$el=this.$el),this.model&&this.app&&!this.model.viewModel.app&&(this.model.viewModel.app=this.app),this.setupFunctionWhichCouldBeDataBound(),this.sync()},h.extend(e.Definitions.Views.View.prototype,Backbone.View.prototype,{setupFunctionWhichCouldBeDataBound:function(){var e=["$","_configure","_ensureElement","setupFunctionWhichCouldBeDataBound","applyBindingsIfApplicable","bind","constructor","delegateEvents","initialize","make","off","on","remove","render","setElement","trigger","unbind","undelegateEvents","afterRender","beforeRender","sync"],t=h.functions(this);this.applicableFunctionsFromView=h.reject(t,function(t){return h.indexOf(e,t)>=0});var n=this;h.each(this.applicableFunctionsFromView,function(e){if(this.model&&this.model.viewModel[e])throw"Conflicted names between Model and View, please provide different names: "+e;this.model&&(this.model.viewModel[e]=function(){return n[e].apply(n,arguments)})},this)},sync:function(){this.model&&this.model.ko&&(l&&console.log("Applying Binding for the element which has the data-sc-id: "+this.$el.data("sc-id")+". The viewModel you are trying to apply is:",this.model.viewModel),p.applyBindings(this.model.viewModel?this.model.viewModel:this.model,this.$el.get(0)))},listen:{}}),i.View.extend=Backbone.View.extend,e.Definitions.App=Backbone.Model.extend({appId:void 0,modelType:"application",initialize:function(){this.Controls=[],this.localStorage=this.appId?new e.Definitions.Data.LocalStorage(this.appId):"you need to provide a appID in order to use localStorage"},run:function(e,n,i){var r=t.Factories.createApp(e,n,i,this);return void 0!==this.initialized&&this.initialized(),r.trigger("app:loaded"),r},insertControl:function(e,t,n){var i=this;f.post("/api/rendering",e,function(e){i.insertMarkups(e,name,t,n)})},insertRendering:function(e,t,n){var i,r,a,o,s=this,u=t.ajax||{},l={database:"core",path:"/"},c=n;return u&&u.success&&(o=u.success),h.isFunction(t)?c=t:t&&(l=h.extend(l,t),i=t.selector?t.selector:void 0,r=t.$el?t.$el:void 0),l.name||(l.name=h.uniqueId("subapp_")),a=f.ajax({url:l.path+"?sc_itemid="+e+"&sc_database="+l.database,method:"GET",beforeSend:u.beforeSend,success:function(e,t,n){o&&o.call(e,t,n),s.insertMarkups(e,l.name,{selector:i,$el:r},c)},error:u.error,complete:u.complete})},insertMarkups:function(e,n,i,r){var a,o={prepend:!1,selector:void 0,parent:void 0,$el:void 0},i=h.extend(o,i),s="<div id='"+n+"' data-sc-app style='display:none;'>"+e+"</div>";a=i.$el?i.$el:i.selector?f(i.selector):f("body"),i.prepend?a.prepend(s):a.append(s),t.load(window,a.find("#"+n),function(e){e.ScopedEl.show(),r&&r(e)})},destroy:function(){var t=this;h.each(t.Controls,function(e){e.view.$el.data("sc-app",null),e.view.$el.removeClass("data-sc-registered")});for(var n in t)t[n]instanceof e.Definitions.App&&h.each(t[n].Controls,function(e){e.view.$el.data("sc-app",null),e.view.$el.removeClass("data-sc-registered")});h.each(t.Controls,function(e){p.cleanNode(e.view.$el.get(0)),delete e.model,delete e.view});for(var n in t)delete t[n];return void 0},closeDialog:function(e){window.top.returnValue=e,window.top.dialogClose(e)},sendMessage:function(e){window.top.receiveMessage(e,s.getParameterByName("sp"))}}),e.Definitions.App.extend=Backbone.View.extend,h.extend(e,Backbone.Events),h.extend(i.View.prototype,{addBehavior:function(e){if(this.hasBehavior=!0,this.behaviors=this.behaviors||[],this.behaviorsBeforeRender=this.behaviorsBeforeRender||[],this.behaviorsAfterRender=this.behaviorsAfterRender||[],this.behaviorsRender=this.behaviorsRender||[],!(e.initialize||e.afterRender||e.render||e.beforeRender))throw"behavior should have an initialize or an after Render method";e.events&&(this.events?h.extend(this.events,e.events):this.events=e.events),e.initialize&&this.behaviors.push(e.initialize),e.afterRender&&this.behaviorsAfterRender.push(e.afterRender),e.render&&this.behaviorsRender.push(e.render),e.beforeRender&&this.behaviorsBeforeRender.push(e.beforeRender);var t=h.omit(e,"initialize","events","afterRender","render","beforeRender");h.extend(this,t)}}),h.extend(t,{destroy:function(t){if(!t&&!t.destroy)throw"you need an app to be destroy";var n=t.name;t.destroy(),delete e[n]},noConflict:function(t){return s._sc===e&&(s._sc=d),t&&s.Speak===e&&(s.Speak=u),e}}),h.extend(t,{load:function(n,i,r){var a=[],o=!1;i||(i=f("html"),o=!0),f(i).find("[data-sc-require]").each(function(){var e=f(this);e.is("[data-sc-app]")||f.each(e.data("sc-require").split(","),function(e,t){0>h.indexOf(a,t)&&a.push(t)})});var s=[],u=n.__sc_define;n.__sc_define=function(e,t,n){"string"==typeof e&&s.push(e),u&&u(e,t,n)},f(i).find("script[type='text/x-sitecore-pagescript']").each(function(){n.__sc_define(f(this).attr("src"))}),require(a,function(){var a=f(i).find("script[type='text/x-sitecore-pagecode']"),l=f(i),c=a.attr("src"),d=a.data("sc-behaviors"),h=null;l.attr("data-sc-behaviors",d);var p=function(){if(0==s.length){n.__sc_define=u;var e=new h;r?r(e.run(i.attr("id"),i.attr("id"))):e.run(),o&&t.Helpers.overlay.loadOverlays(e)}else{var a=s;s=[],t.debug("Requiring files: ",a),require(a,p)}},m=function(){if(0===s.length)if(c)t.debug("Requiring page code: ",[c]),require([c],function(e){h=e,p()});else{n.__sc_define=u;var a;a=o?e.Factories.createApp():e.Factories.createApp(i.attr("id"),i.attr("id")),o&&(t.Helpers.overlay.loadOverlays(a),void 0!==a.initialized&&a.initialized(),a.trigger("app:loaded")),r&&r(a)}else{var l=s;s=[],t.debug("Requiring files: ",l),require(l,m)}};m()})}}),h.extend(a,{resolve:function(e){if(!h.isString(e))throw"provied a correct Path to resolve";for(var t=e.split("."),n=s||window,i=0;t.length>i;i++)if(n=n[t[i]],null==n)throw"Reference '"+e+"' not found";return n},executeCommand:function(e,t){if(!e||!h.isString(e))throw"cannot execute command without commandName";var n=a.getCommand(e);n.canExecute(t)&&n.execute(t)},getCommand:function(e){return a.resolve(e)}});var g=function(){var e=this._scAttrs;h.each(e,function(e){if(e.value&&-1!==e.value.indexOf("$el.")){var t=e.value.substring("$el.".length);if(-1!==t.indexOf(":")){var n=t.split(":");if(2===n.length){var i=this.$el[n[0]](n[1]);void 0!==i?this.model.set(e.name,i):e.defaultValue&&this.model.set(e.name,e.defaultValue)}}else this.model.set(e.name,this.$el[t]())}},this),h.each(e,function(e){e.on&&this.model.on("change:"+e.name,this[e.on],this)},this)},v=function(){this._scAttrs&&h.each(this._scAttrs,function(e){var t=h.keys(e),n=this.localStorage.get(e.name);n?this.set(e.name,n):-1===t.indexOf("defaultValue")&&e.value&&-1!==e.value.indexOf("$el.")?this.set(e.name,null):-1===t.indexOf("defaultValue")&&-1===e.value.indexOf("$el.")?this.set(e.name,e.value):t.indexOf("defaultValue")>-1?this.set(e.name,e.defaultValue):this.set(e.name,void 0)},this)},y=function(){this._scAttrs&&h.each(this._scAttrs,function(e){var t=h.keys(e);-1===h.indexOf(t,"defaultValue")&&e.value&&-1!==e.value.indexOf("$el.")?this.set(e.name,null):-1===h.indexOf(t,"defaultValue")&&-1===e.value.indexOf("$el.")?this.set(e.name,e.value):h.indexOf(t,"defaultValue")>-1?this.set(e.name,e.defaultValue):this.set(e.name,void 0)
},this)},b=function(e){var t=e;return function(){t.prototype.set.apply(this,arguments);var e=arguments[2];if(h.isObject(arguments[0])&&(!e||!e.local)){var n=arguments[0],i=h.keys(n);h.each(i,function(e){this.localStorage.set(e,n[e])},this)}h.isObject(arguments[0])||e&&e.computed||this.localStorage.set(arguments[0],arguments[1])}};h.extend(o,{createBehavior:function(e,n){return t.Behaviors=t.Behaviors||{},t.Behaviors[e]?t.debug("You are trying to create twice the behaviour "+e):t.Behaviors[e]=n,t.Behaviors[e]},createBaseComponent:function(e){if(!e.name||!e.selector)throw"provide a name and/or a selector";var r,a,o=e.name,s=e.selector,u=e.attributes,l=e.initialize,c=e.base,d=["attributes","name","selector","base","plugin","initialize","listenTo","_scInitFromObject","extendModel","_scInit","_scInitDefaultValue"],f=h.omit(e,d),p=n.Model,m=i.View,w=e.localStorage,_=e.extendModel||{},x=e.collection;c&&(r=h.find(t.Components,function(e){return e.type===c})),r&&(p=r.model,m=r.view);var C;w?(_=h.extend(_,{initialize:function(){this._super(),this._scInitDefaultValueFromLocalStorage()},set:b(p)},{useLocalStorage:!0}),C=p.extend(_)):(_=h.extend(_,{initialize:function(){this._super(),this._scInitDefaultValue()}}),C=p.extend(_));var S=m.extend({initialize:function(){t.debug("initialize - "+o),this._super(),this.model.componentName==o&&(this._scInitFromObject?(this._scInit(),this._scInitFromObject()):this._scInit())}});if(C=C.extend({_scAttrs:u,_scInitDefaultValue:y,_scInitDefaultValueFromLocalStorage:v}),a=h.extend(f,{_scAttrs:u,_scInit:g,_scInitFromObject:l}),e.listenTo){var k={},I=m.prototype.listen,T=e.listenTo,V=h.keys(T);h.each(V,function(e){k[e+":$this"]=T[e]}),k=h.extend(I,k),S=h.extend(S,k)}var $;return x&&($=Backbone.Collection.extend({model:x})),S=S.extend(a),t.Factories.createComponent(o,C,S,s,$)},createComponent:function(e,n,i,r,a){var o;if(!(h.isString(e)&&n&&i&&h.isString(r)))throw"please provide a correct: type (str), model, view and el (html class or id)";return t.Components=t.Components||[],t.Definitions.Models[e]=n,t.Definitions.Views[e]=i,a&&(t.Definitions.Collections[e]=a),h.each(t.Components,function(e){if(e.el===r)throw"you are trying to add compoment with the same el (.class or #id)"}),o={type:e,model:n,view:i,el:r,collection:a},t.Components.push(o),o},createApp:function(e,n,i,r){var a={};return h.isObject(e)?(a=e,t.Pipelines.Application.execute(a),a.current):(a.name=e,a.id=n,a.mainApp=i,a.app=r,a.aborted=!1,t.Pipelines.Application.execute(a),a.current)},createPageCode:function(e,n){var i;return i=t.Definitions.App.extend(n),i=i.extend({appId:e})},createBindingConverter:function(e){if(!e.name||!e.convert)throw"invalid binding converter";if(t.BindingConverters&&t.BindingConverters[e.name])throw"already a converter with the same name";t.BindingConverters=t.BindingConverters||{},t.BindingConverters[e.name]=e.convert}}),n.ComponentModel=n.Model.extend({initialize:function(){}}),n.ControlModel=n.ComponentModel.extend({initialize:function(){this._super(),this.set("isVisible",!0)},toggle:function(){this.set("isVisible",!this.get("isVisible"))}}),n.BlockModel=n.ControlModel.extend({initialize:function(){this._super(),this.set("width",0),this.set("height",0)}}),n.InputModel=n.ControlModel.extend({initialize:function(){this._super(),this.set("isEnabled",!0)}}),n.ButtonBaseModel=n.ControlModel.extend({initialize:function(){this._super(),this.set("isEnabled",!0)}});var w=e.Definitions.Views;w.ComponentView=w.View.extend({listen:h.extend({},e.Definitions.Views.View.prototype.listen,{"set:$this":"set"}),initialize:function(){if(!this.model)throw"Model required in order to instantiate ComponentView";if(!this.el)throw"Element required in order to instantiate ComponentView";var e=this.$el.data("init");if(e){var t=h.keys(e);h.each(t,function(t){this.set(t,e[t])},this.model)}},set:function(e){e&&h.each(h.keys(e),function(t){this.model.set(t,e[t])},this)}}),w.ControlView=w.ComponentView.extend({listen:h.extend({},e.Definitions.Views.ComponentView.prototype.listen,{"toggle:$this":"toggle","focus:$this":"focus","show:$this":"show","hide:$this":"hide"}),initialize:function(){this._super(),this.model.set("isVisible","none"!==this.$el.css("display"))},focus:function(){this.$el.focus()},hide:function(){this.model.set("isVisible",!1)},show:function(){this.model.set("isVisible",!0)},toggle:function(){this.model.toggle()}}),w.BlockView=w.ControlView.extend({initialize:function(){this._super(),this.model.set("width",this.$el.width()),this.model.set("height",this.$el.height())}}),w.InputView=w.ControlView.extend({listen:h.extend({},e.Definitions.Views.ComponentView.prototype.listen,{"enable:$this":"enable","disable:$this":"disable"}),initialize:function(){this._super(),this.model.set("isEnabled","disabled"!=f(this.el).attr("disabled"))},disable:function(){this.model.set("isEnabled",!1)},enable:function(){this.model.set("isEnabled",!0)}}),w.ButtonBaseView=w.ControlView.extend({listen:h.extend({},e.Definitions.Views.ControlView.prototype.listen,{"enable:$this":"enable","disable:$this":"disable"}),initialize:function(){this._super(),this.model.set("isEnabled","disabled"!=f(this.el).attr("disabled"))},click:function(){if(this.model.get("isEnabled")){var t=this.$el.attr("data-sc-click");t&&e.Helpers.invocation.execute(t,{control:this,app:this.app}),this.model._events&&this.model._events.click&&h.each(this.model._events.click,function(e){e.callback&&e.context&&e.callback.call(e.context)})}},disable:function(){this.model.set("isEnabled",!1)},enable:function(){this.model.set("isEnabled",!0)}}),t.Definitions.Collections=t.Definitions.Collections||[],o.createComponent("ComponentBase",n.ComponentModel,i.ComponentView,".sc-componentbase"),o.createComponent("ControlBase",n.ControlModel,i.ControlView,".sc-controlbase"),o.createComponent("BlockBase",n.BlockModel,i.BlockView,".sc-blockbase"),o.createComponent("ButtonBase",n.ButtonBaseModel,i.ButtonBaseView,".sc-buttonBase"),o.createComponent("InputBase",n.InputModel,i.InputView,".sc-inputbase"),o.createComponent("PageBase",n.Model,i.View,"body"),o.createBindingConverter({name:"Has",convert:function(e){return e&&e[0]?h.isArray(e[0])?0===e[0].length?!1:!0:!0:!1}}),o.createBindingConverter({name:"Not",convert:function(e){return!(e&&e[0])}});var _={combine:function(){if(0===arguments.length)return"";var e=h.reduce(arguments,function(e,t){return t&&h.isString(t)?e+"/"+h.compact(t.split("/")).join("/"):e});return e?0===e.indexOf("/")?e:"/"+e:""},isParameterNameAlreadyInUrl:function(e,t){return e.indexOf("?"+t+"=")>=0||e.indexOf("&"+t+"=")>=0},addQueryParameters:function(e,t){var n,i=h.pairs(t),r="([\\?&])({{param}}=[^&]+)",a=e;return h.each(i,function(e){_.isParameterNameAlreadyInUrl(a,e[0])?(n=RegExp(r.replace("{{param}}",encodeURIComponent(e[0])),"i"),a=a.replace(n,"$1"+e[0]+"="+e[1])):(a=a+=~a.indexOf("?")?"&":"?",a+=encodeURIComponent(e[0])+"="+encodeURIComponent(e[1]))}),a},getQueryParameters:function(e){var t,n={};return h.isString(e)?(t=e.split("?"),(t=t.length>1?t[1].split("&"):t[0].split("&"))?(h.each(t,function(e){var t=e.split("=");2===t.length&&(n[t[0]]=decodeURIComponent(t[1].replace(/\+/g," ")))}),n):void 0):n}},x={parseISO:function(e){var t,n,i,r,a,o;return h.isString(e)?(t=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),8!==e.indexOf("T")?new Date(Date.UTC(t,n,i,0,0,0,0)):(r=parseInt(e.substr(9,2),10),a=parseInt(e.substr(11,2),10),o=parseInt(e.substr(13,2),10),new Date(Date.UTC(t,n,i,r,a,o)))):null},toISO:function(e){var t;return h.isDate(e)?(t="",t+=e.getUTCFullYear(),t+=this.ensureTwoDigits(e.getUTCMonth()+1),t+=this.ensureTwoDigits(e.getUTCDate()),t+="T",t+=this.ensureTwoDigits(e.getUTCHours()),t+=this.ensureTwoDigits(e.getUTCMinutes()),t+=this.ensureTwoDigits(e.getUTCSeconds())):t},isISO:function(e){var t,n=h.isString(e);return n&&":"===e.charAt(15)&&(e=e.substr(0,15)),!n||8!=e.length&&15!=e.length?!1:(t=this.parseISO(e),"[object Date]"===Object.prototype.toString.call(t)?isNaN(t.getYear())?!1:!0:!1)},ensureTwoDigits:function(e){return 10>e?"0"+(""+e):""+e}},C={isId:function(e){return h.isString(e)?/^\{?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\}?$/i.test(e):!1},toId:function(e){return e&&32===e.length?"{"+e.substr(0,8)+"-"+e.substr(8,4)+"-"+e.substr(12,4)+"-"+e.substr(16,4)+"-"+e.substr(20,12)+"}":e},toShortId:function(e){return h.isString(e)&&C.isId(e)?e.replace(/-|\{|\}/g,""):void 0}},S={endsWith:function(e,t){return t&&e?e.lastIndexOf(t)===e.length-t.length:!1},equals:function(e,t,n){return h.isString(e)&&h.isString(t)?n?h.isBoolean(n)?e===t:void 0:e.toLowerCase()===t.toLowerCase():void 0},format:function(e){return e?(h.each(arguments,function(t,n){e=e.replace(RegExp("\\{"+(n-1)+"\\}","gi"),t)}),e):e},formatByTemplate:function(e,t){if("function"!=typeof t)return e;if("string"!=typeof e)return"";var n=/{{(.*?)}}/gi,i=e.match(n);return h.each(i,function(n){var i=n.replace("{{","").replace("}}",""),r=t(i);void 0!==r&&null!=r&&(e=e.replace(n,r))}),e}},k={getOwnProperties:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}},I={execute:function(e,n){if(e){var i=e.indexOf(":");if(0>=i)throw"Invocation is malformed (missing 'handler:')";n=n||{};var r=e.substr(0,i),a=e.substr(i+1),o=h.extend({},{handler:r,target:a},n);t.Pipelines.Invoke.execute(o)}}},T={loadOverlays:function(e){var n=f("script[type='text/x-sitecore-overlays']");if(0!=n.length){var i=n.data("sc-overlays").split("|"),r=n.data("sc-parameters");for(var a in i){var o=i[a]+"?speak="+t.VERSION+"&"+r;f.ajax({url:o,dataType:"json"}).done(function(n){t.Helpers.overlay.processOverlays(e,n,i[a])}).fail(function(e){console.log("Overlay url failed: "+o,e)})}}},processOverlays:function(e,t,n){var i=t.overlays;for(var r in i)this.processOverlay(e,i[r],n)},processOverlay:function(e,t,n){var i,r=t.command,a=t.selector,o=t.placement,s=t.html;if("component:"==a.substr(0,10)){var u=a.substr(10),l=h.find(e.Controls,function(e){return e.name==u});if(null==l)return console.log("Overlay selector not found: "+a),void 0;i=l.view.$el}else i=f(a);if(null==i||0==i.length)return console.log("Overlay selector not found: "+a),void 0;switch(r){case"insert":this.insert(e,i,o,s,n);break;case"remove":this.remove(e,i);break;case"replace":this.replace(e,i,s,n);break;default:console.log("Unknow overlay command: "+r)}},insert:function(e,n,i,r,a){r="<div data-sc-app id='"+h.uniqueId("overlay-")+"' >"+r,r+="</div>";var o=f(f.parseHTML(r));switch(i){case"before":o.insertBefore(n);break;case"after":o.insertAfter(n);break;case"prepend":n.prepend(r);break;case"append":n.append(r);break;default:console.log("Unknow overlay insert placement: "+i)}t.load(window,o,function(e){t.trigger("overlay-loaded",{app:e,url:a})})},remove:function(e,t){t.remove()},replace:function(e,n,i,r){i=f.parseHTML(i),$html=f(i),n.replaceWith($html),t.load(window,$html,function(e){t.trigger("overlay-loaded",{app:e,url:r})})}},V={init:function(){f(window).resize(function(){t.trigger("window:resize",f(window).width(),f(window).height())})},loaded:function(){t.trigger("window:loaded")}};h.extend(t,{Helpers:{url:_,date:x,id:C,string:S,object:k,invocation:I,overlay:T,window:V}}),t.Helpers.window.init();var $=t.Helpers,D={_current:0,converters:[],aborted:!1},A=function(){return D.converters.length},O=function(e){if(e=e||{},!(h.isFunction(e.canConvert)&&h.isFunction(e.convert)&&h.isFunction(e.reConvert)&&h.isString(e.name)))throw"invalid converter";D.converters.push(e)},N=function(e){D.converters=h.reject(D.converters,function(t){return t.name===e})},M=function(e){return h.find(D.converters,function(t){return t.name===e})},j=function(){return D.converters},E={name:"date",canConvert:function(e){return $.string.equals(e.type,this.name)||$.string.equals(e.type,"datetime")},convert:function(e){var t="",n=e.value;if(n)try{return $.date.parseISO(n).toLocaleDateString()}catch(i){return t}return t},reConvert:function(e){if(!e)return"";try{var t=new Date(e);return $.date.toISO(t)}catch(n){return e||""}},toStringWithFormat:function(e,t){if($.date.isISO(e))try{var n=$.date.parseISO(e),i={mmss:{expression:"(\\W|^)mm(\\W+s{1,2}\\W|\\W+s{1,2}$)",value:$.date.ensureTwoDigits(n.getUTCMinutes())},mss:{expression:"(\\W|^)m(\\W+s{1,2}\\W|\\W+s{1,2}$)",value:""+n.getUTCMinutes()},hmm:{expression:"(\\Wh{1,2}\\W+|^h{1,2}\\W+)mm(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCMinutes())},hm:{expression:"(\\Wh{1,2}\\W+|^h{1,2}\\W+)m(\\W|$)",value:""+n.getUTCMinutes()},ms:{expression:"(\\Wss\\W|^ss\\W)00(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCMilliseconds())},ampm:{expression:"(\\W|^)AM/PM(\\W|$)",value:n.getUTCHours()>=12?"PM":"AM"},ap:{expression:"(\\W|^)A/P(\\W|$)",value:n.getUTCHours()>=12?"P":"A"},yyyy:{expression:"(\\W|^)yyyy(\\W|$)",value:""+n.getUTCFullYear()},yy:{expression:"(\\W|^)yy(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCFullYear()%100)},mm:{expression:"(\\W|^)mm(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCMonth()+1)},m:{expression:"(\\W|^)m(\\W|$)",value:""+(n.getUTCMonth()+1)},dd:{expression:"(\\W|^)dd(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCDate())},d:{expression:"(\\W|^)d(\\W|$)",value:""+n.getUTCDate()},hh:{expression:"(\\W|^)hh(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCHours())},h:{expression:"(\\W|^)h(\\W|$)",value:n.getUTCHours()>12?""+(n.getUTCHours()-12):""+(0==n.getUTCHours()?12:n.getUTCHours())},ss:{expression:"(\\W|^)ss(\\W|$)",value:$.date.ensureTwoDigits(n.getUTCSeconds())},s:{expression:"(\\W|^)s(\\W|$)",value:""+n.getUTCSeconds()}};for(var r in i){var a=i[r]?i[r].expression:"",o="$1"+i[r].value+"$2";if(""!=a){var s=RegExp(a,"g");t=t.replace(s,o)}}return t}catch(u){return e}return e}},U={name:"Icon",baseUrl:$.url.combine(t.SiteInfo.virtualFolder,"~/icon/"),canConvert:function(e){return $.string.equals(e.type,this.name)},convert:function(e){if(this.canConvert(e)){var t=e.value||"/sitecore/images/blank.gif";return 0!==t.indexOf("/sitecore/")&&(t=$.url.combine(this.baseUrl,t)),$.string.format('<img src="{0}" alt="" />',t)}},reConvert:function(){}},B={length:A,add:O,remove:N,get:M,getAll:j};B.add(E),B.add(U),h.extend(t,{Converters:B});var R=e.Pipelines=function(){var t=[];return{add:function(e){if(!e||!e.name||!h.isObject(e))throw new"invalid pipeline";t.push(e),this[e.name]=e},remove:function(n){t=h.reject(t,function(e){return e.name===n}),delete e.Pipelines[n]},length:function(){return t.length}}}();R.Pipeline=function(e){var t={name:e,processors:[],add:function(e){if(!(e&&e.priority&&e.execute&&h.isNumber(e.priority)&&h.isFunction(e.execute)))throw"not valid step";this.processors.push(e)},length:function(){return this.processors.length},remove:function(e){this.processors=h.reject(this.processors,function(t){return t===e})},execute:function(e){var t=h.sortBy(this.processors,function(e){return e.priority});h.each(t,function(t){return e.aborted?!1:(t.execute(e),void 0)})}};return t};var P=function(e,t){var n=e.split("."),i=n[0];if("this"===i)Function(e).call(t.control.model);else if(t.app&&"app"===i){var r=e.replace("app","this");Function(r).call(t.app)}else Function(e)()},F={priority:1e3,execute:function(e){"javascript"===e.handler&&(e.target.indexOf(";")>0?h.each(e.target.split(";"),function(t){P(t,e)}):P(e.target,e))}},H={priority:2e3,execute:function(t){"command"===t.handler&&e.Commands.executeCommand(t.target)}},L={priority:3e3,execute:function(t){if("serverclick"===t.handler){var n={url:t.target,type:"POST",dataType:"json"},i=function(n){e.Pipelines.ServerInvoke.execute({data:n,model:t.model})};f.ajax(n).done(i)}}},W={priority:4e3,execute:function(e){if("trigger"===e.handler){var t=e.app;if(!t)throw"An application is a required when triggering events";var n=e.target,i={},r=n.indexOf("(");if(r>=0){if(-1==n.indexOf(")",n.length-1))throw"Missing ')'";var a=n.substr(r+1,n.length-r-2);i=f.parseJSON(a),n=n.substr(0,r)}i.sender=e.control,t.trigger(n,i)}}},z={priority:1e3,execute:function(e){var t=e.data.ViewModel;null!=t&&p.mapping.fromJS(t,{},e.model)}},q=new e.Pipelines.Pipeline("Invoke");q.add(F),q.add(H),q.add(L),q.add(W),e.Pipelines.add(q);var J=new e.Pipelines.Pipeline("ServerInvoke");J.add(z),e.Pipelines.add(J);var Q=new R.Pipeline("Application"),K=function(){return{}},G=function(e,t,n,i,r,a,o,s,u){var l,c,d,p,m,g=f(t);if(u){var v=g.find("[data-sc-app]");v.length>0&&f.each(v,function(){f(this).addClass("data-sc-waiting")})}if(!g.data("sc-app")){l=h.uniqueId("sc_"+e.type+"_"),c=g.attr("data-sc-id"),o.appId&&(c=o.appId+":"+c);var y=h.filter(g.prop("class").split(" "),function(e){return-1===e.indexOf("sc_")});if(g.prop("class",y.join(" ")),g.addClass(l),i&&f("[data-sc-exclude] ."+l).length)return{};if(r&&g.closest("[data-sc-app]").attr("id")&&"#"+g.closest("[data-sc-app]").attr("id")!=a)return{};d=new e.model({type:l,name:c}),d.componentName=e.type,g.data("sc-app",n),g.addClass("data-sc-registered"),e.collection&&(p=new e.collection);var b=g.data("sc-behaviors");if(m=new e.view({el:"."+l,model:d,collection:p,app:o,behaviors:b}),h.each(m.$el.find("[data-bind]"),function(e){var t=f(e);0==t.closest(".data-sc-waiting").length&&t.addClass("data-sc-registered")},this),m.$el.find("*").contents().each(function(){try{this.registered=8===this.nodeType?!0:!1}catch(e){}}),o[c]=d,p&&h.extend(o[c],K(p,e.collection.prototype.defaults)),s.Controls.push({name:c,model:d,view:m,collection:p}),u){var w=g.find(".data-sc-waiting");w.each(function(){f(this).removeClass("data-sc-waiting")})}}return o},Y=function(e,t){return e||(t="body",e="app"),t||(t=e),"body"!==t&&0>t.indexOf("#")&&(t="#"+t),{name:e,el:t,$el:f(t)}},X=function(e,t){0===e.find("[data-sc-hasnested]").length?t(e):(h.each(e.find("[data-sc-hasnested]"),function(e){X(f(e),t)}),t(e))},Z={priority:1e3,execute:function(n){n=n||{};var i=n.name,r=n.id,a=n.mainApp,o=n.app,s=Y(i,r),u=f(s.$el).find("[data-sc-exclude]"),c=u.length||!1,d=f(s.$el).find("[data-sc-app]").length||!1,p=[];if(n.Controls=[],o=o||new e.Definitions.App,a||(a=e),a[s.name])throw"already an app with this name";o.ScopedEl=s.$el,o.name=s.name,t.Components&&t.Components.length>0&&h.each(t.Components,function(e){f(s.$el).find(e.el+":not(.data-sc-registered)").each(function(){f(this).data("sc-hasnested")?p.push(e):G(e,this,s.name,c,d,s.$el.selector,o,n)})}),p.length>0&&h.each(p,function(e){f(s.$el).find(e.el+":not(.data-sc-registered)").each(function(){var e=f(this);X(e,function(e){var t=h.find(p,function(t){return e.is(t.el)});G(t,e.get(0),s.name,c,d,s.$el.selector,o,n,!0)})})}),h.each(n.Controls,function(e){if(e.view.listen){var t=h.keys(e.view.listen);h.each(t,function(t){var n=t;if(n.indexOf(":$this")>=0){var i=e.view.$el.attr("data-sc-id");if(!i)return;n=n.replace("$this",i)}o.on(n,e.view[e.view.listen[t]],e.view)})}}),a===e?a[s.name]=l?o:"application":(a[s.name]=o,a.nested=a.nested||[],a.nested.push(o)),o.Controls=n.Controls,s.$el.find("[data-sc-app]").each(function(){var e=f(this),n=e.attr("data-sc-app"),i=e.attr("data-sc-require");i?require(i.split(","),function(e){var t=new e;t.run(n,n,o)}):t.Factories.createApp({name:n,id:n,mainApp:o,aborted:!1})}),n.current=o}},et=function(e){var n=t.BindingConverters[e];return n?n:void 0},tt=function(e){if(e.converter){var t=[];return h.each(e.from,function(e){t.push(e.model.get(e.attribute))}),e.converter(t)}var n=e.from[0].model,i=e.from[0].attribute;return n.get(i)},nt=function(e){h.each(e.from,function(t){t.model.on("change:"+t.attribute,function(){e.model.set(e.to,tt(e))})}),e.model.set(e.to,tt(e))},it=function(e,t){var n=h.keys(e.attributes),i=h.find(n,function(e){return e===t});return i?t:t.charAt(0).toLowerCase()+t.slice(1)},rt=function(e,t){var n=h.keys(e),i=h.find(n,function(e){return e===t});return i?e[t]:e[t.charAt(0).toUpperCase()+t.slice(1)]},at=function(e,t,n){var i=n,r=e.attr("data-sc-bindings"),a=[],o=t[i];if(0!=r.indexOf("{")){var s=[];h.each(r.split(","),function(e){var t=[];h.each(e.split(":"),function(e){t.push('"'+e+'"')}),s.push(t.join(":"))}),r="{"+s.join(",")+"}"}try{var u=JSON.parse(r);h.each(h.keys(u),function(e){var n,i,r={from:[],to:e,converter:void 0,model:o},s=u[e];r.to=it(o,e),h.isObject(s)?(r.converter=et(s.converter),h.each(s.parameters,function(e){n=rt(t,e.split(".")[0]),i=it(n,e.split(".")[1]),r.from.push({model:n,attribute:i})})):(n=t[s.split(".")[0]],i=it(n,s.split(".")[1]),r.from.push({model:n,attribute:i})),a.push(r)}),h.each(a,nt)}catch(l){throw"Failed to data-bind: "+n+"\n"+l}},ot={priority:1500,execute:function(e){0!==e.current.Controls.length&&h.each(e.current.Controls,function(t){t.view.$el.attr("data-sc-bindings")&&at(t.view.$el,e.current,t.view.$el.attr("data-sc-id"))})}},st={priority:2e3,execute:function(e){h.each(e.Controls,function(e){e.view.beforeRender&&e.view.beforeRender()})}},ut={priority:3e3,execute:function(e){h.each(e.Controls,function(e){e.view.render&&e.view.render()})}},lt={priority:4e3,execute:function(e){h.each(e.Controls,function(e){e.view.afterRender&&e.view.afterRender()})}};Q.add(Z),Q.add(ot),Q.add(st),Q.add(ut),Q.add(lt),e.Pipelines.add(Q),h.extend(t.Web,{itemWebApi:{takeValidScope:function(e){switch(e){case"self":return"s";case"children":return"c";case"parent":return"p";default:throw"Unsupported scope. It must be either 'self', 'children' or 'parent'"}},addScope:function(e,n){if(n&&h.isArray(n)){var i=h.compact(h.map(n,t.Web.itemWebApi.takeValidScope)).join("|");e=t.Helpers.url.addQueryParameters(e,{scope:i})}return e},addDatabase:function(e,n){return n&&h.isString(n)&&(e=t.Helpers.url.addQueryParameters(e,{sc_database:n})),e},addContentDatabase:function(e,n){return n&&h.isString(n)&&(e=t.Helpers.url.addQueryParameters(e,{sc_content:n})),e},addItemSelectorUrlPortion:function(n,i,r){return i&&h.isString(i)&&(r&&r.facetsRootItemId&&(n=t.Helpers.url.addQueryParameters(n,{facetsRootItemId:r.facetsRootItemId})),0===i.indexOf("search:")?(n=t.Helpers.url.addQueryParameters(n,{search:i.substr("search:".length)}),r&&r.root&&e.Helpers.id.isId(r.root)&&(n=t.Helpers.url.addQueryParameters(n,{root:r.root})),r&&r.searchConfig&&(n=t.Helpers.url.addQueryParameters(n,{searchConfig:r.searchConfig}))):n=0===i.indexOf("query:")?t.Helpers.url.addQueryParameters(n,{query:i.substr("query:".length)}):t.Helpers.id.isId(i)?t.Helpers.url.addQueryParameters(n,{sc_itemid:i}):t.Helpers.url.combine(n,i)),n},addLanguage:function(e,n){return n&&(e=t.Helpers.url.addQueryParameters(e,{language:n})),e},addItemVersion:function(e,n){return n&&(e=t.Helpers.url.addQueryParameters(e,{sc_itemversion:n})),e},getUrl:function(e,n){n=n||{};var i="/-/item/v1",r="";n.webApi&&(i=n.webApi),n.virtualFolder&&(r=n.virtualFolder);var a=t.Helpers.url.combine(i,r);return a=this.addItemSelectorUrlPortion(a,e,n),n.scope&&(a=this.addScope(a,n.scope)),n.database&&""!=e&&0===e.indexOf("search:")?a=this.addContentDatabase(a,n.database):n.database&&(a=this.addDatabase(a,n.database)),n.language&&(a=this.addLanguage(a,n.language)),n.version&&(a=this.addItemVersion(a,n.version)),n.payLoad&&(a=t.Helpers.url.addQueryParameters(a,{payload:"full"})),n.formatting&&(a=t.Helpers.url.addQueryParameters(a,{format:n.formatting})),n.sorting&&(a=t.Helpers.url.addQueryParameters(a,{sorting:n.sorting})),n.showHiddenItems&&(a=t.Helpers.url.addQueryParameters(a,{showHiddenItems:n.showHiddenItems})),n.fields&&(a=t.Helpers.url.addQueryParameters(a,{fields:n.fields.join("|")})),n.pageSize&&n.pageSize>0&&(a=t.Helpers.url.addQueryParameters(a,{pageIndex:n.pageIndex,pageSize:n.pageSize})),a}}}),function(t){var n,i=t.Backbone,r=t._,a=t.$,o=i.View.prototype._configure;i.View.prototype.render;var s=Array.prototype.push,u=Array.prototype.concat,l=Array.prototype.splice,c=e.Definitions.Views.View.extend({constructor:function(e){e=e||{},c.setupView(this,e),i.View.call(this,e)},nestedlayout:!0,insertView:function(e,t){return t?this.setView(e,t,!0):this.setView(e,!0)},insertViews:function(e){return r.isArray(e)?this.setViews({"":e}):(r.each(e,function(t,n){e[n]=r.isArray(t)?t:[t]}),this.setViews(e))},getView:function(e){return this.getViews(e).first().value()},getViews:function(e){var t=r.chain(this.views).map(function(e){return r.isArray(e)?e:[e]},this).flatten().value();return"string"==typeof e?r.chain([this.views[e]]).flatten():r.chain("function"==typeof e?r.filter(t,e):t)},setView:function(e,t,n){var i,a,o,s=this;if("string"!=typeof e&&(n=t,t=e,e=""),this.views=this.views||{},i=t.__manager__,a=this.views[e],!i)throw Error("Please set `View#manage` property with selector '"+e+"' to `true`.");return o=t._options(),i.parent=s,i.selector=e,n?(this.views[e]=u.call([],a||[],t),i.append=!0,t):(i.hasRendered&&o.partial(s.el,i.selector,t.el,i.append),a&&r.each(u.call([],a),function(e){e.remove()}),this.views[e]=t)},setViews:function(e){return r.each(e,function(e,t){return r.isArray(e)?r.each(e,function(e){this.insertView(t,e)},this):(this.setView(t,e),void 0)},this),this},render:function(){function e(){function e(){var e=i.afterRender;e&&e.call(n,n),n.trigger("afterRender",n)}var t,r;return o&&(i.contains(o.el,n.el)||i.partial(o.el,a.selector,n.el,a.append)),n.delegateEvents(),a.hasRendered=!0,l.resolveWith(n,[n]),(t=a.queue.shift())?t():delete a.queue,u&&u.queue?(r=function(){o.off("afterRender",r,this),e()},o.on("afterRender",r,n)):(e(),void 0)}function t(){var t=n._options(),i=n.__manager__,a=i.parent;a&&a.__manager__,n._render(c._viewRender,t).done(function(){if(!r.keys(n.views).length)return e();var i=r.map(n.views,function(e){var n=r.isArray(e);return n&&e.length?e[0].render().pipe(function(){return t.when(r.map(e.slice(1),function(e){return e.render()}))}):n?e:e.render()});t.when(i).done(function(){e()})})}var n=this,i=n._options(),a=n.__manager__,o=a.parent,u=o&&o.__manager__,l=i.deferred();return a.queue?s.call(a.queue,function(){t()}):(a.queue=[],t(n,l)),l.view=n,l},remove:function(){return c._removeView(this,!0),this._remove.apply(this,arguments)},_options:function(){return c.augment({},this,c.prototype.options,this.options)}},{_cache:{},_makeAsync:function(e,t){var n=e.deferred();return n.async=function(){return n._isAsync=!0,t},n},_viewRender:function(e,t){function n(n){n&&t.html(e.$el,n),s.resolveWith(e,[e])}function i(e,i){var r,o=c._makeAsync(t,function(e){n(e)});c.cache(a,i),i&&(r=t.render.call(o,i,e)),o._isAsync||n(r)}var a,o,s;return e.__manager__,{render:function(){var n=e.serialize||t.serialize,u=e.data||t.data,l=n||u,d=e.template||t.template,f="";return e.parent&&e.parent.$el&&(f=e.parent.$el.data("sc-id")),r.isFunction(l)&&(l=l.call(e)),s=c._makeAsync(t,function(e){i(l,e)}),"string"==typeof d&&(a=t.prefix+d),(o=c.cache(a+f))?(i(l,o,a),s):("string"==typeof d?o=t.fetch.call(s,t.prefix+d,f):null!=d&&(o=t.fetch.call(s,d)),s._isAsync||i(l,o),s)}}},_removeViews:function(e,t){"boolean"==typeof e&&(t=e,e=this),e=e||this,e.getViews().each(function(e){(e.__manager__.hasRendered||t)&&c._removeView(e,t)})},_removeView:function(e,t){var n,i=e.__manager__,a="boolean"==typeof e.keep?e.keep:e.options.keep;if(!a&&(i.append===!0||t)){if(c.cleanViews(e),e._removeViews(!0),e.$el.remove(),!i.parent)return;if(n=i.parent.views[i.selector],r.isArray(n))return r.each(r.clone(n),function(e,t){e&&e.__manager__===i&&l.call(n,t,1)});delete i.parent.views[i.selector]}},cleanViews:function(e){r.each(u.call([],e),function(e){e.unbind(),e.model instanceof i.Model&&e.model.off(null,null,e),e.collection instanceof i.Collection&&e.collection.off(null,null,e),e.cleanup&&e.cleanup.call(e)})},cache:function(e,t){return e in this._cache?this._cache[e]:null!=e&&null!=t?this._cache[e]=t:void 0},configure:function(e){this.augment(c.prototype.options,e),e.manage&&(i.View.prototype.manage=!0)},augment:r.forIn?function(e){return r.reduce(Array.prototype.slice.call(arguments,1),function(e,t){return r.forIn(t,function(t,n){e[n]=t}),e},e)}:r.extend,setupView:function(e,t){if(!e.__manager__){var a,o,s,l=i.LayoutManager.prototype,d=r.pick(e,n);r.defaults(e,{views:{},__manager__:{},_removeViews:c._removeViews,_removeView:c._removeView},c.prototype),t=e.options=r.defaults(t||{},e.options,l.options),s=r.pick(t,u.call(["events"],r.values(t.events||{}))),c.augment(e,s),(d.render===c.prototype.render||d.render===i.View.prototype.render)&&delete d.render,c.augment(t,d),e._remove=i.View.prototype.remove,e._render=function(e,t){var n=this,i=n.__manager__,r=t.beforeRender;return i.hasRendered&&this._removeViews(),r&&r.call(this,this),this.trigger("beforeRender",this),e(this,t).render()},e.render=c.prototype.render,e.remove!==l.remove&&(e._remove=e.remove,e.remove=l.remove),a=t.views||e.views,r.keys(a).length&&(o=a,e.views={},e.setViews(o)),e.options.template?e.options.template=t.template:e.template&&(t.template=e.template,delete e.template)}}});e.Definitions.Views.CompositeView=i.Layout=i.LayoutView=i.LayoutManager=c,c.VERSION="0.7.5",i.View.prototype._configure=function(){var e=o.apply(this,arguments);return this.manage&&c.setupView(this),e},c.prototype.options={prefix:"",deferred:function(){return a.Deferred()},fetch:function(e){return r.template(a(e).html())},partial:function(e,t,n,i){var r=t?a(e).find(t):a(e);this[i?"append":"html"](r,n)},html:function(e,t){e.html(t)},append:function(e,t){e.append(t)},when:function(e){return a.when.apply(null,e)},render:function(e,t){return e(t)},contains:function(e,t){return a.contains(e,t)}},n=r.keys(c.prototype.options),c.prototype.options=r.extend(c.prototype.options,{fetch:function(e,t){var n="[data-layout-"+e+"]";t&&(n="[data-layout-"+e+"='"+t+"']");var i=a(n).html();if(void 0===i)throw"missing template data-layout-"+e+" in order to work";return r.template(i)}})}(this),r.DatabaseUri=function(e){if(!e)throw"Parameter 'databaseName' is null or empty";this.databaseName=e,this.webApi="",this.virtualFolder="/sitecore/shell"},h.extend(r.DatabaseUri.prototype,{getDatabaseName:function(){return this.databaseName}}),r.ItemUri=function(e,t){if(!e)throw"Parameter 'databaseUri' is null or empty";if(!t)throw"Parameter 'itemId' is null or empty";this.databaseUri=e,this.itemId=t},h.extend(r.ItemUri.prototype,{getDatabaseName:function(){return this.databaseUri.databaseName},getDatabaseUri:function(){return this.databaseUri},getItemId:function(){return this.itemId}}),r.ItemVersionUri=function(e,t,n){if(!e)throw"Parameter 'itemUri' is null";if(!t)throw"Parameter 'language' is null or empty";if(!h.isNumber(n))throw"Parameter 'version' is null or not a number";this.itemUri=e,this.language=t,this.version=n},h.extend(r.ItemVersionUri.prototype,{getDatabaseUri:function(){return this.itemUri.getDatabaseUri()},getDatabaseName:function(){return this.itemUri.getDatabaseName()},getItemUri:function(){return this.itemUri},getItemId:function(){return this.itemUri.getItemId()},getLanguage:function(){return this.language},getVersion:function(){return this.version}}),r.FieldUri=function(e,t){if(!e)throw"Parameter 'itemVersionUri' is null or empty";if(!t)throw"Parameter 'fieldId' is null or empty";this.itemVersionUri=e,this.fieldId=t},h.extend(r.FieldUri.prototype,{getDatabaseUri:function(){return this.itemVersionUri.getDatabaseUri()},getDatabaseName:function(){return this.itemVersionUri.getDatabaseName()},getItemUri:function(){return this.itemVersionUri.getItemUri()},getItemId:function(){return this.itemVersionUri.getItemId()},getLanguage:function(){return this.itemVersionUri.getLanguage()},getVersion:function(){return this.itemVersionUri.getVersion()},getFieldId:function(){return this.fieldId}}),r.Database=function(e){if(!e)throw"Parameter 'databaseUri' is null";this.databaseUri=e,this.ajaxOptions={dataType:"json"}},h.extend(r.Database.prototype,{convertToItem:function(e){return e.result?e.result.items?0===e.result.items.length?null:e.result.items.length>1?(console.debug("ERROR: Expected a single item"),null):new t.Definitions.Data.Item(e.result.items[0]):(console.debug("ERROR: No items from server"),null):(console.debug("ERROR: No data from server"),null)},convertToItems:function(e){if(!e.result)return console.debug("ERROR: No data from server"),{items:[],totalCount:0,data:e};if(!e.result.items)return console.debug("ERROR: No items from server"),{items:[],totalCount:0,data:e};var n=h.map(e.result.items,function(e){return new t.Definitions.Data.Item(e)
});return{items:n,total:e.result.totalCount,data:e.result}},getItem:function(e,n,i){if(!e)throw"Parameter 'id' is null";if(!n)throw"Parameter 'completed' is null";i=i||{},e instanceof t.Definitions.Data.ItemUri&&(i.database=e.getDatabaseName(),e=e.getItemId()),e instanceof t.Definitions.Data.ItemVersionUri&&(i.database=e.getDatabaseName(),i.language=e.getLanguage(),i.version=e.getVersion(),e=e.getItemId());var r=this.getUrl(e,i);this.get(r).pipe(this.convertToItem).done(n).fail(function(e){n(null,e)})},search:function(e,t,n){if(!t)throw"Parameter 'completed' is null";var i=this.getUrl("search:"+e,n);this.get(i).pipe(this.convertToItems).done(function(e){t(e.items,e.total,e.data)}).fail(function(e){t([],0,e)})},query:function(e,t,n){if(!e)throw"Parameter 'queryExpression' is null";if(!t)throw"Parameter 'completed' is null";var i=this.getUrl("query:"+e,n);this.get(i).pipe(this.convertToItems).done(function(e){t(e.items,e.total,e.data)}).fail(function(e){t([],0,e)})},getChildren:function(e,t,n){if(!e)throw"Parameter 'id' is null";if(!t)throw"Parameter 'completed' is null";n=n||{},n.scope||(n.scope=["children"]);var i=this.getUrl(e,n);this.get(i).pipe(this.convertToItems).done(function(e){t(e.items,e.total,e.data)}).fail(function(e){t([],0,e)})},getUrl:function(t,n){n=n||{},n.database||(n.database=this.databaseUri.getDatabaseName()),n.webApi||(n.webApi=this.databaseUri.webApi),n.virtualFolder||(n.virtualFolder=this.databaseUri.virtualFolder);var i=e.Web.itemWebApi.getUrl(t,n);return i},get:function(e){return f.ajax({url:e,dataType:this.ajaxOptions.dataType})}}),r.Field=function(e,t,n,i,a){if(!e)throw"Parameter 'item' is null";if(!(t instanceof r.FieldUri))throw"Parameter 'fieldUri' is null";this.item=e,this.fieldUri=t,this.fieldName=n||"",this.value=i||"",this.type=a||"Single-Line Text"},h.extend(r.Field.prototype,{toModel:function(){return this.$model||(this.$model=new t.Definitions.Models.Model(this)),this.$model},toViewModel:function(){var e={fieldId:this.fieldUri.getFieldId(),fieldName:this.fieldName,type:this.type,value:new p.observable(this.value)},t=this;return e.value.subscribe(function(e){t.item[t.fieldName]=e,t.value=e}),e}}),r.LocalStorage=function(e){if(!e)throw"you need to provide a unique key";this.appID=e,this.fullKey=this.prefix+this.appID,this.localStorageLibrary=f.jStorage},h.extend(r.LocalStorage.prototype,{prefix:"#sc#",get:function(e){var t=this.fullKey+e;return this.localStorageLibrary.get(t)},getAll:function(){var e,t=this.localStorageLibrary.index(),n={};return e=h.filter(t,function(e){return e.indexOf(this.fullKey)>=0},this),h.each(e,function(e){var t=e.substring(this.fullKey.length,e.length);n[t]=this.localStorageLibrary.get(e)},this),n},deleteRecord:function(e){var t=this.fullKey+e;return this.localStorageLibrary.deleteKey(t)},set:function(e,t,n){var i=this.fullKey+e;return this.localStorageLibrary.set(i,t,n)},flush:function(){var e=this.localStorageLibrary.index(),t=h.filter(e,function(e){return e.indexOf(this.fullKey)>=0},this);h.each(t,function(e){this.localStorageLibrary.deleteKey(e)},this)}});var ct={options:function(e,t){return{dataType:"json",type:e,data:t}},convertResponse:function(e){return 200!==e.statusCode?f.Deferred().reject({readyState:4,status:e.statusCode,responseText:e.error.message}):e.result},createItem:function(e){return new t.Definitions.Data.Item(e.items[0])},triggerCreated:function(e){return t.trigger("item:created",e),e}},dt=function(e,n,i){var r=e;if(!e.name||!e.templateId||!e.parentId)throw"Provide valid parameter in order to create an Item";e.database||(e.database="core");var a=t.Web.itemWebApi.getUrl(r.parentId,{webApi:"/-/item/v1/sitecore/shell",database:e.database});return a=t.Helpers.url.addQueryParameters(a,{name:e.name}),a=t.Helpers.url.addQueryParameters(a,{template:e.templateId}),f.when(f.ajax(a,ct.options("POST",n))).pipe(ct.convertResponse).pipe(ct.createItem).pipe(ct.triggerCreated).done(i)},ft=function(e,n){var i;this.$fields?i=h.map(this.$fields,function(e){return{name:e.fieldName,value:this[e.fieldName]}},this):(i=h.map(this.attributes.$fields,function(e){var t;return this.attributes[e.fieldName]!==e.value?t={name:e.fieldName,value:this.attributes[e.fieldName]}:void 0},this),i=h.filter(i,function(e){return void 0!==e}));var r=this.getUrl(),a={dataType:"json",type:"PUT",data:i},o=function(e){return t.trigger("item:updated",this),e};return f.when(f.ajax(r,a)).pipe(this.convertResponse).pipe(o).done(f.proxy(e,n))},ht=function(t,n){var i=this.getUrl(),r={dataType:"json",type:"GET"},a=function(t){if(!t.items)return this;if(0===t.items.length)throw"Item not found";if(date.items.length>1)throw"Expected a single item";var n=t.items[0];return h.each(n.Fields,function(t,n){this[t.Name]=t.Value;var i=this.getFieldById(n);null!=i?i.value=t.Value:this.$fields.push(this,new e.Definitions.Data.Field(fieldUri,t.Name,t.Value,t.Type))},this),this};return f.when(f.ajax(i,r)).pipe(this.convertResponse).pipe(a).done(f.proxy(t,n))},N=function(e,n){var i=this.getUrl(),r={dataType:"json",type:"DELETE"},a=function(e){return t.trigger("item:deleted",this),e};return f.when(f.ajax(i,r)).pipe(this.convertResponse).pipe(a).done(f.proxy(e,n))},pt=function(e,n,i){var r=[{name:"__itemName",value:e}],a=this.getUrl(),o={dataType:"json",type:"PUT",data:r},s=function(e){return t.trigger("item:renamed",this),e};return f.when(f.ajax(a,o)).pipe(this.convertResponse).pipe(s).done(f.proxy(n,i))};r.createItem=dt;var mt=function(e,t,n){var i=this;n=n||{};var r=n.success||function(){t&&t(i)};switch(e){case"read":this.read(this).pipe(r);break;case"create":throw"The 'create' operation is not supported";case"update":this.update(this,n).pipe(r);break;case"delete":this.remove(this).pipe(r)}},gt=e.Definitions.Models.Model.extend({idAttribute:"itemId",getUrl:function(){var e=this.get("itemUri"),t=new r.Database(e.getDatabaseUri());return t.getUrl(e.getItemId())},read:ht,remove:N,rename:pt,update:ft});if(r.Item=function(e,t){if(!t)if(t=e,t.itemUri)e=t.itemUri;else{var n=new r.DatabaseUri(t.Database);e=new r.ItemUri(n,t.ID)}return t instanceof r.Item?(this.shallowCopy(t),void 0):(this.$fields=[],h.each(t.Fields,function(t,n){this[t.Name]=t.Value;var i=new r.FieldUri(e,n),a=new r.Field(this,i,t.Name,t.Value,t.Type);t.FormattedValue&&(a.formattedValue=t.FormattedValue),t.LongDateValue&&(a.longDateValue=t.LongDateValue),t.ShortDateValue&&(a.shortDateValue=t.ShortDateValue),this.$fields.push(a)},this),this.itemUri=e,this.itemId=e.getItemId(),this.itemName=t.Name||"",this.$displayName=t.DisplayName||"",this.$database=t.Database||"",this.$language=t.Language||"",this.$version=t.Version||0,this.$templateName=t.TemplateName||"",this.$templateId=t.TemplateId||"",this.$hasChildren=t.HasChildren||!1,this.$path=t.Path||"",this.$url=t.Url||"",this.$mediaurl=t.MediaUrl||"",this.$icon=t.Icon||"",void 0)},h.extend(r.Item.prototype,{getFieldById:function(e){return h.find(this.$fields,function(t){return t.fieldUri.getFieldId()==e},this)},shallowCopy:function(e){this.$fields=e.$fields,h.each(e.$fields,function(e){this[e.Name]=e.Value},this),this.itemUri=e.itemUri,this.itemId=e.itemId,this.itemName=e.itemName,this.$displayName=e.$displayName,this.$language=e.$language,this.$version=e.$version,this.$templateName=e.$templateName,this.$templateId=e.$templateId,this.$hasChildren=e.$hasChildren,this.$path=e.$path,this.$url=e.$url,this.$mediaurl=e.$mediaurl},toModel:function(){if(!this.$model){var e=new gt(this);return e.sync=mt,e}return this.$model},toViewModel:function(){return this.toModel().viewModel},convertResponse:ct.convertResponse}),h.extend(t.Factories,{createJQueryUIComponent:function(e,t,n){var i=e.ControlModel.extend({initialize:function(){this._super(),n.model&&h.each(h.keys(n.model),function(e){this.model[e]=n.model[e]},this),h.each(n.attributes,function(e){var t=void 0!==e.defaultValue?e.defaultValue:null;this.set(e.name,t)},this),void 0!==this.initialized&&this.initialized()}}),r=t.ControlView.extend({initialize:function(e){this._super();var t;e=e||{},n.view&&h.each(h.keys(n.view),function(e){this[e]=n.view[e]},this),h.each(n.attributes,function(n){var i=void 0!==n.defaultValue?n.defaultValue:null;void 0!==i&&null!==i&&(t=void 0!==n.pluginProperty?n.pluginProperty:n.name,e[t]=i);var r=this.$el.attr("data-sc-option-"+t);r&&("true"==r&&(r=!0),"false"==r&&(r=!1),this.model.set(n.name,r),t=void 0!==n.pluginProperty?n.pluginProperty:n.name,e[t]=r)},this),h.each(n.events,function(t){if(void 0===e[t.name]){var n=this;e[t.name]=function(e,i){n.raiseEvent(t,e,i)}}},this),this.$el[n.control](e),this.widget=this.$el[n.control],this.widget=this.widget||this.$el.data(n.control),this.widget=this.widget||this.$el.data(n.namespace+n.control),h.each(n.functions,function(e){var t=this;this[e.name]=function(){if(!t.widget[e.name]){var n=t.widget;return n.apply(t.$el,[e.name,arguments[0]])}return t.widget[e.name].apply(t.widget,arguments)}},this),this.model.on("change",function(e){var t,i,r={};e.changed&&(h.each(h.keys(e.changed),function(a){h.find(n.attributes,function(e){return e.name==a&&1==e.added})||(i=h.find(n.attributes,function(e){return e.name==a}),t=i&&void 0!==i.pluginProperty?i.pluginProperty:a,r[t]=e.get(a))}),this.$el[n.control]("option",r))},this),void 0!==this.initialized&&this.initialized()},raiseEvent:function(e,t,n){e.on&&this[e.on](t,n);var i=this.$el.attr("data-sc-id"),r=this.app[i];r&&void 0!==r[e.name]&&r[e.name](r,t,n),i&&this.app.trigger(e.name+":"+i,t,n)}});o.createComponent(n.componentName,i,r,n.selector)}}),l){var vt=0,yt=0,bt=0,wt=[],_t=function(e){var t=0,n=[],i=0;for(var r in e)if(e[r]&&"application"===e[r].modelType){var e=e[r];bt+=1,t+=1,h.each(e.Controls,function(e){yt+=1,i+=1,wt.push(e)}),n.push(_t(e[r]))}return{numberOfNestedApp:vt,nestedApps:n,nbControlInThisApp:i}},xt=function(){var t=_t(e);return{numberOfApps:vt,totalNumberOfControls:yt,totlaNumberOfApp:bt,alltheControls:wt,allApplications:t}};t.__info=function(){return{Components:{totalComponents:e.Components.length,compontentList:e.Components},Pipelines:{totalPipelines:e.Pipelines.length()},Applications:xt()}}}}.call(window);