@using Sitecore
@using Sitecore.EmailCampaign.Controls.D3.Helpers
@using Sitecore.Modules.EmailCampaign.Core
@using Sitecore.Mvc
@using Sitecore.Mvc.Presentation
@using Sitecore.Web.UI.Controls.Common.UserControls
@model RenderingModel

@{
  var userControl = Html.Sitecore().Controls().GetUserControl(Model.Rendering);
  userControl.Class = "sc-d3-doughnutchart";
  userControl.Requires.Script("/sitecore/shell/client/Applications/ECM/EmailCampaign.Controls/D3/Layouts/Renderings/Charts/DoughnutChart/DoughnutChart.js");
  ChartHelper.SetAttributes(userControl, "DoughnutChart");

  var htmlAttributes = userControl.HtmlAttributes;
  var height = ChartHelper.GetHeight(userControl.GetString("Height"));
  var title = userControl.GetString("Title");
  var noDataToDisplay = ClientHost.Globalization.Translate(EcmTexts.NoDataToDisplay);
}

<div @htmlAttributes style="height: @height;">
    @{
        if (title.Length > 0)
        {
            <div class="chart-title sc-text x-large">@title</div>
        }
    }
    <div class="sc-d3-nodata-panel">@noDataToDisplay</div>
    <div class="svg-wrapper">
        <svg class="sc-d3-chart-canvas" id="svg-@userControl.ControlId"></svg>

        <svg class="sc-d3-chart-legend" id="svg-legend-@userControl.ControlId">
            <g class="nv-legendWrap nvd3-svg" transform="translate(0,0)">
                <g class="nvd3 nv-legend" transform="translate(0,0)"></g>
            </g>
        </svg>
    </div>
</div>

