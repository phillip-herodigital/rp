@using Sitecore.Mvc
@using EmailCampaign.Controls
@using Sitecore.Web.UI.Controls.Common.Renderings
@using Sitecore.Web.UI.Controls.Common.UserControls
@using UserControl = Sitecore.Web.UI.Controls.Common.UserControls.UserControl
@using Bcl = EmailCampaign.Controls.Constants.Renderings.Bcl
@using Exm = EmailCampaign.Controls.Constants.Renderings.Exm
@using BaseDataSources = EmailCampaign.Controls.Reporting.TechnologyReport.DataSources
@using DataSources = EmailCampaign.Controls.Reporting.TechnologyReportExtended.DataSources;
@model Sitecore.Mvc.Presentation.RenderingModel
@{
    UserControl rendering = Html.Sitecore().Controls().GetUserControl(Model.Rendering);
    rendering.Requires.Script("ecm", "TechnologyReportExtended.js");
    rendering.Requires.Css("ecm", "TechnologyReportExtended.css");
    rendering.Class = "sc-TechnologyReportExtended";
    string bottomLink = rendering.GetString("BottomLink");
    string height = rendering.GetString("Height");
}

@helper RenderTechnologyReportExtended(UserControl rendering)
{
    RenderingHelper helper = new RenderingHelper(this.Html, rendering.ControlId);

    helper.CreateRenderingAt(Bcl.Tabs, "Tabs", rendering.ControlId + "Card", null, BaseDataSources.Tabs, "Wrapper.Content");

    // Information browser board

    helper.CreateRenderingAt(Bcl.ScoreCard, "BrowserOpenRateScoreCard", rendering.ControlId + "BrowserLeftInfoBoardColumnTop", null, DataSources.OpenRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "BrowserMostValuableScoreCard", rendering.ControlId + "BrowserRightInfoBoardColumnTop", null, DataSources.MostValuableScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "BrowserClickRateScoreCard", rendering.ControlId + "BrowserLeftInfoBoardColumnBottom", null, DataSources.ClickRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "BrowserValuePerVisitScoreCard", rendering.ControlId + "BrowserRightInfoBoardColumnBottom", null, DataSources.ValuePerVisitScoreCard);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserLeftInfoBoardColumnBottom", rendering.ControlId + "BrowserInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserRightInfoBoardColumnBottom", rendering.ControlId + "BrowserInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserLeftInfoBoardColumnTop", rendering.ControlId + "BrowserInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserRightInfoBoardColumnTop", rendering.ControlId + "BrowserInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "BrowserInfoBoardRowPanelTop", rendering.ControlId + "BrowserRightMainColumn");

    helper.CreateRenderingAt(Bcl.RowPanel, "BrowserInfoBoardRowPanelBottom", rendering.ControlId + "BrowserRightMainColumn");

    // Information os board

    helper.CreateRenderingAt(Bcl.ScoreCard, "OsOpenRateScoreCard", rendering.ControlId + "OsLeftInfoBoardColumnTop", null, DataSources.OpenRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "OsMostValuableScoreCard", rendering.ControlId + "OsRightInfoBoardColumnTop", null, DataSources.MostValuableScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "OsClickRateScoreCard", rendering.ControlId + "OsLeftInfoBoardColumnBottom", null, DataSources.ClickRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "OsValuePerVisitScoreCard", rendering.ControlId + "OsRightInfoBoardColumnBottom", null, DataSources.ValuePerVisitScoreCard);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsLeftInfoBoardColumnBottom", rendering.ControlId + "OsInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsRightInfoBoardColumnBottom", rendering.ControlId + "OsInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsLeftInfoBoardColumnTop", rendering.ControlId + "OsInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsRightInfoBoardColumnTop", rendering.ControlId + "OsInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "OsInfoBoardRowPanelTop", rendering.ControlId + "OsRightMainColumn");

    helper.CreateRenderingAt(Bcl.RowPanel, "OsInfoBoardRowPanelBottom", rendering.ControlId + "OsRightMainColumn");
    
    // Information device board

    helper.CreateRenderingAt(Bcl.ScoreCard, "DeviceOpenRateScoreCard", rendering.ControlId + "DeviceLeftInfoBoardColumnTop", null, DataSources.OpenRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "DeviceMostValuableScoreCard", rendering.ControlId + "DeviceRightInfoBoardColumnTop", null, DataSources.MostValuableScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "DeviceClickRateScoreCard", rendering.ControlId + "DeviceLeftInfoBoardColumnBottom", null, DataSources.ClickRateScoreCard);

    helper.CreateRenderingAt(Bcl.ScoreCard, "DeviceValuePerVisitScoreCard", rendering.ControlId + "DeviceRightInfoBoardColumnBottom", null, DataSources.ValuePerVisitScoreCard);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceLeftInfoBoardColumnBottom", rendering.ControlId + "DeviceInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceRightInfoBoardColumnBottom", rendering.ControlId + "DeviceInfoBoardRowPanelBottom", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceLeftInfoBoardColumnTop", rendering.ControlId + "DeviceInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceRightInfoBoardColumnTop", rendering.ControlId + "DeviceInfoBoardRowPanelTop", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "DeviceInfoBoardRowPanelTop", rendering.ControlId + "DeviceRightMainColumn");

    helper.CreateRenderingAt(Bcl.RowPanel, "DeviceInfoBoardRowPanelBottom", rendering.ControlId + "DeviceRightMainColumn");
    
    
    // Main browser Layout

    helper.CreateRenderingAt(Exm.D3.DoughnutChart, "BrowserDoughnutChart", rendering.ControlId + "BrowserLeftMainColumn", null, DataSources.BrowsersChart);   
 
    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserLeftMainColumn", rendering.ControlId + "BrowserMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "BrowserRightMainColumn", rendering.ControlId + "BrowserMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "BrowserMainRowPanel", rendering.ControlId + "TabContent2");

    // Main os Layout

    helper.CreateRenderingAt(Exm.D3.BarChart, "OsBarChart", rendering.ControlId + "OsLeftMainColumn", null, DataSources.OsBarChart);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsLeftMainColumn", rendering.ControlId + "OsMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "OsRightMainColumn", rendering.ControlId + "OsMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "OsMainRowPanel", rendering.ControlId + "TabContent1");
    
    // Main device Layout

    helper.CreateRenderingAt(Exm.D3.BarChart, "DeviceBarChart", rendering.ControlId + "DeviceLeftMainColumn", null, BaseDataSources.DeviceBarChart);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceLeftMainColumn", rendering.ControlId + "DeviceMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.ColumnPanel, "DeviceRightMainColumn", rendering.ControlId + "DeviceMainRowPanel", null, DataSources.ColumnPanel);

    helper.CreateRenderingAt(Bcl.RowPanel, "DeviceMainRowPanel", rendering.ControlId + "TabContent0");
    
    
    helper.CreateRenderingAt(Bcl.Border, "TabContent0", rendering.ControlId + "Card", null, BaseDataSources.TabBorder, "Wrapper.Content");

    helper.CreateRenderingAt(Bcl.Border, "TabContent1", rendering.ControlId + "Card", null, BaseDataSources.TabBorder, "Wrapper.Content");

    helper.CreateRenderingAt(Bcl.Border, "TabContent2", rendering.ControlId + "Card", null, BaseDataSources.TabBorder, "Wrapper.Content");

    helper.CreateRenderingAt(Bcl.StringDictionary, "StringDictionaryExtended", rendering.ControlId + "Card", null, DataSources.StringDictionaryExtended, "Wrapper.Content");
}

@RenderTechnologyReportExtended(rendering)

<div @rendering.HtmlAttributes data-sc-hasnested="true">
    @(this.Html.Sitecore().Controls().Rendering(this.Html, Bcl.Card, rendering.ControlId + "Card", DataSources.Card, new
            {
                BottomLink = @bottomLink,
                Height = @height
            }))
</div>