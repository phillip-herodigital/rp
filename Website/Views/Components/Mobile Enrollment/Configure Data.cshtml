@{
    var mobileSettings = Sitecore.Context.Database.GetItem("/sitecore/content/Data/Settings/Mobile Enrollment Options");
    var showSprint = !String.IsNullOrEmpty(mobileSettings.Fields["Sprint Buy Phone"].Value) || !String.IsNullOrEmpty(mobileSettings.Fields["Sprint BYOD"].Value);
    var item = Sitecore.Context.Database.GetItem("/sitecore/content/Data/Components/Shared/Coverage Map");
    var dataCalculator = Sitecore.Context.Database.GetItem("/sitecore/content/Data/Components/Marketing/Mobile/Mobile Usage Calculator");
}

<div id="phoneFlowPlans" class="enrollment" ng-show="stepsService.isStepVisible('phoneFlowPlans')" ng-controller="MobileEnrollmentConfigureDataCtrl" ng-init="setTimeRemaining('phoneFlowPlans', '@Html.Sitecore().Field("Remaining Minutes Number")');">
    @Html.Partial("~/Views/Components/Mobile Enrollment/Progress Bar.cshtml", new StreamEnergy.MyStream.Models.MobileEnrollment.ProgressBar { StepNumber = 2, StepTextField = "Step 2 Description Text" })
    @* Two-column layout for Configure Data *@
    <div class="layout plan-selection">
        <div class="wrapper cols-2">
            <section>
                <article class="enrollment__box enrollment__configure-data">
                    <header>
                        <h1>@Html.Sitecore().Field("Check Coverage And Choose")</h1>
                    </header>
                    <div class="content">
                        <div class="plan-error" ng-show="mobileEnrollment.requestedPlanId != '' && !requestedPlanAvailable && currentMobileLocationInfo().offerInformationByType">
                            @Html.Sitecore().Field("Requested Plan Unavailable")
                        </div>
                        <div class="plan-error" ng-show="excludedStates">
                            @Html.Sitecore().Field("Location Unavailable")
                        </div>
                        <div class="location-section clearfix">
                            <div class="clearfix">
                                <div class="location-container">
                                    <div class="location-text" ng-show="!showChangeLocation">
                                        @Html.Sitecore().Field("It looks like youre in") {{ geoLocation.city }}, {{ geoLocation.state }} {{ geoLocation.postalCode5 }} <a href="" ng-click="showChangeLocation = true">@Html.Sitecore().Field("Change Text")</a>
                                    </div>
                                    <div class="location-input" ng-show="showChangeLocation">
                                        <span>@Html.Sitecore().Field("Enter Zip Code Message")</span>
                                        <input type="text" data-val="true" data-val-regex data-val-regex-pattern="^[0-9]{5}$" data-val-if="showChangeLocation" data-val-required="" class="zip-code" ng-model="postalCode5" ng-keyup="$event.keyCode == 13 && lookupZip(postalCode5)">
                                        <a href="" ng-click="lookupZip(postalCode5)">@Html.Sitecore().Field("Go Text")</a>
                                    </div>
                                </div>
                                <a href="" class="view-coverage" ng-click="showCoverageMapOverlay()">@Html.Sitecore().Field("View Coverage Text")</a>
                            </div>
                        </div>
                        
                        <div ng-show="currentMobileLocationInfo().offerInformationByType">
                            <hr />
                            <div class="networkSection clearfix">
                                <i ng-class="{'icon-gsm_plans': mobileEnrollmentService.selectedNetwork.value == 'att', 'icon-cdma_plans':mobileEnrollmentService.selectedNetwork.value != 'att'}"></i>
                                <div class="message" ng-show="mobileEnrollmentService.selectedNetwork.value == 'att'">
                                    @Html.Sitecore().Field("Nations Largest")
                                </div>
                                <div class="message" ng-show="mobileEnrollmentService.selectedNetwork.value == 'sprint'">
                                    @Html.Sitecore().Field("Great Coverage Great Value")
                                </div>
                            </div>

                            <div class="plan-chooser" ng-show="getDevicesCount() < 2" ng-init="isIndSelected = true">
                                <a href="" class="button-plans left selected" id="button-left" ng-click="isIndSelected = true; isGroupSelected = false" ng-class="{'selected': isIndSelected}">
                                    @Html.Sitecore().Field("Individual Plans")
                                </a>
                                <a href="" class="button-plans right" id="button-right" ng-click="isIndSelected = false; isGroupSelected = true" ng-class="{'selected': isGroupSelected}">
                                    @Html.Sitecore().Field("Group Plans")
                                </a>
                            </div>

                            <div ng-show="isIndSelected">
                                <div data-ng-repeat="typedOffers in currentMobileLocationInfo().offerInformationByType" ng-include src="'indPlanList/' + typedOffers.key"></div>
                            </div>
                            <div ng-show="isGroupSelected">
                                <div data-ng-repeat="typedOffers in currentMobileLocationInfo().offerInformationByType" ng-include src="'groupPlanList/' + typedOffers.key"></div>
                            </div>

                            <div class="button full" ng-show="!showPlanDetails" ng-click="showPlanDetails = true">
                                <a>@Html.Sitecore().Field("Show Plan Details")</a>
                            </div>

                            <div class="plan-details" ng-show="showPlanDetails">
                                <div class="clearfix">
                                    <div class="detail-section">@Html.Raw(@Html.Sitecore().Field("Data Plans")) </div>
                                    <div class="detail-section">@Html.Raw(@Html.Sitecore().Field("Unlimited Plans"))</div>
                                </div>
                                <div class="footnotes">
                                    <div>@Html.Sitecore().Field("Unlimited Disclosure")</div>
                                    <div>@Html.Sitecore().Field("Requires Device Disclosure")</div>
                                </div>
                            </div>
                            <div class="button full hideDetails" ng-click="showPlanDetails = false" ng-show="showPlanDetails">
                                <a>@Html.Sitecore().Field("Hide Plan Details")</a>
                            </div>
                            <p>
                               @Html.Sitecore().Field("Dont know right plan") <a ng-click="showCalculator()">@Html.Sitecore().Field("Data Calculator")</a>
                            </p>
                        </div>
                    </div>
                    <footer>
                        <div class="buttons">
                            <button type="submit" class="primary" ng-click="completeStep();" ng-disabled="!planSelection.selectedOffers['Mobile'].length">@Html.Sitecore().Field("Button - Next")</button>
                            <button type="button" class="tertiary" ng-click="resetEnrollment();">@Html.Sitecore().Field("Button - Cancel Enrollment")</button>
                        </div>
                    </footer>
                </article>
                <article class="enrollment__box enrollment__configure-data" ng-show="!mobileEnrollmentSettings.disableIntegratedEnrollments && planSelection.selectedOffers['Mobile'].length && customerType != 'commercial'">
                    <div class="content additional-services">
                        <h3>@Html.Sitecore().Field("Additional Services Header")</h3>
                        <div class="additional-service">
                            <div class="additional-service-image">
                                @Html.Sitecore().Field("Energy Services Image")
                            </div>
                            <div class="additional-service-content">
                                @Html.Sitecore().Field("Energy Services Content")
                                <p><a href="" ng-click="addUtilityAddress()">@Html.Sitecore().Field("Energy Services Link Text") <i class="icon-arrow-right"></i></a></p>
                            </div>
                            @Html.Sitecore().Field("Energy Services")
                        </div>
                    </div>
                </article>
            </section>
            <aside>
                <div ng-include src="'cart-template'"></div>
            </aside>
        </div>
    </div>
</div>


<div class="coverage-map-container hidden-map">
    <div class="inner">
        <div class="modal-header">
            <a class="close" onclick="$('.coverage-map-container').addClass('hidden-map')">X</a>
            <h2>&nbsp;</h2>
        </div>

        <script src="//maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
        <div class="wrapper">
            <article class="coverage-map" ng-controller="MobileEnrollmentConfigureDataCtrl">
                <div class="form">

                    <ul class="network-toggle">
                        <li ng-class="{active:selectedNetwork == 'att'}"><a href="" ng-model="selectedNetwork" btn-radio="'att'">@item.Fields["GSM Network"].Value</a></li>
                        @if (showSprint)
                        {
                            <li ng-class="{active:selectedNetwork == 'sprint'}"><a href="" ng-model="selectedNetwork" btn-radio="'sprint'">@item.Fields["CDMA Network"].Value</a></li>
                        }
                    </ul>
                    <div class="item">
                        <label for="gmap-search-input">@item.Fields["Enter Zip Code"].Value</label>
                        <div id="gmap-search"></div>
                    </div>
                </div>
                <ui-gmap-google-map center="map.center" zoom="map.zoom" options="map.options" events="map.events" control="map.control">
                    <ui-gmap-search-box template="searchbox.template" events="searchbox.events" parentdiv="'gmap-search'"></ui-gmap-search-box>
                </ui-gmap-google-map>
                <ul class="layer-toggle" ng-show="selectedNetwork == 'att'">
                    <li>
                        <input type="checkbox" id="att_voice" ng-model="layers.att.att_voice_roam" /> <label for="att_voice">@item.Fields["Voice"].Value</label>
                    </li>
                    <li>
                        <input type="checkbox" id="att_data" ng-model="layers.att.att_data_roam" /> <label for="att_data">@item.Fields["Data"].Value</label>
                    </li>
                    <li>
                        <input type="checkbox" id="att_lte" ng-model="layers.att.att_lte" /> <label for="att_lte">@item.Fields["LTE"].Value</label>
                    </li>
                </ul>
                <ul class="layer-toggle" ng-show="selectedNetwork == 'sprint'">
                    <li>
                        <input type="checkbox" id="sprint_voice" ng-model="layers.sprint.sprint_voice_roam" /> <label for="sprint_voice">@item.Fields["Voice"].Value</label>
                    </li>
                    <li>
                        <input type="checkbox" id="sprint_data" ng-model="layers.sprint.sprint_data_roam" /> <label for="sprint_data">@item.Fields["Data"].Value</label>
                    </li>
                    <li>
                        <input type="checkbox" id="sprint_lte" ng-model="layers.sprint.sprint_lte" /> <label for="sprint_lte">@item.Fields["LTE"].Value</label>
                    </li>
                </ul>
            </article>
        </div>
    </div>
</div>
<div class="coverage-map-fade"></div>

<div class="data-calculator-container hidden">
    <a class="close" onclick="$('.data-calculator-container').addClass('hidden')">X</a>
    <div class="inner">
        @Html.Partial("~/Views/Components/Marketing/Mobile/Mobile Usage Calculator.cshtml", new StreamEnergy.MyStream.Models.Marketing.UsageCalculator { IsModal = true, ShowManualCalculator = true })
    </div>
    
</div>
<div class="data-calculator-fade"></div>

<script type="text/ng-template" id="indPlanList/Mobile">
    <div class="btn-group btn-group-options mobile-plans {{mobileEnrollmentService.selectedNetwork.value}}">
        <div class="button" ng-model="planSelection.selectedOffers[typedOffers.key]" data-btn-radio="'{{plan.id}}'" data-uncheckable ng-repeat="plan in typedOffers.value.availableOffers | filter:filterIndPlans | orderBy:'sortOrder'" ng-class="{'is-recommended':plan.recommended,'is-special-offer':plan.specialOffer}">
            <div class="extra-info">
                <span ng-if="plan.recommended">@Html.Sitecore().Field("Recommended")</span>
                <span ng-if="plan.specialOffer">{{ plan.specialOfferText }}</span>
            </div>

            <div class="price">
                <div class="cost" ng-bind-html="superCents(totalPlanPrice(plan, typedOffers.value.availableOffers)) | unsafe"></div>
                <div class="duration">@Html.Sitecore().Field("Per Month Text")</div>
            </div>
            <div ng-if="plan.data != 0" class="size-speed">
                <div class="size">{{ plan.data }} <span ng-if="plan.data != 'Unlimited'">@Html.Sitecore().Field("GB Text")</span></div>
                <div class="speed">@Html.Sitecore().Field("At Speeds Up To")</div>
            </div>
            <div ng-if="plan.data == 0" class="size-speed">
                <span class="size">@Html.Raw(Html.Sitecore().Field("Talk and Text Only Text"))</span>
            </div>
            <a class="button">@Html.Sitecore().Field("Select Text")</a>
            <div class="icon-circle-check"></div>
        </div>
    </div>
</script>

<script type="text/ng-template" id="groupPlanList/Mobile">
    <div class="btn-group btn-group-options mobile-plans {{mobileEnrollmentService.selectedNetwork.value}}">
        <div class="button" ng-model="planSelection.selectedOffers[typedOffers.key]" data-btn-radio="'{{plan.id}}'" data-uncheckable ng-repeat="plan in typedOffers.value.availableOffers | filter:filterGroupPlans | orderBy:'sortOrder'" ng-class="{'is-recommended':plan.recommended,'is-special-offer':plan.specialOffer}">
            <div class="extra-info">
                <span ng-if="plan.recommended">@Html.Sitecore().Field("Recommended")</span>
                <span ng-if="plan.specialOffer">{{ plan.specialOfferText }}</span>
            </div>
            <div class="price">
                <div class="cost" ng-bind-html="superCents(totalPlanPrice(plan, typedOffers.value.availableOffers)) | unsafe"></div>
                <div class="duration">@Html.Sitecore().Field("Per Month Text")</div>
            </div>
            <div ng-if="plan.data != 0" class="size-speed">
                <div class="size">{{ plan.data }} <span ng-if="plan.data != 'Unlimited'">@Html.Sitecore().Field("GB Text")</span></div>
                <div class="speed">@Html.Sitecore().Field("At Speeds Up To")</div>
            </div>
            <div ng-if="plan.data == 0" class="size-speed">
                <span class="size">@Html.Raw(Html.Sitecore().Field("Talk and Text Only Text"))</span>
            </div>
            <a class="button">@Html.Sitecore().Field("Select Text")</a>
            <div class="icon-circle-check"></div>
        </div>
    </div>
</script>

<script type="text/ng-template" id="indPlanList/TexasElectricity">
</script>
<script type="text/ng-template" id="groupPlanList/TexasElectricity">
</script>
<script type="text/ng-template" id="indPlanList/GeorgiaGas">
</script>
<script type="text/ng-template" id="groupPlanList/GeorgiaGas">
</script>

<script type="text/ng-template" id="searchbox.tpl.html">
    <input type="text" id="gmap-search-input" placeholder="" />
</script>