@model StreamEnergy.DomainModels.Enrollments.UserContext
@using TypedPhone = StreamEnergy.DomainModels.TypedPhone
@using StreamEnergy.DomainModels.Enrollments
@using TexasElectricity = StreamEnergy.DomainModels.Enrollments.TexasElectricity
@using GeorgiaGas = StreamEnergy.DomainModels.Enrollments.GeorgiaGas
@{ 
    int progressBarStep = 3;
    bool hideCart = true;
    if (!string.IsNullOrEmpty(Request.QueryString["ServiceType"]) && Request.QueryString["ServiceType"].ToLower() == "pro")
    {
        progressBarStep = 2;
        hideCart = false;
    }
}

@using (new Sitecore.Data.Items.ContextItemSwitcher(Html.Sitecore().CurrentItem))
{
<div id="accountInformation" class="enrollment showCart" ng-if="stepsService.isStepVisible('accountInformation')" ng-controller="EnrollmentAccountInformationCtrl" ng-init="usStates = @(Html.Action("States", "Data").ToHtmlString()); phoneTypes = @(Html.Action("PhoneCategories", "Data").ToHtmlString()); previousProviders = @(Html.Action("PreviousProviders", "Data").ToHtmlString()); previousProvidersGeorgia = @(Html.Action("PreviousProvidersGeorgia", "Data").ToHtmlString()); setTimeRemaining('accountInformation', '@Html.Sitecore().Field("Remaining Minutes Number")'); protectiveEnrollmentSettings(@(Html.Action("ProtectiveEnrollmentSettings", "Data").ToHtmlString()));">    
    <div ng-if="customerType != 'commercial'">
        @Html.Partial("~/Views/Components/Enrollment/Progress Bar.cshtml", new StreamEnergy.MyStream.Models.Enrollment.ProgressBar { StepNumber = progressBarStep, StepTextField = string.Format("Step {0} Description Text", progressBarStep.ToString()), HideCart = hideCart })
    </div>
    <div ng-if="customerType == 'commercial'">
        @Html.Partial("~/Views/Components/Enrollment/Progress Bar.cshtml", new StreamEnergy.MyStream.Models.Enrollment.ProgressBar { StepNumber = 2, StepTextField = "Commercial Description Text", HideCart = hideCart })
    </div>
    <div class="layout">
        <div class="wrapper cols-2 enrollment__account-information">
            <section>
                <form data-val-bind-messages="validations" name="accountInfo" ng-submit="completeStep()">
                    @Html.ValidationSummary()
                    @* Loop through utility addresses *@
                    <article ng-if="customerType=='residential' && cartHasUtility()" class="enrollment__box form" ng-repeat="(index, item) in utilityAddresses()" ng-init="init();">
                        <header>
                            <h1>@Html.Sitecore().Field("Header Account Information")</h1>
                        </header>
                        <div class="content">
                            <p>@Html.Sitecore().Field("Fill in Information")</p>
                            @* Service Address *@
                            <div class="item item--no-input" ng-show="item.location.address">
                                <label for="service-address">@Html.Sitecore().Field("Service Address Label")</label>
                                {{ item.location.address | address }}
                            </div>
                            @* Address Input Dropdown *@
                            <div class="item" ng-if="!item.location.address.line1">
                                <label for="service-address">@Html.Sitecore().Field("Service Address Label")</label>
                                <input type="text"
                                       id="service-address"
                                       class="typeahead"
                                       ng-model="item.tempLocation"
                                       typeahead="location as location.address|address for location in getLocation(item.location.address.stateAbbreviation, $viewValue, true)"
                                       typeahead-loading="accountInformation.loadingAccountInformationServiceAddress"
                                       ng-class="{'loading' : accountInformation.loadingAccountInformation}" autocomplete="off" />
                            </div>
                            @* ESI ID *@
                            <div ng-if="item.location.capabilities[0].esiId" class="item item--no-input inline-label location">
                                <label for="location-id">@Html.Sitecore().Field("ESI ID Label")</label>
                                {{ item.location.capabilities[0].esiId }}
                            </div>
                            @* SEP Code *@
                            <div ng-if="item.location.capabilities[0].aglAccountNumber" class="item item--no-input inline-label location">
                                <label for="location-id">@Html.Sitecore().Field("SEP Number Label")</label>
                                {{ item.location.capabilities[0].aglAccountNumber }}
                            </div>
                            @*Selected Offers Section*@
                            <div ng-repeat="offerInformation in item.offerInformationByType">
                                <div ng-repeat="selectedOffer in offerInformation.value.offerSelections">
                                    <div ng-if="selectedOffer.optionRules" ng-include src="'offerOptions/' + selectedOffer.optionRules.optionRulesType"></div>
                                </div>
                            </div>
                        </div>
                    </article>
                    <article ng-if="customerType=='residential' && !isRenewal" class="enrollment__box form">
                        <header>
                            <h1>@Html.Sitecore().Field("Contact Information Header")</h1>
                        </header>
                        <div class="content">
                            <h3>@Html.Sitecore().Field("Personal Information Header")</h3>
                            <div class="group">
                                <div class="item" ng-show="contacts.options.length> 1">
                                    <label>@Html.Sitecore().Field("Select Existing Contact Info Label")</label>
                                    <select ng-model="contacts.selectedContact"
                                            ng-change="updateAccountInformation()"
                                            ng-options="contact as contact.mailingAddress | address for contact in contacts.options">
                                        <option value="">@Html.Sitecore().Field("Select Option Please Choose")</option>
                                    </select>
                                </div>
                            </div>
                            <div class="group">
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Name.First)>
                                    <label for="@Html.IdFor(m => m.ContactInfo.Name.First)">@Html.Sitecore().Field("First Name Label")</label>
                                    @Html.TextBoxFor(m => m.ContactInfo.Name.First, new { ng_model = "accountInformation.contactInfo.name.first" })
                                    @Html.ValidationMessageFor(model => model.ContactInfo.Name.First)
                                </div>
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Name.Last)>
                                    <label for="@Html.IdFor(m => m.ContactInfo.Name.Last)">@Html.Sitecore().Field("Last Name Label")</label>
                                    @Html.TextBoxFor(m => m.ContactInfo.Name.Last, new { ng_model = "accountInformation.contactInfo.name.last" })
                                    @Html.ValidationMessageFor(model => model.ContactInfo.Name.Last)
                                </div>
                            </div>
                            <div class="group">
                                @using (var firstPhone = Html.ClientRepeater(m => m.ContactInfo.Phone, "0").Shortcut(m => (TypedPhone)m))
                                {
                                    <div class="item group-col" @firstPhone.Validation().ErrorClass(m => m.Number)>
                                        <label for="@firstPhone.Fix(h => h.IdFor(m => m.Number))">@Html.Sitecore().Field("Primary Phone Number Label")</label>
                                        @firstPhone.Fix(h => h.TextBoxFor(m => m.Number, new { type = "tel", ng_model = "accountInformation.contactInfo.phone[0].number" }))
                                        @firstPhone.ValidationMessageFor(m => m.Number)
                                    </div>
                                    <div class="item group-col" @firstPhone.Validation().ErrorClass(m => m.Category)>
                                        <label for="@firstPhone.Fix(h => h.IdFor(m => m.Category))">@Html.Sitecore().Field("Phone Type Label")</label>
                                        @firstPhone.Fix(h => h.DropDownListFor(m => m.Category,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            ng_model = "accountInformation.contactInfo.phone[0].category",
                                                            ng_options = "type.name as type.display for type in phoneTypes|filter:filter1|filter:filterCustomerType"
                                                        }))
                                        @firstPhone.ValidationMessageFor(m => ((TypedPhone)m).Category)
                                    </div>
                                }
                            </div>
                            <div class="additional-field-item item">
                                <ul class="checkbox-list">
                                    <li><input type="checkbox" name="additional-phone-number" id="additional-phone-number" ng-model="accountInformation.showAdditionalPhoneNumber" ng-change="showAdditionalPhoneNumberChanged()"><label for="additional-phone-number">@Html.Sitecore().Field("Add additional phone number")</label></li>
                                </ul>
                            </div>
                            <div class="additional-field-group" ng-show="accountInformation.showAdditionalPhoneNumber">
                                <div class="group">
                                    @using (var secondPhone = Html.ClientRepeater(m => m.ContactInfo.Phone, "1").Shortcut(m => (TypedPhone)m))
                                    {
                                        <div class="item group-col" @secondPhone.Validation().ErrorClass(m => m.Number)>
                                            <label for="@secondPhone.Fix(h => h.IdFor(m => m.Number))">@Html.Sitecore().Field("Secondary Phone Number Label")</label>
                                            @secondPhone.Fix(h => h.TextBoxFor(m => m.Number, new { type = "tel", ng_model = "accountInformation.contactInfo.phone[1].number", data_val_if = "accountInformation.contactInfo.phone.length> 1" }))
                                            @secondPhone.ValidationMessageFor(m => m.Number)
                                        </div>
                                        <div class="item group-col" @secondPhone.Validation().ErrorClass(m => m.Category)>
                                            <label for="@secondPhone.Fix(h => h.IdFor(m => m.Category))">@Html.Sitecore().Field("Phone Type Label")</label>
                                            @secondPhone.Fix(h => h.DropDownListFor(m => m.Category,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            ng_model = "accountInformation.contactInfo.phone[1].category",
                                                            ng_options = "type.name as type.display for type in phoneTypes|filter:filter2|filter:filterCustomerType",
                                                            data_val_if = "accountInformation.contactInfo.phone.length > 1"
                                                        }))
                                            @secondPhone.ValidationMessageFor(m => ((TypedPhone)m).Category)
                                        </div>
                                    }
                                </div>
                            </div>

                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Email.Address)>
                                <label for="@Html.IdFor(m => m.ContactInfo.Email.Address)">@Html.Sitecore().Field("Email Address Label")</label>
                                @Html.TextBoxFor(m => m.ContactInfo.Email.Address, new { type = "email", ng_model = "accountInformation.contactInfo.email.address" })
                                @Html.ValidationMessageFor(model => model.ContactInfo.Email.Address)
                            </div>
                            <div class="item group-col" ng-if="customerType == 'residential' || accountInformation.ssnOrTaxid == 'ssn'" @Html.Validation().ErrorClass(m => m.SocialSecurityNumber)>
                                <label for="@Html.IdFor(m => m.SocialSecurityNumber)">
                                    @Html.Sitecore().Field("Social Security Number Label")
                                <a ng-if="cartHasUtility() && !cartHasMobile()" href="" tooltip="@Html.Sitecore().Field("Social Security Number Tooltip")"><i class="icon-tooltip"></i></a>
                                <a ng-if="!cartHasUtility() && cartHasMobile()" href="" tooltip="@Html.Sitecore().Field("Social Security Number Tooltip Mobile")"><i class="icon-tooltip"></i></a>
                                <a ng-if="cartHasUtility() && cartHasMobile()" href="" tooltip="@Html.Sitecore().Field("Social Security Number Tooltip Integrated")"><i class="icon-tooltip"></i></a>
                            </label>
                            @Html.TextBoxFor(m => m.SocialSecurityNumber, new { ng_model = "accountInformation.socialSecurityNumber", @class = "maskField", data_val = "true", data_val_required = "" })
                            @Html.ValidationMessageFor(m => m.SocialSecurityNumber)
                        </div>
                        <div class="item" ng-if="accountInformation.ssnOrTaxid == 'taxId'" @Html.Validation().ErrorClass(m => m.TaxId)>
                            <label for="@Html.IdFor(m => m.TaxId)">@Html.Sitecore().Field("Tax ID Label")</label>
                            @Html.TextBoxFor(m => m.TaxId, new { ng_model = "accountInformation.taxId", data_val = "true", data_val_required = "" })
                            @Html.ValidationMessageFor(m => m.TaxId)
                        </div>
                        <div class="item group-col" ng-if="showDOB()" @Html.Validation().ErrorClass(m => m.DOB) ng-class="{error : accountInfo.DOB.$error.dob && !accountInfo.DOB.suppressValidationMessages}">
                            <label for="@Html.IdFor(m => m.DOB)" class="left-tooltip">
                                @Html.Sitecore().Field("DOB Label")
                                <a href="" tooltip="@Html.Sitecore().Field("DOB Tool Tip")"><i class="icon-tooltip"></i></a>
                            </label>
                            <input name="DOB" id="DOB" type="text" ng-model="accountInformation.DOB" data-val="true" data-val-required="@Html.Sitecore().Field("DOB Required Text")" dob-input="" placeholder="@Html.Sitecore().Field("DOB Placeholder")" data-date-format="mm/dd/yyyy" />
                            <span class="field-validation-error" ng-if="!accountInfo.DOB.suppressValidationMessages && accountInfo.DOB.$error.dob">@Html.Sitecore().Field("DOB Invalid Text")</span>
                            @Html.ValidationMessageFor(m => m.DOB)
                        </div>
                        <div class="item group-col" ng-if="showGender()" @Html.Validation().ErrorClass(m => m.Gender)>
                            <label for="Gender" class="left-tooltip">
                                @Html.Sitecore().Field("Gender Label")
                                <a href="" tooltip="@Html.Sitecore().Field("Gender Tool Tip")"><i class="icon-tooltip"></i></a>
                            </label>
                            <select id="Gender" name="Gender" ng-model="accountInformation.gender" data-val="true" data-val-required = "@Html.Sitecore().Field("Gender Required Text")">
                                <option ng-value="'M'">@Html.Sitecore().Field("Male Text")</option>
                                <option ng-value="'F'">@Html.Sitecore().Field("Female Text")</option>
                            </select>
                            @Html.ValidationMessageFor(m => m.Gender)
                        </div>
                        <div class="additional-field-item item">
                            <ul class="checkbox-list">
                                <li><input type="checkbox" name="secondary-contact" id="secondary-contact" ng-model="additionalInformation.showSecondaryContact" ng-change="showSecondaryContactChanged()"><label for="secondary-contact">@Html.Sitecore().Field("Checkbox Add Secondary Contact")</label></li>
                            </ul>
                        </div>
                        <div class="additional-field-group secondary-contact-group" ng-if="additionalInformation.showSecondaryContact">
                            <div class="group">
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.SecondaryContactInfo.First)>
                                    <label for="@Html.IdFor(m => m.SecondaryContactInfo.First)">@Html.Sitecore().Field("First Name Label")</label>
                                    @Html.TextBoxFor(m => m.SecondaryContactInfo.First, new { data_val_if = "accountInformation.showSecondaryContact", ng_model = "accountInformation.secondaryContactInfo.first" })
                                    @Html.ValidationMessageFor(m => m.SecondaryContactInfo.First)
                                </div>
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.SecondaryContactInfo.Last)>
                                    <label for="@Html.IdFor(m => m.SecondaryContactInfo.Last)">@Html.Sitecore().Field("Last Name Label")</label>
                                    @Html.TextBoxFor(m => m.SecondaryContactInfo.Last, new { data_val_if = "accountInformation.showSecondaryContact", ng_model = "accountInformation.secondaryContactInfo.last" })
                                    @Html.ValidationMessageFor(m => m.SecondaryContactInfo.Last)
                                </div>
                            </div>
                        </div>

                        <hr class="content-divider">
                        <div ng-init="accountInformation.mailingAddressSame = cartHasUtility()">
                            <h3>@Html.Sitecore().Field("Mailing Address Header")</h3>
                            <div class="item" ng-show="cartHasUtility()">
                                <ul class="checkbox-list">
                                    <li>
                                        <input type="checkbox" name="same-address-mailing" id="same-address-mailing" ng-click="mailingAddressSameChanged()" ng-model="accountInformation.mailingAddressSame" ng-checked="cartHasUtility()">
                                        <label for="same-address-mailing">@Html.Sitecore().Field("Same Address Label")</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="item" ng-show="accountInformation.mailingAddressSame && utilityAddresses().length > 1" @Html.Validation().ErrorClass(m => m.MailingAddress)>
                                <label for="service-address-mailing">@Html.Sitecore().Field("Select Service Address Label")</label>
                                <select id="service-address-mailing"
                                        name="@Html.NameFor(m => m.MailingAddress)"
                                        data-val="true" data-val-required
                                        ng-model="accountInformation.mailingAddress"
                                        ng-change="updateBillingAddress()"
                                        ng-options="entry.location.address as entry.location.address | address for entry in utilityAddresses()">
                                    <option value="">@Html.Sitecore().Field("Select Option Please Choose")</option>
                                </select>
                            </div>
                            <div class="item item--no-input" ng-show="accountInformation.mailingAddressSame && utilityAddresses().length == 1">
                                <label>@Html.Sitecore().Field("Billing Service Address Label")</label>
                                <strong>{{ utilityAddresses()[0].location.address | address }}</strong>
                            </div>
                            @using (var mailingAddress = Html.Shortcut(m => m.MailingAddress))
                            {
                                <div ng-if="!accountInformation.mailingAddressSame" class="mailing-address">
                                    <div class="group">
                                        <div class="item group-col" @(mailingAddress.Validation().ErrorClass(m => m.Line1))>
                                            <label for="@mailingAddress.Fix(h => h.IdFor(m => m.Line1))">@Html.Sitecore().Field("Address 1 Label")</label>
                                            @mailingAddress.Fix(h => h.TextBoxFor(m => m.Line1, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.line1" }))
                                            @mailingAddress.ValidationMessageFor(m => m.Line1)
                                        </div>
                                        <div class="item group-col" @mailingAddress.Validation().ErrorClass(m => m.Line2)>
                                            <label for="@mailingAddress.Fix(h => h.IdFor(m => m.Line2))">@Html.Sitecore().Field("Address 2 Label")</label>
                                            @mailingAddress.Fix(h => h.TextBoxFor(m => m.Line2, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.line2" }))
                                            @mailingAddress.ValidationMessageFor(m => m.Line2)
                                        </div>
                                    </div>
                                    <div class="group">
                                        <div class="item group-col" @mailingAddress.Validation().ErrorClass(m => m.City)>
                                            <label for="@mailingAddress.Fix(h => h.IdFor(m => m.City))">@Html.Sitecore().Field("City Label")</label>
                                            @mailingAddress.Fix(h => h.TextBoxFor(m => m.City, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.city" }))
                                            @mailingAddress.ValidationMessageFor(m => m.City)
                                        </div>
                                        <div class="item" @mailingAddress.Validation().ErrorClass(m => m.StateAbbreviation)>
                                            <label for="@mailingAddress.Fix(h => h.IdFor(m => m.StateAbbreviation))">@Html.Sitecore().Field("State Label")</label>
                                            @mailingAddress.Fix(h => h.DropDownListFor(m => m.StateAbbreviation,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            data_val_if = "!accountInformation.mailingAddressSame",
                                                            ng_model = "accountInformation.mailingAddress.stateAbbreviation",
                                                            ng_options = "state.abbreviation as state.display for state in usStates"
                                                        }))
                                            @mailingAddress.ValidationMessageFor(m => m.StateAbbreviation)
                                        </div>
                                        <div class="item zip-code" @mailingAddress.Validation().ErrorClass(m => m.PostalCode5)>
                                            <label for="@mailingAddress.Fix(h => h.IdFor(m => m.PostalCode5))">@Html.Sitecore().Field("Zip Label")</label>
                                            @mailingAddress.Fix(h => h.TextBoxFor(m => m.PostalCode5, new { @class = "small", data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.postalCode5" }))
                                            @mailingAddress.ValidationMessageFor(m => m.PostalCode5)
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                        <div ng-if="!cartHasMobile() && !cartHasProtective() && hasMoveIn && customerType != 'commercial'" class="previous-address">
                            <h3>@Html.Sitecore().Field("Previous Address Header")</h3>
                            @using (var previousAddress = Html.Shortcut(m => m.PreviousAddress))
                            {
                                <div>
                                    <div class="group">
                                        <div class="item group-col" @(previousAddress.Validation().ErrorClass(m => m.Line1))>
                                            <label for="@previousAddress.Fix(h => h.IdFor(m => m.Line1))">@Html.Sitecore().Field("Address 1 Label")</label>
                                            @previousAddress.Fix(h => h.TextBoxFor(m => m.Line1, new { data_val_if = "hasMoveIn && customerType != 'commercial'", ng_model = "accountInformation.previousAddress.line1" }))
                                            @previousAddress.ValidationMessageFor(m => m.Line1)
                                        </div>
                                        <div class="item group-col" @previousAddress.Validation().ErrorClass(m => m.Line2)>
                                            <label for="@previousAddress.Fix(h => h.IdFor(m => m.Line2))">@Html.Sitecore().Field("Address 2 Label")</label>
                                            @previousAddress.Fix(h => h.TextBoxFor(m => m.Line2, new { data_val_if = "hasMoveIn && customerType != 'commercial'", ng_model = "accountInformation.previousAddress.line2" }))
                                            @previousAddress.ValidationMessageFor(m => m.Line2)
                                        </div>
                                    </div>
                                    <div class="group">
                                        <div class="item group-col" @previousAddress.Validation().ErrorClass(m => m.City)>
                                            <label for="@previousAddress.Fix(h => h.IdFor(m => m.City))">@Html.Sitecore().Field("City Label")</label>
                                            @previousAddress.Fix(h => h.TextBoxFor(m => m.City, new { data_val_if = "hasMoveIn && customerType != 'commercial'", ng_model = "accountInformation.previousAddress.city" }))
                                            @previousAddress.ValidationMessageFor(m => m.City)
                                        </div>
                                        <div class="item" @previousAddress.Validation().ErrorClass(m => m.StateAbbreviation)>
                                            <label for="@previousAddress.Fix(h => h.IdFor(m => m.StateAbbreviation))">@Html.Sitecore().Field("State Label")</label>
                                            @previousAddress.Fix(h => h.DropDownListFor(m => m.StateAbbreviation,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            data_val_if = "hasMoveIn && customerType != 'commercial'",
                                                            ng_model = "accountInformation.previousAddress.stateAbbreviation",
                                                            ng_options = "state.abbreviation as state.display for state in usStates"
                                                        }))
                                            @previousAddress.ValidationMessageFor(m => m.StateAbbreviation)
                                        </div>
                                        <div class="item zip-code" @previousAddress.Validation().ErrorClass(m => m.PostalCode5)>
                                            <label for="@previousAddress.Fix(h => h.IdFor(m => m.PostalCode5))">@Html.Sitecore().Field("Zip Label")</label>
                                            @previousAddress.Fix(h => h.TextBoxFor(m => m.PostalCode5, new { @class = "small", data_val_if = "hasMoveIn && customerType != 'commercial'", ng_model = "accountInformation.previousAddress.postalCode5" }))
                                            @previousAddress.ValidationMessageFor(m => m.PostalCode5)
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>

                        <div class="item group-col" ng-if="hasSwitch" @Html.Validation().ErrorClass(m => m.PreviousProvider)>
                            <label for="@Html.IdFor(m => m.PreviousProvider)">@Html.Sitecore().Field("Previous Provider Label")</label>
                            @Html.DropDownListFor(m => m.PreviousProvider,
                                                new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                new
                                                {
                                                    ng_model = "accountInformation.previousProvider",
                                                    ng_options = "type.name as type.display for type in getPreviousProviders()"
                                                })
                        </div>
                    </div>

                    </article>
                    <article ng-if="customerType=='commercial' && !isRenewal" class="enrollment__box form">
                        <header>
                            <h1>@Html.Sitecore().Field("Contact Information Header")</h1>
                        </header>
                        <div class="content">
                            <h3>@Html.Sitecore().Field("Personal Information Header")</h3>
                            <div class="group">
                                <div class="item" ng-show="contacts.options.length> 1">
                                    <label>@Html.Sitecore().Field("Select Existing Contact Info Label")</label>
                                    <select ng-model="contacts.selectedContact"
                                            ng-change="updateAccountInformation()"
                                            ng-options="contact as contact.mailingAddress | address for contact in contacts.options">
                                        <option value="">@Html.Sitecore().Field("Select Option Please Choose")</option>
                                    </select>
                                </div>
                            </div>
                            <div class="group">
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Name.First)>
                                    <label for="@Html.IdFor(m => m.ContactInfo.Name.First)">@Html.Sitecore().Field("First Name Label")</label>
                                    @Html.TextBoxFor(m => m.ContactInfo.Name.First, new { ng_model = "accountInformation.contactInfo.name.first", required = "required", data_val="true", data_val_required= Html.Sitecore().Field("First Name Required").ToString() })
                                    @Html.ValidationMessageFor(model => model.ContactInfo.Name.First)
                                </div>
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Name.Last)>
                                    <label for="@Html.IdFor(m => m.ContactInfo.Name.Last)">@Html.Sitecore().Field("Last Name Label")</label>
                                    @Html.TextBoxFor(m => m.ContactInfo.Name.Last, new { ng_model = "accountInformation.contactInfo.name.last", required = "required", data_val = "true", data_val_required = Html.Sitecore().Field("Last Name Required").ToString() })
                                    @Html.ValidationMessageFor(model => model.ContactInfo.Name.Last)
                                </div>
                            </div>
                            <div class="group">
                                <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactTitle)>
                                    <label for="@Html.IdFor(m => m.ContactTitle)">@Html.Sitecore().Field("Title Label")</label>
                                    @Html.TextBoxFor(m => m.ContactTitle, new { ng_model = "accountInformation.contactTitle", required = "required", data_val = "true", data_val_required = Html.Sitecore().Field("Title Required").ToString() })
                                    @Html.ValidationMessageFor(model => model.ContactTitle)
                                </div>
                            </div>
                            <div class="group">
                                @using (var firstPhone = Html.ClientRepeater(m => m.ContactInfo.Phone, "0").Shortcut(m => (TypedPhone)m))
                                {
                                    <div class="item group-col" @firstPhone.Validation().ErrorClass(m => m.Number)>
                                        <label for="@firstPhone.Fix(h => h.IdFor(m => m.Number))">@Html.Sitecore().Field("Primary Phone Number Label")</label>
                                        @firstPhone.Fix(h => h.TextBoxFor(m => m.Number, new { type = "tel", ng_model = "accountInformation.contactInfo.phone[0].number" }))
                                        @firstPhone.ValidationMessageFor(m => m.Number)
                                    </div>
                                    <div class="item group-col" @firstPhone.Validation().ErrorClass(m => m.Category)>
                                        <label for="@firstPhone.Fix(h => h.IdFor(m => m.Category))">@Html.Sitecore().Field("Phone Type Label")</label>
                                        @firstPhone.Fix(h => h.DropDownListFor(m => m.Category,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            ng_model = "accountInformation.contactInfo.phone[0].category",
                                                            ng_options = "type.name as type.display for type in phoneTypes|filter:filter1|filter:filterCustomerType"
                                                        }))
                                        @firstPhone.ValidationMessageFor(m => ((TypedPhone)m).Category)
                                    </div>
                                }
                            </div>
                            <div class="additional-field-item item">
                                <ul class="checkbox-list">
                                    <li><input type="checkbox" name="additional-phone-number" id="additional-phone-number" ng-model="accountInformation.showAdditionalPhoneNumber" ng-change="showAdditionalPhoneNumberChanged()"><label for="additional-phone-number">@Html.Sitecore().Field("Add additional phone number")</label></li>
                                </ul>
                            </div>
                            <div class="additional-field-group" ng-show="accountInformation.showAdditionalPhoneNumber">
                                <div class="group">
                                    @using (var secondPhone = Html.ClientRepeater(m => m.ContactInfo.Phone, "1").Shortcut(m => (TypedPhone)m))
                                    {
                                        <div class="item group-col" @secondPhone.Validation().ErrorClass(m => m.Number)>
                                            <label for="@secondPhone.Fix(h => h.IdFor(m => m.Number))">@Html.Sitecore().Field("Secondary Phone Number Label")</label>
                                            @secondPhone.Fix(h => h.TextBoxFor(m => m.Number, new { type = "tel", ng_model = "accountInformation.contactInfo.phone[1].number", data_val_if = "accountInformation.contactInfo.phone.length> 1" }))
                                            @secondPhone.ValidationMessageFor(m => m.Number)
                                        </div>
                                        <div class="item group-col" @secondPhone.Validation().ErrorClass(m => m.Category)>
                                            <label for="@secondPhone.Fix(h => h.IdFor(m => m.Category))">@Html.Sitecore().Field("Phone Type Label")</label>
                                            @secondPhone.Fix(h => h.DropDownListFor(m => m.Category,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            ng_model = "accountInformation.contactInfo.phone[1].category",
                                                            ng_options = "type.name as type.display for type in phoneTypes|filter:filter2|filter:filterCustomerType",
                                                            data_val_if = "accountInformation.contactInfo.phone.length > 1"
                                                        }))
                                            @secondPhone.ValidationMessageFor(m => ((TypedPhone)m).Category)
                                        </div>
                                    }
                                </div>
                            </div>
                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.ContactInfo.Email.Address)>
                                <label for="@Html.IdFor(m => m.ContactInfo.Email.Address)">@Html.Sitecore().Field("Email Address Label")</label>
                                @Html.TextBoxFor(m => m.ContactInfo.Email.Address, new { type = "email", ng_model = "accountInformation.contactInfo.email.address", required = "required", data_val = "true", data_val_email = Html.Sitecore().Field("Address Invalid").ToString(), data_val_required = Html.Sitecore().Field("Address Required").ToString() })
                                @Html.ValidationMessageFor(model => model.ContactInfo.Email.Address)
                            </div>

                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.PreferredSalesExecutive)>
                                <label for="@Html.IdFor(m => m.PreferredSalesExecutive)">@Html.Sitecore().Field("Preferred AE Label")&nbsp;<a href="" tooltip="@Html.Sitecore().Field("Preferred AE Tooltip")"><i class="icon-tooltip"></i></a></label>
                                @Html.TextBoxFor(m => m.PreferredSalesExecutive, new { ng_model = "accountInformation.preferredSalesExecutive" })
                                @Html.ValidationMessageFor(m => m.PreferredSalesExecutive)
                            </div>
                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.Language)>
                                <label>@Html.Sitecore().Field("Preferred Language Choice Label")</label>
                                <ul class="checkbox-list">
                                    <li><input type="radio" name="@Html.NameFor(m => m.Language)" ng-model="accountInformation.language" value="en" checked><label for="@Html.IdFor(m => m.Language)">@Html.Sitecore().Field("English Label")</label></li>
                                    <li><input type="radio" name="@Html.NameFor(m => m.Language)" ng-model="accountInformation.language" value="es"><label for="@Html.IdFor(m => m.Language)">@Html.Sitecore().Field("Spanish Label")</label></li>
                                </ul>
                                @Html.ValidationMessageFor(m => m.Language)
                            </div>
                        </div>
                    </article>
                    <article ng-if="customerType=='commercial' && !isRenewal" class="enrollment__box form">
                        <header>
                            <h1>@Html.Sitecore().Field("Company Information Header")</h1>
                        </header>
                        <div class="content">
                            <h3>@Html.Sitecore().Field("Small Company Information Header")</h3>
                            <div class="group">
                                <div class="item" ng-show="contacts.options.length> 1">
                                    <label>@Html.Sitecore().Field("Select Existing Contact Info Label")</label>
                                    <select ng-model="contacts.selectedContact"
                                            ng-change="updateAccountInformation()"
                                            ng-options="contact as contact.mailingAddress | address for contact in contacts.options">
                                        <option value="">@Html.Sitecore().Field("Select Option Please Choose")</option>
                                    </select>
                                </div>
                            </div>
                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.CompanyName)>
                                <label for="@Html.IdFor(m => m.CompanyName)">@Html.Sitecore().Field("Company Name Label")</label>
                                @Html.TextBoxFor(m => m.CompanyName, new { ng_model = "accountInformation.companyName", required = "required", data_val = "true", data_val_required = Html.Sitecore().Field("Company Name Required").ToString() })
                                @Html.ValidationMessageFor(m => m.CompanyName)
                            </div>
                            <div class="item group-col">
                                <label>@Html.Sitecore().Field("Tax ID SSN Label")</label>
                                <ul class="checkbox-list">
                                    <li style="display: inline;"><input type="radio" name="idType" ng-model="accountInformation.ssnOrTaxid" ng-click="accountInformation.socialSecurityNumber = '';" value="taxId" checked><label for="taxid">@Html.Sitecore().Field("Checkbox List Tax ID")</label></li>&nbsp;&nbsp;
                                    <li style="display: inline;"><input type="radio" name="idType" ng-model="accountInformation.ssnOrTaxid" ng-click="accountInformation.taxID = '';"value="ssn"><label for="ssn">@Html.Sitecore().Field("Checkbox List Social Security Number")</label></li>
                                </ul>
                            </div>
                            <div class="item group-col" ng-if="accountInformation.ssnOrTaxid == 'ssn'" @Html.Validation().ErrorClass(m => m.SocialSecurityNumber)>
                                <label for="@Html.IdFor(m => m.SocialSecurityNumber)">
                                    @Html.Sitecore().Field("Social Security Number Label")
                                    <a ng-if="cartHasUtility()" href="" tooltip="@Html.Sitecore().Field("Social Security Number Tooltip Commercial")"><i class="icon-tooltip"></i></a>
                                </label>
                                @Html.TextBoxFor(m => m.SocialSecurityNumber, new { ng_model = "accountInformation.socialSecurityNumber", @class = "maskField", data_val = "true", data_val_required = Html.Sitecore().Field("SSN or Tax ID Required").ToString(), data_val_regex = Html.Sitecore().Field("Social Security Number Invalid"), data_val_regex_pattern = "^\\d{3}[-]?\\d{2}[-]?\\d{4}$", })
                                @Html.ValidationMessageFor(m => m.SocialSecurityNumber)
                            </div>
                            <div class="item" ng-if="accountInformation.ssnOrTaxid == 'taxId'" @Html.Validation().ErrorClass(m => m.TaxId)>
                                <label for="@Html.IdFor(m => m.TaxId)">@Html.Sitecore().Field("Tax ID Label")</label>
                                @Html.TextBoxFor(m => m.TaxId, new { ng_model = "accountInformation.taxID", data_val = "true", data_val_required = Html.Sitecore().Field("SSN or Tax ID Required").ToString(), data_val_regex = Html.Sitecore().Field("Tax Id Invalid"), data_val_regex_pattern = "^\\d{2}[-]?\\d{7}(\\d{1})?(\\d{1})?$", required="required" })
                                @Html.ValidationMessageFor(m => m.TaxId)
                            </div>
                            @* Currently Under Contract*@
                            <div class="item group-col" @Html.Validation().ErrorClass(m => m.UnderContract)>
                                <label>@Html.Sitecore().Field("Under Contract Label")</label>
                                <ul class="checkbox-list">
                                    <li><input type="radio" name="@Html.NameFor(m => m.UnderContract)" ng-model="accountInformation.underContract" value="Yes" checked><label for="@Html.IdFor(m => m.UnderContract)">@Html.Sitecore().Field("Yes Label")</label></li>
                                    <li><input type="radio" name="@Html.NameFor(m => m.UnderContract)" ng-model="accountInformation.underContract" value="No"><label for="@Html.IdFor(m => m.UnderContract)">@Html.Sitecore().Field("No Label")</label></li>
                                    <li><input type="radio" name="@Html.NameFor(m => m.UnderContract)" ng-model="accountInformation.underContract" value="Unknown"><label for="@Html.IdFor(m => m.UnderContract)">@Html.Sitecore().Field("Not Sure Label")</label></li>
                                </ul>
                                @Html.ValidationMessageFor(m => m.UnderContract)
                            </div>

                            <div ng-init="accountInformation.mailingAddressSame = cartHasUtility()">
                                <h3>@Html.Sitecore().Field("Billing Address Label")</h3>
                                <div class="item" ng-show="cartHasUtility()">
                                    <ul class="checkbox-list">
                                        <li>
                                            <input type="checkbox" name="same-address-mailing" id="same-address-mailing" ng-click="mailingAddressSameChanged()" ng-model="accountInformation.mailingAddressSame" ng-checked="cartHasUtility()">
                                            <label for="same-address-mailing">@Html.Sitecore().Field("Same Address Label")</label>
                                        </li>
                                    </ul>
                                </div>
                                <div class="item" ng-show="accountInformation.mailingAddressSame && utilityAddresses().length > 1" @Html.Validation().ErrorClass(m => m.MailingAddress)>
                                    <label for="service-address-mailing">@Html.Sitecore().Field("Select Service Address Label")</label>
                                    <select id="service-address-mailing"
                                            name="@Html.NameFor(m => m.MailingAddress)"
                                            data-val="true" data-val-required
                                            ng-model="accountInformation.mailingAddress"
                                            ng-change="updateBillingAddress()"
                                            ng-options="entry.location.address as entry.location.address | address for entry in utilityAddresses()">
                                        <option value="">@Html.Sitecore().Field("Select Option Please Choose")</option>
                                    </select>
                                </div>
                                <div class="item item--no-input" ng-show="accountInformation.mailingAddressSame && utilityAddresses().length == 1">
                                    <label>@Html.Sitecore().Field("Billing Service Address Label")</label>
                                    <strong>{{ utilityAddresses()[0].location.address | address }}</strong>
                                </div>
                                @using (var mailingAddress = Html.Shortcut(m => m.MailingAddress))
                                {
                                    <div ng-if="!accountInformation.mailingAddressSame" class="mailing-address">
                                        <div class="group">
                                            <div class="item group-col" @(mailingAddress.Validation().ErrorClass(m => m.Line1))>
                                                <label for="@mailingAddress.Fix(h => h.IdFor(m => m.Line1))">@Html.Sitecore().Field("Address 1 Label")</label>
                                                @mailingAddress.Fix(h => h.TextBoxFor(m => m.Line1, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.line1" }))
                                                @mailingAddress.ValidationMessageFor(m => m.Line1)
                                            </div>
                                            <div class="item group-col" @mailingAddress.Validation().ErrorClass(m => m.Line2)>
                                                <label for="@mailingAddress.Fix(h => h.IdFor(m => m.Line2))">@Html.Sitecore().Field("Address 2 Label")</label>
                                                @mailingAddress.Fix(h => h.TextBoxFor(m => m.Line2, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.line2" }))
                                                @mailingAddress.ValidationMessageFor(m => m.Line2)
                                            </div>
                                        </div>
                                        <div class="group">
                                            <div class="item group-col" @mailingAddress.Validation().ErrorClass(m => m.City)>
                                                <label for="@mailingAddress.Fix(h => h.IdFor(m => m.City))">@Html.Sitecore().Field("City Label")</label>
                                                @mailingAddress.Fix(h => h.TextBoxFor(m => m.City, new { data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.city" }))
                                                @mailingAddress.ValidationMessageFor(m => m.City)
                                            </div>
                                            <div class="item" @mailingAddress.Validation().ErrorClass(m => m.StateAbbreviation)>
                                                <label for="@mailingAddress.Fix(h => h.IdFor(m => m.StateAbbreviation))">@Html.Sitecore().Field("State Label")</label>
                                                @mailingAddress.Fix(h => h.DropDownListFor(m => m.StateAbbreviation,
                                                        new SelectListItem[] { new SelectListItem { Text = Html.Sitecore().Field("Select Option Please Choose").ToString(), Value = "" } },
                                                        new
                                                        {
                                                            data_val_if = "!accountInformation.mailingAddressSame",
                                                            ng_model = "accountInformation.mailingAddress.stateAbbreviation",
                                                            ng_options = "state.abbreviation as state.display for state in usStates"
                                                        }))
                                                @mailingAddress.ValidationMessageFor(m => m.StateAbbreviation)
                                            </div>
                                            <div class="item zip-code" @mailingAddress.Validation().ErrorClass(m => m.PostalCode5)>
                                                <label for="@mailingAddress.Fix(h => h.IdFor(m => m.PostalCode5))">@Html.Sitecore().Field("Zip Label")</label>
                                                @mailingAddress.Fix(h => h.TextBoxFor(m => m.PostalCode5, new { @class = "small", data_val_if = "!accountInformation.mailingAddressSame", ng_model = "accountInformation.mailingAddress.postalCode5" }))
                                                @mailingAddress.ValidationMessageFor(m => m.PostalCode5)
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                            </div>

                    </article>
                    @* User Account Creation *@
                    <article class="form enrollment__box enrollment__box--account-creation" ng-if="!isRenewal && cartHasMobile()" id="create-online-account">
                        <header>
                            <h1>@Html.Sitecore().Field("Create Online Account Header")</h1>@*Social box header: Social Box Header*@
                        </header>
                        <div class="content">
                            <p>@Html.Sitecore().Field("Online Account Paragraph")</p>
                            <hr class="content-divider" />
                            <div class="onlineAccountInfo">
                                <input type="radio" id="createOnlineAccountYes" name="createOnlineAccountYes" ng-value="true" ng-model="createOnlineAccount" /><label class="radio" for="createOnlineAccountYes">@Html.Sitecore().Field("Online Account Yes")</label>
                                <div class="item" ng-class="{disabled: !createOnlineAccount}" @Html.Validation().ErrorClass(m => m.OnlineAccount.Username)>
                                    <label for="@Html.IdFor(m => m.OnlineAccount.Username)">@Html.Sitecore().Field("Username Optional Label")</label>
                                    @Html.TextBoxFor(m => m.OnlineAccount.Username, new { data_val_if = "createOnlineAccount", ng_model = "accountInformation.onlineAccount.username", autocomplete = "off" })
                                    @Html.ValidationMessageFor(m => m.OnlineAccount.Username)
                                </div>
                                <div class="group" ng-class="{disabled: !createOnlineAccount}">
                                    <div class="item group-col" @Html.Validation().ErrorClass(m => m.OnlineAccount.Password)>
                                        <label for="@Html.IdFor(m => m.OnlineAccount.Password)">@Html.Sitecore().Field("Password Optional Label")</label>
                                        @Html.PasswordFor(m => m.OnlineAccount.Password, new { data_val_if = "createOnlineAccount", ng_model = "accountInformation.onlineAccount.password", autocomplete = "off" })
                                        @Html.ValidationMessageFor(m => m.OnlineAccount.Password)
                                        <p class="note">@Html.Sitecore().Field("Password Note")</p>
                                    </div>
                                    <div class="item group-col" @Html.Validation().ErrorClass(m => m.OnlineAccount.ConfirmPassword)>
                                        <label for="@Html.IdFor(m => m.OnlineAccount.ConfirmPassword)">@Html.Sitecore().Field("Verify Password Label")</label>
                                        @Html.PasswordFor(m => m.OnlineAccount.ConfirmPassword, new { data_val_if = "createOnlineAccount", ng_model = "accountInformation.onlineAccount.confirmPassword", autocomplete = "off" })
                                        @Html.ValidationMessageFor(m => m.OnlineAccount.ConfirmPassword)
                                    </div>
                                </div>
                                <input type="radio" id="createOnlineAccountNo" name="createOnlineAccountNo" ng-value="false" ng-model="createOnlineAccount" ng-click="accountInformation.onlineAccount = null" /><label class="radio" for="createOnlineAccountNo">@Html.Sitecore().Field("Online Account No")</label>
                            </div>
                        </div>
                    </article>
                    <article class="form enrollment__box associate-referal" ng-if="!associateInformation">
                        <header>
                            <h1>@Html.Sitecore().Field("Associate Referral Header")</h1>
                        </header>
                        <div class="content">
                            <div class="item">
                                <ul class="checkbox-list">
                                    <li>
                                        <input type = "checkbox" name="associate-referral-checkbox-label" id="associate-referral-checkbox-label" ng-model="additionalInformation.hasAssociateReferral">
                                        <label for="associate-referral-checkbox-label">@Html.Sitecore().Field("Associate Referral Checkbox Label")</label>
                                    </li>
                                </ul>
                            </div>
                            <div ng-if="additionalInformation.hasAssociateReferral">
                                <p>@Html.Sitecore().Field("Associate Referral Intro Text")</p>
                                <div class="item" @Html.Validation().ErrorClass(m => m.AssociateName)>
                                    <label class="associate-name" for="@Html.IdFor(m => m.AssociateName)">@Html.Sitecore().Field("Associate Referral Textbox Label")</label>
                                    @Html.TextBoxFor(m => m.AssociateName, new { ng_model = "accountInformation.associateName", data_val_if = "!accountInformation.hasAssociateReferral", data_val = "true", data_val_required = Html.Sitecore().Field("Associate Referral Textbox Invalid") })
                                    @Html.ValidationMessageFor(model => model.AssociateName)
                                </div>
                            </div>
                        </div>
                    </article>
                    <div class="buttons">
                        <button type = "submit" class="primary" ng-disabled="!isFormValid()" data-val-submit>@Html.Sitecore().Field("Button Label")</button>
                        <button type = "submit" class="tertiary" ng-click="resetEnrollment();">
                            <span ng-if="customerType != 'commercial'">@Html.Sitecore().Field("Cancel Enrollment Button")</span>
                            <span ng-if="customerType == 'commercial'">@Html.Sitecore().Field("Cancel Quote Button")</span>
                        </button>
                    </div>
                </form>
                <div class="hide-medium-large time-remaining-mobile">
                    <p class="time-remaining">@Html.Sitecore().Field("Estimated Time Remaining") <strong>@Html.Sitecore().Field("Remaining Minutes")</strong></p>
                    <p><a href = ""> @Html.Sitecore().Field("Info needed") </a></p>
                </div>
            </section>
            <aside>
                <div ng-include ng-if="true" src="'cart-template'"></div>
            </aside>
        </div>
    </div>
</div>
}

<script type = "text/ng-template" id="offerOptions/TexasElectricity">
    @using(var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
                                {
    <div @*ng-controller="OfferOptions-TexasElectricity"*@>
        @*<h2>Electricity</h2>*@
        @* No options here since billing address is handled outside of this loop *@
    </div>
    }
</script>

<script type="text/ng-template" id="offerOptions/GeorgiaGasSwitch">
    @using (var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
    {

        <div class="item group-col" @offer.Validation().ErrorClass(o => ((GeorgiaGas.SwitchOfferOption)o.OfferOption).AglcNumber)>
            <label for="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.SwitchOfferOption)o.OfferOption).AglcNumber))">@Html.Sitecore().Field("AGLC Number Label")</label>
            @offer.Fix(h => h.TextBoxFor(o => ((GeorgiaGas.SwitchOfferOption)o.OfferOption).AglcNumber, new { ng_model = "selectedOffer.offerOption.aglcNumber" }))
            <a href="" ng-click="showAglcExample()" class="aglc-example">@Html.Sitecore().Field("See Example Link Label")</a>
            @offer.ValidationMessageFor(o => ((GeorgiaGas.SwitchOfferOption)o.OfferOption).AglcNumber)
        </div>
    }
</script>

<script type="text/ng-template" id="offerOptions/GeorgiaGasRenewal">
    <div>

    </div>
</script>

<script type="text/ng-template" id="offerOptions/TexasElectrictyRenewal">
    <div>
    </div>
</script>

<script type="text/ng-template" id="template/datepicker/popup.html">
    <ul class="dropdown-menu" ng-style="{display: (isOpen && 'block') || 'none', top: position.top+'px', left: position.left+'px'}" ng-keydown="keydown($event)">
        <li ng-transclude></li>
        <li ng-if="showFooter">
            <ul class="legend">
                <li><span class="disabled">24</span> Dates in grey are unavailable</li>
                <li><span>24</span> Dates in black are available for a standard connect fee</li>
                <li ng-show="hasAnyPriority()"><span class="priority">24</span> Dates in yellow are available for a priority connect fee</li>
            </ul>
        </li>
        <li ng-if="showButtonBar" style="padding:10px 9px 2px">
            <span class="btn-group">
                <button type="button" class="btn btn-sm btn-info" ng-click="select('today')">{{ getText('current') }}</button>
                <button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText('clear') }}</button>
            </span>
            <button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText('close') }}</button>
        </li>
    </ul>
</script>

<script type="text/ng-template" id="offerOptions/TexasElectricityMoveIn">
    @using (var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
    {
    <div ng-controller="OfferOptions-TexasElectricityMoveIn">
        <div class="item group-col datepicker" @offer.Validation().ErrorClass(o => ((TexasElectricity.MoveInOfferOption)o.OfferOption).ConnectDate)>
            <label for="@offer.Fix(h => h.IdFor(o => ((TexasElectricity.MoveInOfferOption)o.OfferOption).ConnectDate))">@Html.Sitecore().Field("Service Start Date Label")</label>
            <span class="calendar">
                <input type="text" class="datepicker-input" id="@offer.Fix(h => h.IdFor(o => ((TexasElectricity.MoveInOfferOption)o.OfferOption).ConnectDate))" ng-model="selectedOffer.offerOption.connectDate"
                       datepicker-popup is-open="datePickerOpened" ng-click="openDatePicker($event)" min-date="minDate" date-disabled="checkDisabledDate(date, mode)" show-footer="true" datepicker-options="{ 'datepickerDateClass': 'checkDateClass(date)', 'datepickerDateClassScope': $id, 'maxMode': 'day' }" />
                <span class="icon" ng-click="openDatePicker($event)"><i class="icon-calendar"></i></span>
            </span>
            <div class="availibility">@Html.Sitecore().Field("Availability Text")</div>
        </div>
        <div class="item item--no-input inline-label">
            <label for="connection-fee">@Html.Sitecore().Field("Connection Fee Label")</label>
            {{connectionFee | currency}}
        </div>
    </div>
    }
</script>

<script type="text/ng-template" id="offerOptions/GeorgiaGasMoveIn">
    @using (var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
    {
        <div ng-controller="OfferOptions-GeorgiaGasMoveIn">
            <div class="item group-col datepicker" @offer.Validation().ErrorClass(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectDate)>
                <label for="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectDate))">@Html.Sitecore().Field("Service Start Date Label")<a href="" tooltip="@Html.Sitecore().Field("GA Date Tooltip")"><i class="icon-tooltip"></i></a></label>
                <span class="calendar">
                    <input type="text" class="datepicker-input" id="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectDate))" ng-model="selectedOffer.offerOption.connectDate"
                           datepicker-popup is-open="datePickerOpened" ng-click="openDatePicker($event)" min-date="minDate" date-disabled="checkDisabledDate(date, mode)" show-footer="true" datepicker-options="{ 'datepickerDateClass': 'checkDateClass(date)', 'datepickerDateClassScope': $id, 'maxMode': 'day' }" />
                    <span class="icon" ng-click="openDatePicker($event)"><i class="icon-calendar"></i></span>
                </span>
            </div>
            <div class="item group-col" @offer.Validation().ErrorClass(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectTime)>
                <ul class="checkbox-list">
                    <li><input type="checkbox" name="current-active-service" id="current-active-service" ng-model="currentActiveService" ng-change="selectedOffer.offerOption.connectTime = 'AllDay'"><label for="current-active-service">@Html.Sitecore().Field("GA Current Active Service Label")</label></li>
                </ul>
                <span class="connect-time">
                    <select id="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectTime))"
                            name="@offer.Fix(h => h.NameFor(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectTime))"
                            data-val="true"
                            data-val-required="@Html.Sitecore().Field("ConnectTime Required")"
                            ng-model="selectedOffer.offerOption.connectTime"
                            ng-disabled="currentActiveService">
                        @Html.Sitecore().Field("GA Connect Time Options")
                    </select>
                    @offer.Fix(h => h.ValidationMessageFor(o => ((GeorgiaGas.MoveInOfferOption)o.OfferOption).ConnectTime))
                </span>
                <div class="availibility">@Html.Sitecore().Field("Availability Text")</div>
            </div>
            <div class="item item--no-input inline-label utility-connect">
                <label for="utility-connect-fee">@Html.Sitecore().Field("Utility Connect Fee Label")</label>
                @Html.Sitecore().Field("GA Utility Connect Fee")
            </div>
            <div class="item item--no-input inline-label">
                <label for="stream-connect-fee">@Html.Sitecore().Field("Stream Connect Fee Label")</label>
                @Html.Sitecore().Field("GA Stream Connect Fee")
            </div>
        </div>
    }
</script>

<script type="text/ng-template" id="offerOptions/TexasElectricityCommercialQuote">
    @using (var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
    {
    <div ng-controller="OfferOptions-TexasElectricityCommercialQuote" ng-if="selectedOffer.optionRules.connectDates.availableConnectDates.length> 0">
    <div class="item group-col datepicker" @offer.Validation().ErrorClass(o => ((TexasElectricity.CommercialQuoteOption)o.OfferOption).ConnectDate)>
        <label for="@offer.Fix(h => h.IdFor(o => ((TexasElectricity.CommercialQuoteOption)o.OfferOption).ConnectDate))">@Html.Sitecore().Field("Commercial Service Start Date Label")</label>
        <span class="calendar">
            <input type="text" class="datepicker-input" id="@offer.Fix(h => h.IdFor(o => ((TexasElectricity.CommercialQuoteOption)o.OfferOption).ConnectDate))" ng-model="selectedOffer.offerOption.connectDate"
                   datepicker-popup is-open="datePickerOpened" ng-click="openDatePicker($event)" min-date="minDate" date-disabled="checkDisabledDate(date, mode)" show-footer="true" datepicker-options="{ 'datepickerDateClass': 'checkDateClass(date)', 'datepickerDateClassScope': $id, 'maxMode': 'day' }" />
            <span class="icon" ng-click="openDatePicker($event)"><i class="icon-calendar"></i></span>
        </span>
            <div class="availibility">@Html.Sitecore().Field("Availability Text")</div>
    </div>
    </div>
   }
</script>

<script type="text/ng-template" id="offerOptions/GeorgiaGasCommercialQuote">
    @using (var offer = Html.ClientRepeater(m => m.Services, "{{$parent.$index}}").ClientRepeater(m => m.SelectedOffers, "{{$index}}"))
    {
        <div ng-controller="OfferOptions-GeorgiaGasCommercialQuote" ng-if="selectedOffer.optionRules.connectDates.availableConnectDates.length> 0">
            <div class="item group-col datepicker" @offer.Validation().ErrorClass(o => ((GeorgiaGas.CommercialQuoteOption)o.OfferOption).ConnectDate)>
                <label for="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.CommercialQuoteOption)o.OfferOption).ConnectDate))">@Html.Sitecore().Field("Commercial Service Start Date Label")</label>
                <span class="calendar">
                    <input type="text" class="datepicker-input" id="@offer.Fix(h => h.IdFor(o => ((GeorgiaGas.CommercialQuoteOption)o.OfferOption).ConnectDate))" ng-model="selectedOffer.offerOption.connectDate"
                           datepicker-popup is-open="datePickerOpened" ng-click="openDatePicker($event)" min-date="minDate" date-disabled="checkDisabledDate(date, mode)" show-footer="true" datepicker-options="{ 'datepickerDateClass': 'checkDateClass(date)', 'datepickerDateClassScope': $id, 'maxMode': 'day' }" />
                    <span class="icon" ng-click="openDatePicker($event)"><i class="icon-calendar"></i></span>
                </span>
                <div class="availibility">@Html.Sitecore().Field("Availability Text")</div>
            </div>
        </div>
    }
</script>

<script type="text/ng-template" id="cleanseAddressesModal">
    <div class="cleanse-address">
        <div class="modal-header">
            <a href="" ng-click="$dismiss()">@Html.Sitecore().Field("Close")</a>
            <h2>@Html.Sitecore().Field("Verify Address Header")</h2>
        </div>
        <div class="modal-body scrollable">
            @Html.Sitecore().Field("Verify Address Body")
            <div class="item address-group" ng-if="addressOptions.mailingAddress[0]">
                <label>@Html.Sitecore().Field("Mailing Address Text")</label>
                <div class="radio-item">
                    <input id="mailingAddress-suggested-{{$id}}" type="radio" ng-model="modal.mailingAddress" value="suggested">
                    <label for="mailingAddress-suggested-{{$id}}">@Html.Sitecore().Field("Suggested Address Text")</label>
                </div>
                <div class="address">
                    <label for="mailingAddress-suggested-{{$id}}">{{ addressOptions.mailingAddress[1] | address }}</label>
                </div>
                <div class="radio-item">
                    <input id="mailingAddress-original-{{$id}}" type="radio" ng-model="modal.mailingAddress" value="original">
                    <label for="mailingAddress-original-{{$id}}">@Html.Sitecore().Field("Original Address Text")</label>
                </div>
                <div class="address">
                    <label for="mailingAddress-original-{{$id}}">{{ addressOptions.mailingAddress[0] | address }}</label>
                </div>
            </div>

            <div class="item address-group" ng-if="addressOptions.previousAddress[0]">
                <label>@Html.Sitecore().Field("Previous Address Text")</label>
                <div class="radio-item">
                    <input id="previousAddress-suggested-{{$id}}" type="radio" ng-model="modal.previousAddress" value="suggested">
                    <label for="previousAddress-suggested-{{$id}}">@Html.Sitecore().Field("Suggested Address Text")</label>
                </div>
                <div class="address">
                    <label for="previousAddress-suggested-{{$id}}">{{ addressOptions.previousAddress[1] | address }}</label>
                </div>
                <div class="radio-item">
                    <input id="previousAddress-original-{{$id}}" type="radio" ng-model="modal.previousAddress" value="original">
                    <label for="previousAddress-original-{{$id}}">@Html.Sitecore().Field("Original Address Text")</label>
                </div>
                <div class="address">
                    <label for="previousAddress-original-{{$id}}">{{ addressOptions.previousAddress[0] | address }}</label>
                </div>
            </div>

        </div>
        <div class="modal-footer">
            <button class="secondary" ng-click="$dismiss()">@Html.Sitecore().Field("Cancel Button")</button>
            <button ng-click="$close()">@Html.Sitecore().Field("Continue Button")</button>
        </div>
    </div>
</script>

<script type="text/ng-template" id="AglcExample">
    <div class="modal-header">
        <a href="" ng-click="$dismiss()"></a>
        <h2>@Html.Sitecore().Field("AGLC Example Header Text")</h2>
    </div>
    <div class="modal-body scrollable">
        @Html.Sitecore().Field("AGLC Example Body Text")
    </div>
    <div class="modal-footer">
        <button ng-click="$close()">@Html.Sitecore().Field("AGLC Example Button Text")</button>
    </div>
</script>